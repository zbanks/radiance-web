(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{21:function(t,e,s){"use strict";s.r(e),s.d(e,"Graph",(function(){return h}));class i{constructor(t,e){this.vertices=[],this.edges=[],this.rootVertices=[],this.upstreamEdges=[],this.downstreamEdges=[],t.forEach(t=>{this.addVertex(t)}),e.forEach(t=>{this.addEdge(t)})}upstreamVertexIndex(t,e){const s=this.upstreamEdges[t][e];return void 0===s?void 0:this.edges[s].fromVertex}downstreamVertexIndices(t){return this.downstreamEdges[t].map(t=>this.edges[t].toVertex)}addVertex(t){const e=this.vertices.length;return this.vertices.push(t),this.upstreamEdges.push([]),this.downstreamEdges.push([]),this.rootVertices.push(e),e}addEdge(t){const e=this.edges.length;if(this.edges.push(t),void 0!==this.upstreamEdges[t.toVertex][t.toInput])throw`Vertex ${t.toVertex} input ${t.toInput} has multiple upstream vertices`;this.upstreamEdges[t.toVertex][t.toInput]=e,this.downstreamEdges[t.fromVertex].push(e);let s=this.rootVertices.indexOf(t.fromVertex);s>=0&&this.rootVertices.splice(s,1)}removeVertices(t){let e=[],s=0;this.vertices.forEach((i,n)=>{t.indexOf(n)<0&&(e[n]=s,s++)}),this.vertices=this.vertices.filter((e,s)=>t.indexOf(s)<0),this.rootVertices=this.rootVertices.filter(e=>t.indexOf(e)<0),this.upstreamEdges=this.upstreamEdges.filter((e,s)=>t.indexOf(s)<0),this.downstreamEdges=this.downstreamEdges.filter((e,s)=>t.indexOf(s)<0),this.edges.forEach(t=>{t.fromVertex=e[t.fromVertex],t.toVertex=e[t.toVertex]}),this.rootVertices.forEach((t,s)=>{this.rootVertices[s]=e[t]})}removeEdges(t){let e=t.slice();e.sort((t,e)=>e-t),e.forEach(t=>{this.removeEdge(t)})}removeEdge(t){const e=this.edges[t];this.edges.splice(t,1),void 0!==e.toVertex&&delete this.upstreamEdges[e.toVertex][e.toInput],void 0!==e.fromVertex&&this.downstreamEdges[e.fromVertex].splice(this.downstreamEdges[e.fromVertex].indexOf(t),1),void 0!==e.fromVertex&&0==this.downstreamEdges[e.fromVertex].length&&this.rootVertices.push(e.fromVertex),this.vertices.forEach((e,s)=>{this.upstreamEdges[s].forEach((e,i)=>{e>t&&(this.upstreamEdges[s][i]=e-1)}),this.downstreamEdges[s].forEach((e,i)=>{e>t&&(this.downstreamEdges[s][i]=e-1)})})}connectedComponents(t){return t.filter(e=>this.downstreamEdges[e].reduce((e,s)=>e&&t.indexOf(this.edges[s].toVertex)<0,!0)).map(e=>{let s={vertices:[],rootVertex:e,internalEdges:[],inputEdges:[],outputEdges:[]};const i=e=>{s.vertices.push(e);const n=this.downstreamEdges[e].filter(e=>t.indexOf(this.edges[e].toVertex)<0);s.outputEdges.push(...n);const r=this.upstreamEdges[e].filter(e=>t.indexOf(this.edges[e].fromVertex)<0);s.inputEdges.push(...r);const o=this.upstreamEdges[e].filter(e=>t.indexOf(this.edges[e].fromVertex)>=0);s.internalEdges.push(...o);let h=o.map(t=>this.edges[t].fromVertex);h=h.filter((t,e,s)=>s.indexOf(t)==e),h.forEach(t=>{i(t)})};return i(e),s})}bypassEdges(t){let e=[];return t.inputEdges.length>=1&&t.outputEdges.forEach(s=>{const i=this.edges[s];i.fromVertex==t.rootVertex&&e.push({fromVertex:this.edges[t.inputEdges[0]].fromVertex,toVertex:i.toVertex,toInput:i.toInput})}),e}verticesBetween(t,e){let s=[];const i=(t,e)=>{const n=t[t.length-1];n==e?s.push(...t):this.downstreamVertexIndices(n).forEach(s=>{t.indexOf(s)<0&&i(t.concat([s]),e)})};return i([t],e),i([e],t),s=s.filter((t,e,s)=>s.indexOf(t)==e),s}}class n extends HTMLElement{constructor(){super(),this.nInputs=0,this.inputHeights=[],this.uid=null,this.offsetX=0,this.offsetY=0,this.dragging=!1,this.mouseDrag=!1,this.touchDrag=!1,this.ccDrag=!1,this._selected=!1}connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML='\n            <style>\n            :host {\n                display: block;\n                padding: 15px 0px;\n                position: absolute;\n                top: 0px;\n                left: 0px;\n                box-sizing: border-box;\n                z-index: 0;\n                outline: none;\n                pointer-events: none;\n                will-change: transform;\n                transition: transform 1s, width 1s, height 1s, opacity 0.5s, z-index 1s;\n            }\n\n            :host(:focus) {\n                transition: transform 1s, width 1s, height 1s, opacity 0.5s, z-index 0s;\n                z-index: 1001;\n            }\n\n            :host([dragging]) {\n                opacity: 0.5;\n                z-index: 1000;\n                transition: transform 0s, width 0s, height 0s, opacity 0.5s, z-index 0s;\n            }\n\n            :host(:focus) #outline {\n                border: 2px solid white;\n            }\n\n            :host([selected]) #inner {\n                background-color: #000066;\n            }\n\n            #inner {\n                box-sizing: border-box;\n                width: 100%;\n                height: 100%;\n                background-color: black;\n                text-align: center;\n                color: white;\n                padding: 5px;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n                pointer-events: all;\n            }\n\n            #outline {\n                pointer-events: none;\n                position: absolute;\n                left: -1px;\n                right: -1px;\n                top: 14px;\n                bottom: 14px;\n                border: 2px solid gray;\n            }\n            </style>\n            <div id="inner">\n                <slot></slot>\n                <div id="outline"></div>\n            </div>\n        ',this.inner=t.querySelector("#inner"),this.inner.addEventListener("mousedown",this.mouseDown.bind(this)),document.addEventListener("mouseup",this.mouseUp.bind(this)),document.addEventListener("mousemove",this.mouseMove.bind(this)),this.inner.addEventListener("touchstart",this.touchStart.bind(this),{passive:!1}),document.addEventListener("touchend",this.touchEnd.bind(this)),document.addEventListener("touchmove",this.touchMove.bind(this)),this.tabIndex=0,this.addEventListener("keypress",this.keyPress.bind(this)),this.addEventListener("wheel",this.onScroll.bind(this))}width(){return 110}minInputHeight(t){return 200}height(){return this.inputHeights.reduce((t,e)=>t+e,0)}updateSize(){this.style.height=this.height()+"px",this.style.width=this.width()+"px"}render(){this.preview&&this.preview.render(this)}updateFromState(t){"nInputs"in t&&t.nInputs!=this.nInputs&&(this.nInputs=t.nInputs,this.graph.requestRelayout())}touchStart(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);s.target!=this.inner&&s.target!=this.inner||(this.dragging||(this.touchDrag=!0,this.touchId=s.identifier,this.dragCtrl=t.ctrlKey,this.dragShift=t.shiftKey,this.dragSelected=this.selected,this.graph.ensureSelected(this,this.dragCtrl,this.dragShift),this.focus(),this.startDrag(s.pageX,s.pageY),t.preventDefault()))}}mouseDown(t){t.target!=this.inner&&t.target!=this.inner||!this.dragging&&1&t.buttons&&(this.mouseDrag=!0,this.dragCtrl=t.ctrlKey,this.dragShift=t.shiftKey,this.dragSelected=this.selected,this.graph.ensureSelected(this,this.dragCtrl,this.dragShift),this.focus(),this.startDrag(t.pageX,t.pageY),t.preventDefault())}touchEnd(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);this.dragging&&this.touchDrag&&this.touchId==s.identifier&&(this.touchDrag=!1,this.endDrag())}}mouseUp(t){!this.dragging||!this.mouseDrag||1&t.buttons||(this.mouseDrag=!1,this.endDrag(),t.preventDefault())}touchMove(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);this.dragging&&this.touchDrag&&this.touchId==s.identifier&&this.drag(s.pageX,s.pageY)}}mouseMove(t){this.dragging&&this.mouseDrag&&(this.drag(t.pageX,t.pageY),t.preventDefault())}startDrag(t,e){if(this.dragging)throw"Cannot start drag while drag in progress";this.dragging=!0,this.startDragX=t,this.startDragY=e,this.wasClick=!0}endDrag(){this.dragging=!1,this.offsetX=0,this.offsetY=0,this.removeAttribute("dragging"),this.updateLocation(),this.wasClick?this.graph.select(this,this.dragSelected,this.dragCtrl,this.dragShift):this.ccDrag||this.graph.endDragCC()}drag(t,e){this.wasClick&&(this.wasClick=!1,this.setAttribute("dragging","true"),this.ccDrag||this.graph.startDragCC(this,this.startDragX,this.startDragY)),this.ccDrag||this.graph.dragCC(t,e),this.offsetX=t-this.startDragX,this.offsetY=e-this.startDragY,this.updateLocation()}updateLocation(){const t=this.width(),e=this.height();t!=this.oldWidth&&(this.style.width=t+"px",this.oldWidth=t),e!=this.oldHeight&&(this.style.height=e+"px",this.oldHeight=e),this.style.transform=`translate(${this.x+this.offsetX}px, ${this.y+this.offsetY}px)`}get selected(){return this._selected}set selected(t){this._selected=t,t?this.setAttribute("selected","true"):this.removeAttribute("selected")}keyPress(t){if("Delete"==t.code)this.graph.deleteSelected();else if("Space"==t.code){const t=Array.from(this.graph.tiles.vertices.keys()).filter(t=>this.graph.tiles.vertices[t].selected);console.log("Connected components:"),this.graph.tiles.connectedComponents(t).forEach(t=>{console.log(t)})}}onScroll(t){this.graph.onScroll(t),t.preventDefault()}}class r extends HTMLElement{constructor(){super()}connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML='\n            <style>\n            :host {\n                display: block;\n                width: 80%;\n                pointer-events: none;\n            }\n            #square {\n                position: relative;\n                width: 100%;\n                margin: 10px auto;\n            }\n            #square:after {\n                content: "";\n                display: block;\n                padding-bottom: 100%;\n            }\n            #content {\n                position: absolute;\n                width: 100%;\n                height: 100%;\n                border: 1px solid white;\n                background-color: gray;\n            }\n            </style>\n            <div id="square">\n                <div id="content">\n                </div>\n            </div>\n        ',this.content=t.querySelector("#content")}render(t){t.dragging&&t.graph.context.clearElement(t.inner),t.graph.context.paintNode(t.uid,this.content)}}class o extends HTMLElement{constructor(){super(),this._active=!1,this._dragging=!1}connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML='\n            <style>\n            :host {\n                display: block;\n                position: absolute;\n                top: 0px;\n                left: 0px;\n                width: 0px;\n                height: 0px;\n                box-sizing: border-box;\n                z-index: 1;\n                outline: none;\n                pointer-events: all;\n                will-change: opacity;\n                transition: opacity 0.2s;\n                opacity: 0;\n            }\n\n            :host(:not([dragging])) {\n                display: none;\n            }\n\n            :host([active]) {\n                opacity: 1;\n            }\n\n            #inner {\n                position: absolute;\n                width: 50px;\n                height: 200px;\n                left: -25px;\n                top: -100px;\n                background-image: radial-gradient(closest-side, yellow, transparent);\n            }\n            </style>\n            <div id="inner">\n            </div>\n        ',this.inner=t.querySelector("#inner")}updateLocation(){this.style.transform=`translate(${this.x}px, ${this.y}px)`}get active(){return this._active}set active(t){t&&!this._active?this.setAttribute("active","true"):!t&&this._active&&this.removeAttribute("active"),this._active=t}get dragging(){return this._dragging}set dragging(t){t&&!this._dragging?this.setAttribute("dragging","true"):!t&&this._dragging&&this.removeAttribute("dragging"),this._dragging=t}}class h extends HTMLElement{constructor(){super(),this.nextUID=0,this.relayoutRequested=!1,this.dropTargets=[],this.tiles=new i([],[])}connectedCallback(){this.attachShadow({mode:"open"}).innerHTML="\n            <style>\n            :host {\n                display: inline-block;\n                pointer-events: none;\n                transition: width 1s, height 1s;\n            }\n            * {\n                pointer-events: auto;\n            }\n            </style>\n            <slot></slot>\n        "}attachContext(t){if(void 0!==this.context)throw"Cannot call attachContext more than once!";this.context=t,this.context.onGraphChanged(this.nodesChanged.bind(this)),this.nodesChanged(),window.requestAnimationFrame(this.render.bind(this))}addTile(t,e){const s=e.nodeType;let i;return i="EffectNode"==s?document.createElement("radiance-effectnodetile"):"MediaNode"==s?document.createElement("radiance-medianodetile"):document.createElement("radiance-videonodetile"),this.appendChild(i),i.uid=t,i.graph=this,i.updateFromState(e),this.context.onNodeChanged(t,"all",i.updateFromState.bind(i)),i}removeTile(t){this.removeChild(t)}addDropTarget(t,e,s){const i=document.createElement("radiance-droptarget");return i.fromUID=t,i.toUID=e,i.toInput=s,this.appendChild(i),this.dropTargets.push(i),i}removeDropTargets(){this.dropTargets.forEach(t=>{this.removeChild(t)}),this.dropTargets=[]}nodesChanged(){let t=this.context.state();this.nodes=new i(t.vertices,t.edges);const e=this.tiles.vertices.length;let s={};this.tiles.vertices.forEach((t,e)=>{s[t.uid]=e});let n=Array.from(this.tiles.vertices.keys()),r=Array.from(this.tiles.edges.keys()),o=[];const h=(t,e)=>{const s=this.tiles.vertices[e];for(let i=0;i<s.nInputs;i++){let s=this.nodes.upstreamVertexIndex(t,i);if(void 0!==s){const t=this.nodes.vertices[s],d=this.tiles.upstreamEdges[e][i];let a;if(void 0!==d){const e=this.tiles.edges[d].fromVertex,i=this.tiles.vertices[e];i.uid==t&&(n.splice(n.indexOf(e),1),r.splice(r.indexOf(d),1),i.updateFromState(this.context.nodeState(this.nodes.vertices[s],"all")),a=e)}if(void 0===a){for(let e of n)if(this.tiles.vertices[e].uid==t){a=e,n.splice(n.indexOf(a),1),this.tiles.vertices[a].updateFromState(this.context.nodeState(this.nodes.vertices[s],"all"));break}if(void 0===a){const e=this.context.nodeState(this.nodes.vertices[s],"all"),i=this.addTile(t,e);a=this.tiles.addVertex(i),i.uid==this.selectUID&&(this.select(i,!1,!1,!1),i.focus(),this.selectUID=void 0)}o.push({fromVertex:a,toVertex:e,toInput:i})}h(s,a)}}};this.nodes.rootVertices.forEach(t=>{const e=this.nodes.vertices[t];let i;if(e in s)i=s[e],n.splice(n.indexOf(i),1);else{const s=this.context.nodeState(this.nodes.vertices[t],"all");let n=this.addTile(e,s);n.uid=e,i=this.tiles.addVertex(n)}h(t,i)});const d=this.tiles.vertices.length>e||o.length>0||n.length>0||r.length>0;n.forEach(t=>{this.removeTile(this.tiles.vertices[t])}),this.tiles.removeEdges(r),o.forEach(t=>{this.tiles.addEdge(t)}),this.tiles.removeVertices(n),d&&(console.log("New tile vertices:",this.tiles.vertices),console.log("New tile edges:",this.tiles.edges),console.log("Vertices to remove:",n),console.log("Edges to remove:",r),this.relayoutGraph(),this.relayoutDropTargets())}relayoutGraph(){const t=e=>{let s=this.tiles.vertices[e];s.inputHeights=[];for(let i=0;i<s.nInputs;i++){let n=s.minInputHeight(i),r=this.tiles.upstreamVertexIndex(e,i);void 0!==r&&(t(r),n=Math.max(n,this.tiles.vertices[r].height())),s.inputHeights.push(n)}0==s.nInputs&&s.inputHeights.push(s.minInputHeight(0))};for(let e of this.tiles.rootVertices)t(e);const e=t=>{let e=this.tiles.vertices[t],s=e.height(),i=this.tiles.downstreamVertexIndices(t)[0];if(void 0!==i){let t=this.tiles.vertices[i].height()/s;if(t>1)for(let s=0;s<e.nInputs;s++)e.inputHeights[s]*=t}};for(let t of this.tiles.rootVertices)e(t);const s=(t,e)=>{let i=this.tiles.vertices[t];i.y=e;for(let n=0;n<i.nInputs;n++){let r=this.tiles.upstreamVertexIndex(t,n);void 0!==r&&s(r,e),e+=i.inputHeights[n]}};let i=0;for(let t of this.tiles.rootVertices)s(t,i),i+=this.tiles.vertices[t].height();let n=i;const r=(t,e)=>{let s=this.tiles.vertices[t];s.x=e,e-=s.width();for(let i=0;i<s.nInputs;i++){let s=this.tiles.upstreamVertexIndex(t,i);void 0!==s&&r(s,e)}};for(let t of this.tiles.rootVertices)r(t,-this.tiles.vertices[t].width());let o=0;this.tiles.vertices.forEach(t=>{t.x<o&&(o=t.x)}),this.tiles.vertices.forEach(t=>{t.x-=o});let h=-o;this.oldWidth!=h&&(this.style.width=h+"px",this.oldWidth=h),this.oldHeight!=n&&(this.style.height=n+"px",this.oldHeight=n);for(let t in this.tiles.vertices){this.tiles.vertices[t].updateLocation()}}requestRelayout(){this.relayoutRequested=!0}relayoutDropTargets(){this.removeDropTargets(),this.tiles.vertices.forEach((t,e)=>{let s=0;for(let i=0;i<t.nInputs;i++){const n=this.tiles.upstreamVertexIndex(e,i);let r=null;void 0!==n&&(r=this.tiles.vertices[n].uid);const o=t.uid,h=i,d=this.addDropTarget(r,o,h);d.x=t.x,d.y=t.y+s+.5*t.inputHeights[i],s+=t.inputHeights[i]}}),this.tiles.rootVertices.forEach(t=>{const e=this.tiles.vertices[t],s=this.addDropTarget(e.uid,null,null);s.x=e.x+e.width(),s.y=e.y+.5*e.height()}),this.dropTargets.forEach(t=>{t.updateLocation()})}render(t){this.relayoutRequested&&(this.relayoutRequested=!1,this.relayoutGraph()),this.context.render(t),this.tiles.vertices.forEach(t=>{t.render()}),window.requestAnimationFrame(this.render.bind(this))}ensureSelected(t,e,s){t.selected||(e||s?s&&this.selectBetween(this.lastTile,t):this.deselectAll(),t.selected=!0)}select(t,e,s,i){e?i?this.selectBetween(this.lastTile,t):s?t.selected=!1:(this.deselectAll(),t.selected=!0):(s||i||this.deselectAll(),t.selected=!0),this.lastTile=t}deselectAll(){this.tiles.vertices.forEach(t=>{t.selected=!1})}addEdge(t){this.context.addEdge(this.nodes.vertices[t.fromVertex],this.nodes.vertices[t.toVertex],t.toInput)}removeEdgeByIndex(t){const e=this.nodes.edges[t];this.context.removeEdge(this.nodes.vertices[e.fromVertex],this.nodes.vertices[e.toVertex],e.toInput)}deleteSelected(){let t=[];this.tiles.vertices.forEach(e=>{e.selected&&t.indexOf(e.uid)<0&&t.push(e.uid)});const e=Array.from(this.nodes.vertices.keys()).filter(e=>t.indexOf(this.nodes.vertices[e])>=0),s=this.nodes.connectedComponents(e);let i=[];s.forEach(t=>{i.push(...this.nodes.bypassEdges(t))}),t.forEach(t=>{this.context.removeNode(t)}),i.forEach(t=>{this.addEdge(t)}),this.context.flush()}startDragCC(t,e,s){const i=this.tiles.vertices.indexOf(t);if(i<0)throw"Dragged tile not found in graph";const n=Array.from(this.tiles.vertices.keys()).filter(t=>this.tiles.vertices[t].selected||t==i);let r;for(const t of this.tiles.connectedComponents(n))if(t.vertices.indexOf(i)>=0){r=t;break}if(void 0===r)throw"No connected component contains the chosen tile";this.currentDragCC=r,this.currentDragCC.vertices.forEach(t=>{t!=i&&(this.tiles.vertices[t].ccDrag=!0,this.tiles.vertices[t].startDrag(e,s))})}dragCC(t,e){this.tiles.vertices.forEach(s=>{s.ccDrag&&s.drag(t,e)}),this.activateDropTarget(t,e)}endDragCC(){this.tiles.vertices.forEach(t=>{t.ccDrag&&(t.endDrag(),t.ccDrag=!1)}),this.drop()}activateDropTarget(t,e){const s=document.elementsFromPoint(t,e);let i;for(const t of s)if(!(t instanceof n)){i=t;break}const r=this.dropTargets.indexOf(i);this.dropTargets.forEach((t,e)=>{t.active=e==r,t.dragging=!0})}drop(){let t;if(this.dropTargets.forEach((e,s)=>{e.active&&(t=e),e.active=!1,e.dragging=!1}),void 0===t)return;let e=[];this.currentDragCC.vertices.forEach(t=>{const s=this.tiles.vertices[t].uid;e.indexOf(s)<0&&e.push(s)});const s=Array.from(this.nodes.vertices.keys()).filter(t=>e.indexOf(this.nodes.vertices[t])>=0),i=this.nodes.connectedComponents(s);if(1!=i.length)throw"Conversion of CC in tilespace to nodespace resulted in more than one CC";const n=i[0];for(let e of n.vertices){const s=this.nodes.vertices[e];if(t.fromUID==s||t.toUID==s)return void console.log("Can't drop onto an edge that is part of the lifted CC")}if(n.inputEdges.forEach(t=>{this.removeEdgeByIndex(t)}),n.outputEdges.forEach(t=>{this.removeEdgeByIndex(t)}),null!==t.fromUID&&null!==t.toUID&&null!==t.toInput&&this.context.removeEdge(t.fromUID,t.toUID,t.toInput),this.nodes.bypassEdges(n).forEach(t=>{this.addEdge(t)}),null!==t.fromUID){let e=n.rootVertex;for(;!(this.context.nodeState(this.nodes.vertices[e],"all").nInputs<1);){const s=this.nodes.upstreamVertexIndex(e,0);if(void 0===s||n.vertices.indexOf(s)<0){this.nodes.edges[n.inputEdges[0]];this.context.addEdge(t.fromUID,this.nodes.vertices[e],0);break}e=s}}if(null!==t.toUID&&null!==t.toInput){const e=this.nodes.vertices[n.rootVertex];this.context.addEdge(e,t.toUID,t.toInput)}this.context.flush()}selectBetween(t,e){const s=this.tiles.vertices.indexOf(t),i=this.tiles.vertices.indexOf(e);console.log("Select between",s,i),s>=0&&i>=0?this.tiles.verticesBetween(s,i).forEach(t=>{this.tiles.vertices[t].selected=!0}):(t.selected=!0,e.selected=!0)}addNode(t){const e=this.context.addNode(t);if(void 0===e)return void console.log("Error adding node");let s=-1;if(void 0!==this.lastTile&&(s=this.nodes.vertices.indexOf(this.lastTile.uid)),s>=0){const t=this.nodes.downstreamEdges[s],i=t.map(t=>({fromUID:e,toUID:this.nodes.vertices[this.nodes.edges[t].toVertex],toInput:this.nodes.edges[t].toInput}));i.push({fromUID:this.nodes.vertices[s],toUID:e,toInput:0}),t.forEach(t=>{this.removeEdgeByIndex(t)}),i.forEach(t=>{this.context.addEdge(t.fromUID,t.toUID,t.toInput)})}this.selectUID=e,this.context.flush()}adjustSelected(t){const e=new CustomEvent("adjust",{detail:t});this.tiles.vertices.forEach(t=>{t.selected&&t.dispatchEvent(e)})}onScroll(t){this.adjustSelected({control:0,amountRelative:-3e-4*t.deltaY})}}customElements.define("radiance-videonodetile",n),customElements.define("radiance-videonodepreview",r),customElements.define("radiance-graph",h),customElements.define("radiance-droptarget",o);class d extends HTMLElement{constructor(){super()}connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML="\n            <style>\n            :host {\n                display: inline-block;\n            }\n            #outer {\n                display: flex;\n                width: 100%;\n                height: 100%;\n                justify-content:center;\n                align-items:center;\n                overflow: hidden;\n            }\n            #inner {\n                border: 30px solid transparent;\n            }\n            </style> \n            <div id='outer'>\n                <div id='inner'>\n                    <slot></slot>\n                </div>\n            </div>\n        ",this.inner=t.querySelector("#inner"),this.outer=t.querySelector("#outer"),this.outer.addEventListener("mousedown",this.mouseDown.bind(this)),document.addEventListener("mouseup",this.mouseUp.bind(this)),document.addEventListener("mousemove",this.mouseMove.bind(this)),this.outer.addEventListener("touchstart",this.touchStart.bind(this),{passive:!1}),document.addEventListener("touchend",this.touchEnd.bind(this)),document.addEventListener("touchmove",this.touchMove.bind(this)),this.resizeObserver=new ResizeObserver(t=>{this.applyTransformation()}),this.resizeObserver.observe(this.outer),this.resizeObserver.observe(this.inner),this.offsetX=0,this.offsetY=0}applyTransformation(){let t=.5*Math.max(0,this.inner.offsetWidth-this.outer.clientWidth),e=.5*Math.max(0,this.inner.offsetHeight-this.outer.clientHeight);Math.abs(this.offsetX)>t&&(this.offsetX=t*Math.sign(this.offsetX)),Math.abs(this.offsetY)>e&&(this.offsetY=e*Math.sign(this.offsetY)),this.inner.style.transform=`translate(${this.offsetX}px, ${this.offsetY}px)`}touchStart(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);s.target!=this.outer&&s.target!=this.inner||(this.dragging||(this.touchDrag=!0,this.touchId=s.identifier,this.startDrag(s.pageX,s.pageY),t.preventDefault()))}}mouseDown(t){t.target!=this.outer&&t.target!=this.inner||!this.dragging&&1&t.buttons&&(this.mouseDrag=!0,this.startDrag(t.pageX,t.pageY),t.preventDefault())}touchEnd(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);this.dragging&&this.touchDrag&&this.touchId==s.identifier&&(this.touchDrag=!1,this.endDrag())}}mouseUp(t){!this.dragging||!this.mouseDrag||1&t.buttons||(this.mouseDrag=!1,this.endDrag(),t.preventDefault())}touchMove(t){for(let e=0;e<t.changedTouches.length;e++){let s=t.changedTouches.item(e);this.dragging&&this.touchDrag&&this.touchId==s.identifier&&this.drag(s.pageX,s.pageY)}}mouseMove(t){this.dragging&&this.mouseDrag&&(this.drag(t.pageX,t.pageY),t.preventDefault())}startDrag(t,e){this.dragging=!0,this.startDragX=t,this.startDragY=e,this.startDragOffsetX=this.offsetX,this.startDragOffsetY=this.offsetY}endDrag(){this.dragging=!1}drag(t,e){this.offsetX=this.startDragOffsetX+t-this.startDragX,this.offsetY=this.startDragOffsetY+e-this.startDragY,this.applyTransformation()}}customElements.define("radiance-flickable",d);customElements.define("radiance-effectnodetile",class extends n{constructor(){super(),this.nInputs=0,this.intensitySliderBlocked=!1}connectedCallback(){super.connectedCallback(),this.innerHTML='\n            <style>\n                hr, div {\n                    pointer-events: none;\n                }\n            </style>\n            <div style="font-family: sans-serif;" id="title"></div>\n            <hr style="margin: 3px; width: 80%;"></hr>\n            <radiance-videonodepreview style="flex: 1 1 auto;" id="preview"></radiance-videonodepreview>\n            <input type="range" min="0" max="1" step="0.01" id="intensitySlider"></input>\n        ',this.preview=this.querySelector("#preview"),this.intensitySlider=this.querySelector("#intensitySlider"),this.titleDiv=this.querySelector("#title"),this.intensitySlider.addEventListener("input",this.intensitySliderChanged.bind(this)),this.addEventListener("adjust",this.onAdjust.bind(this))}updateFromState(t){super.updateFromState(t),"intensity"in t&&(this.intensitySliderBlocked=!0,this.intensitySlider.value=t.intensity,this.intensitySliderBlocked=!1),"name"in t&&(this.titleDiv.textContent=t.name)}intensitySliderChanged(){if(this.intensitySliderBlocked)return;const t=parseFloat(this.intensitySlider.value);let e=this.graph.context.nodeState(this.uid,"local");e.intensity=t,this.graph.context.setNodeState(this.uid,e)}onAdjust(t){const e=t.detail;this.intensitySlider.value=(parseFloat(this.intensitySlider.value)+e.amountRelative).toString(),this.intensitySliderChanged()}}),customElements.define("radiance-medianodetile",class extends n{constructor(){super(),this.nInputs=1}connectedCallback(){super.connectedCallback(),this.innerHTML='\n            <div style="font-family: sans-serif;" id="title">Media</div>\n            <hr style="margin: 3px; width: 80%;"></hr>\n            <radiance-videonodepreview style="flex: 1 1 auto;" id="preview"></radiance-videonodepreview>\n        ',this.preview=this.querySelector("#preview")}});class a extends HTMLElement{connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML='\n            <style>\n            :host {\n                display: flex;\n                flex-direction: column;\n            }\n\n            #list {\n                display: flex;\n                flex: 1;\n                margin: 10px;\n                overflow: hidden scroll;\n            }\n\n            #nodeName {\n                width: 100%;\n            }\n            </style>\n            <div id="list" width></div>\n            <input type="text" id="nodeName"></input>\n        ',this.nodeNameInput=t.querySelector("#nodeName"),this.list=t.querySelector("#list"),document.addEventListener("keypress",this.onKeyPress.bind(this)),this.nodeNameInput.addEventListener("keydown",this.onTextBoxKeyPress.bind(this)),this.nodeNameInput.addEventListener("input",this.onTextBoxInput.bind(this))}attachGraph(t){if(void 0!==this.graph)throw"Cannot call attachGraph more than once!";this.graph=t,this.context=t.context,this.context.onLibraryChanged(this.libraryChanged.bind(this)),this.libraryChanged()}renderLibrary(){const t=this.nodeNameInput.value;let e;if(""==t)e=this.library,this.bestMatch=void 0;else{e={};for(const s in this.library){const i=this.library[s];"name"in i&&i.name.startsWith(t)&&(e[s]=i)}this.bestMatch=Object.keys(e)[0]}const s=document.createElement("ul");this.list.innerHTML="",this.list.appendChild(s);for(const t in e){const i=document.createElement("li");i.textContent=e[t].name,i.addEventListener("click",e=>{this.instantiateFromLibrary(t),this.done()}),s.appendChild(i)}}libraryChanged(){this.library=this.context.library(),this.renderLibrary()}instantiateFromLibrary(t){void 0!==this.graph&&this.graph.addNode(this.library[t])}onKeyPress(t){"Semicolon"==t.code&&t.shiftKey&&t.target!=this&&(this.nodeNameInput.focus(),t.preventDefault())}onTextBoxInput(t){this.renderLibrary()}done(){this.nodeNameInput.value="",this.renderLibrary(),this.blur()}onTextBoxKeyPress(t){"Enter"==t.code?(void 0!==this.bestMatch&&this.instantiateFromLibrary(this.bestMatch),this.done()):"Escape"==t.key&&this.done()}}customElements.define("radiance-library",a);class c extends HTMLElement{constructor(){super(),this._closed=!1}connectedCallback(){const t=this.attachShadow({mode:"open"});t.innerHTML='\n            <style>\n            :host {\n                display: inline-block;\n                overflow: hidden;\n                pointer-events: none;\n            }\n\n            #outer {\n                position: static;\n                display: inline-block;\n                width: 100%;\n                height: 100%;\n                will-change: transform;\n                transition: transform 0.5s;\n                pointer-events: all;\n                background-color: #333333EE; /* TODO expose this outside of this element */\n            }\n\n            #inner {\n                width: 100%;\n                height: 100%;\n                transition: opacity 0.5s;\n                padding: 10px;\n                padding-right: 30px;\n                box-sizing: border-box;\n            }\n\n            #handle {\n                position: absolute;\n                right: 0px;\n                width: 20px;\n                top: 0px;\n                bottom: 0px;\n                background-color: white;\n            }\n\n            :host([closed]) #outer {\n                transform: translate(calc(-100% + 10px), 0px);\n            }\n            </style>\n            <div id="outer">\n                <div id="inner">\n                    <slot></slot>\n                </div>\n                <div id="handle">\n            </div>\n            </div>\n        ',this.handle=t.querySelector("#handle"),this.handle.addEventListener("click",this.onClick.bind(this)),this._closed=this.hasAttribute("closed"),Array.from(this.children).forEach(t=>{t.addEventListener("focus",this.checkChildFocus.bind(this)),t.addEventListener("blur",this.checkChildFocus.bind(this))})}onClick(t){this.closed=!this.closed}get closed(){return this._closed}set closed(t){t&&!this._closed?this.setAttribute("closed","true"):!t&&this._closed&&this.removeAttribute("closed"),this._closed=t}checkChildFocus(t){const e=Array.from(this.children).reduce((t,e)=>t||e==document.activeElement,!1);this.closed=!e}}customElements.define("radiance-drawer",c);class l extends HTMLElement{constructor(){super(),this.timestamps=[],this.historyLength=15}connectedCallback(){this.shadow=this.attachShadow({mode:"open"}),this.shadow.textContent="FPS: ???",window.requestAnimationFrame(this.onFrame.bind(this))}onFrame(t){this.timestamps.push(t),this.timestamps.length>this.historyLength&&(this.timestamps=this.timestamps.slice(-this.historyLength));const e=this.timestamps[0],s=this.timestamps.length-1;if(s>0){const i=Math.round(s/(.001*(t-e)));this.shadow.textContent="FPS: "+i}window.requestAnimationFrame(this.onFrame.bind(this))}}customElements.define("radiance-fps-counter",l)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi91aS9ncmFwaF9kYXRhLnRzIiwid2VicGFjazovLy8uL3VpL2dyYXBoLnRzIiwid2VicGFjazovLy8uL3VpL2ZsaWNrYWJsZS50cyIsIndlYnBhY2s6Ly8vLi91aS90aWxlcy50cyIsIndlYnBhY2s6Ly8vLi91aS9saWJyYXJ5LnRzIiwid2VicGFjazovLy8uL3VpL2RyYXdlci50cyIsIndlYnBhY2s6Ly8vLi91aS9mcHMudHMiXSwibmFtZXMiOlsiR3JhcGhEYXRhIiwidmVydGljZXMiLCJlZGdlcyIsInRoaXMiLCJyb290VmVydGljZXMiLCJ1cHN0cmVhbUVkZ2VzIiwiZG93bnN0cmVhbUVkZ2VzIiwiZm9yRWFjaCIsInZlcnRleCIsImFkZFZlcnRleCIsImVkZ2UiLCJhZGRFZGdlIiwidmVydGV4SW5kZXgiLCJpbnB1dCIsInVuZGVmaW5lZCIsImZyb21WZXJ0ZXgiLCJtYXAiLCJ0b1ZlcnRleCIsImluZGV4IiwibGVuZ3RoIiwicHVzaCIsInRvSW5wdXQiLCJpeCIsImluZGV4T2YiLCJzcGxpY2UiLCJpbmRpY2VzIiwibWFwcGluZyIsIm5ld0luZGV4IiwiXyIsIm9sZEluZGV4IiwiZmlsdGVyIiwidiIsImkiLCJpbmRpY2VzX3NvcnRlZCIsInNsaWNlIiwic29ydCIsImEiLCJiIiwicmVtb3ZlRWRnZSIsImUiLCJ2ZXJ0ZXhJbmRpY2VzIiwicmVkdWNlIiwiaXNSb290IiwiY29ubmVjdGVkQ29tcG9uZW50Iiwicm9vdFZlcnRleCIsImludGVybmFsRWRnZXMiLCJpbnB1dEVkZ2VzIiwib3V0cHV0RWRnZXMiLCJ0cmF2ZXJzZSIsIm5ld091dHB1dEVkZ2VzIiwiZG93bnN0cmVhbUVkZ2VJbmRleCIsIm5ld0lucHV0RWRnZXMiLCJ1cHN0cmVhbUVkZ2VJbmRleCIsIm5ld0ludGVybmFsRWRnZXMiLCJ1cHN0cmVhbVZlcnRpY2VzIiwiZWRnZUluZGV4IiwidmFsdWUiLCJzZWxmIiwidXBzdHJlYW1WZXJ0ZXhJbmRleCIsImNjIiwicmVzdWx0Iiwib3V0cHV0RWRnZUluZGV4Iiwib3V0cHV0RWRnZSIsInZlcnRleDEiLCJ2ZXJ0ZXgyIiwicGF0aCIsInRhcmdldCIsImRvd25zdHJlYW1WZXJ0ZXhJbmRpY2VzIiwiZG93bnN0cmVhbVZlcnRleEluZGV4IiwiY29uY2F0IiwiVmlkZW9Ob2RlVGlsZSIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJuSW5wdXRzIiwiaW5wdXRIZWlnaHRzIiwidWlkIiwib2Zmc2V0WCIsIm9mZnNldFkiLCJkcmFnZ2luZyIsIm1vdXNlRHJhZyIsInRvdWNoRHJhZyIsImNjRHJhZyIsIl9zZWxlY3RlZCIsInNoYWRvdyIsImF0dGFjaFNoYWRvdyIsIm1vZGUiLCJpbm5lckhUTUwiLCJpbm5lciIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwibW91c2VEb3duIiwiYmluZCIsImRvY3VtZW50IiwibW91c2VVcCIsIm1vdXNlTW92ZSIsInRvdWNoU3RhcnQiLCJwYXNzaXZlIiwidG91Y2hFbmQiLCJ0b3VjaE1vdmUiLCJ0YWJJbmRleCIsImtleVByZXNzIiwib25TY3JvbGwiLCJzdHlsZSIsImhlaWdodCIsIndpZHRoIiwicHJldmlldyIsInJlbmRlciIsImRhdGEiLCJncmFwaCIsInJlcXVlc3RSZWxheW91dCIsImV2ZW50IiwiY2hhbmdlZFRvdWNoZXMiLCJ0b3VjaCIsIml0ZW0iLCJ0b3VjaElkIiwiaWRlbnRpZmllciIsImRyYWdDdHJsIiwiY3RybEtleSIsImRyYWdTaGlmdCIsInNoaWZ0S2V5IiwiZHJhZ1NlbGVjdGVkIiwic2VsZWN0ZWQiLCJlbnN1cmVTZWxlY3RlZCIsImZvY3VzIiwic3RhcnREcmFnIiwicGFnZVgiLCJwYWdlWSIsInByZXZlbnREZWZhdWx0IiwiYnV0dG9ucyIsImVuZERyYWciLCJkcmFnIiwicHRYIiwicHRZIiwic3RhcnREcmFnWCIsInN0YXJ0RHJhZ1kiLCJ3YXNDbGljayIsInJlbW92ZUF0dHJpYnV0ZSIsInVwZGF0ZUxvY2F0aW9uIiwic2VsZWN0IiwiZW5kRHJhZ0NDIiwic2V0QXR0cmlidXRlIiwic3RhcnREcmFnQ0MiLCJkcmFnQ0MiLCJuZXdXaWR0aCIsIm5ld0hlaWdodCIsIm9sZFdpZHRoIiwib2xkSGVpZ2h0IiwidHJhbnNmb3JtIiwieCIsInkiLCJjb2RlIiwiZGVsZXRlU2VsZWN0ZWQiLCJzZWxlY3Rpb24iLCJBcnJheSIsImZyb20iLCJ0aWxlcyIsImtleXMiLCJjb25zb2xlIiwibG9nIiwiY29ubmVjdGVkQ29tcG9uZW50cyIsImNvbXBvbmVudCIsIlZpZGVvTm9kZVByZXZpZXciLCJjb250ZW50IiwidGlsZSIsImNvbnRleHQiLCJjbGVhckVsZW1lbnQiLCJwYWludE5vZGUiLCJEcm9wVGFyZ2V0IiwiX2FjdGl2ZSIsIl9kcmFnZ2luZyIsIm5leHRVSUQiLCJyZWxheW91dFJlcXVlc3RlZCIsImRyb3BUYXJnZXRzIiwib25HcmFwaENoYW5nZWQiLCJub2Rlc0NoYW5nZWQiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJzdGF0ZSIsInR5cGUiLCJub2RlVHlwZSIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInVwZGF0ZUZyb21TdGF0ZSIsIm9uTm9kZUNoYW5nZWQiLCJyZW1vdmVDaGlsZCIsImZyb21VSUQiLCJ0b1VJRCIsImRyb3BUYXJnZXQiLCJub2RlcyIsIm9yaWdOdW1UaWxlVmVydGljZXMiLCJ0aWxlRm9yVUlEIiwidGlsZVZlcnRpY2VzVG9EZWxldGUiLCJ0aWxlRWRnZXNUb0RlbGV0ZSIsInRpbGVFZGdlc1RvQ3JlYXRlIiwibm9kZVZlcnRleCIsInRpbGVWZXJ0ZXgiLCJ1cHN0cmVhbU5vZGUiLCJub2RlVUlEIiwidXBzdHJlYW1UaWxlRWRnZUluZGV4IiwidXBzdHJlYW1UaWxlVmVydGV4SW5kZXgiLCJ0cmlhbFVwc3RyZWFtVGlsZVZlcnRleEluZGV4IiwidXBzdHJlYW1UaWxlIiwibm9kZVN0YXRlIiwiYWRkVGlsZSIsInNlbGVjdFVJRCIsInN0YXJ0Tm9kZUluZGV4Iiwic3RhcnRUaWxlSW5kZXgiLCJjaGFuZ2VkIiwicmVtb3ZlVGlsZSIsInJlbW92ZUVkZ2VzIiwicmVtb3ZlVmVydGljZXMiLCJyZWxheW91dEdyYXBoIiwicmVsYXlvdXREcm9wVGFyZ2V0cyIsInNldElucHV0SGVpZ2h0c0Z3ZCIsIm1pbklucHV0SGVpZ2h0IiwiTWF0aCIsIm1heCIsInNldElucHV0SGVpZ2h0c1JldiIsInJhdGlvIiwic2V0WUNvb3JkaW5hdGUiLCJzZXRYQ29vcmRpbmF0ZSIsInVwc3RyZWFtIiwic21hbGxlc3RYIiwicmVtb3ZlRHJvcFRhcmdldHMiLCJ0aWxlSW5kZXgiLCJvZmZzZXRIZWlnaHQiLCJmcm9tSW5kZXgiLCJkdCIsImFkZERyb3BUYXJnZXQiLCJ0Iiwic2VsZWN0QmV0d2VlbiIsImxhc3RUaWxlIiwiZGVzZWxlY3RBbGwiLCJ1aWRzVG9EZWxldGUiLCJjY3MiLCJieXBhc3NFZGdlcyIsInJlbW92ZU5vZGUiLCJmbHVzaCIsImN1cnJlbnREcmFnQ0MiLCJhY3RpdmF0ZURyb3BUYXJnZXQiLCJkcm9wIiwiZWxlbWVudHMiLCJlbGVtZW50c0Zyb21Qb2ludCIsImVsZW1lbnQiLCJhY3RpdmVEcm9wVGFyZ2V0SW5kZXgiLCJhY3RpdmUiLCJhY3RpdmVEcm9wVGFyZ2V0IiwidWlkc1RvTW92ZSIsInJlbW92ZUVkZ2VCeUluZGV4IiwibGVhZk5vZGUiLCJuZXh0IiwidGlsZTEiLCJ0aWxlMiIsImluZGV4MSIsImluZGV4MiIsInZlcnRpY2VzQmV0d2VlbiIsImFkZE5vZGUiLCJub2RlVmVydGV4SW5kZXgiLCJlZGdlc1RvUmVtb3ZlIiwiZWRnZXNUb0FkZCIsImRldGFpbCIsIm5ld0V2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiYWRqdXN0U2VsZWN0ZWQiLCJjb250cm9sIiwiYW1vdW50UmVsYXRpdmUiLCJkZWx0YVkiLCJjdXN0b21FbGVtZW50cyIsImRlZmluZSIsIkZsaWNrYWJsZSIsIm91dGVyIiwicmVzaXplT2JzZXJ2ZXIiLCJSZXNpemVPYnNlcnZlciIsImVudHJpZXMiLCJhcHBseVRyYW5zZm9ybWF0aW9uIiwib2JzZXJ2ZSIsInJhbmdlWCIsIm9mZnNldFdpZHRoIiwiY2xpZW50V2lkdGgiLCJyYW5nZVkiLCJjbGllbnRIZWlnaHQiLCJhYnMiLCJzaWduIiwic3RhcnREcmFnT2Zmc2V0WCIsInN0YXJ0RHJhZ09mZnNldFkiLCJpbnRlbnNpdHlTbGlkZXJCbG9ja2VkIiwiY29ubmVjdGVkQ2FsbGJhY2siLCJpbnRlbnNpdHlTbGlkZXIiLCJ0aXRsZURpdiIsImludGVuc2l0eVNsaWRlckNoYW5nZWQiLCJvbkFkanVzdCIsImludGVuc2l0eSIsInRleHRDb250ZW50IiwibmFtZSIsIm5ld0ludGVuc2l0eSIsInBhcnNlRmxvYXQiLCJzZXROb2RlU3RhdGUiLCJ0b1N0cmluZyIsIkxpYnJhcnkiLCJub2RlTmFtZUlucHV0IiwibGlzdCIsIm9uS2V5UHJlc3MiLCJvblRleHRCb3hLZXlQcmVzcyIsIm9uVGV4dEJveElucHV0Iiwib25MaWJyYXJ5Q2hhbmdlZCIsImxpYnJhcnlDaGFuZ2VkIiwiZmlsdGVyVGV4dCIsImZpbHRlcmVkTGlicmFyeSIsImxpYnJhcnkiLCJiZXN0TWF0Y2giLCJrIiwic3RhcnRzV2l0aCIsIk9iamVjdCIsInVsIiwibGkiLCJpbnN0YW50aWF0ZUZyb21MaWJyYXJ5IiwiZG9uZSIsInJlbmRlckxpYnJhcnkiLCJibHVyIiwia2V5IiwiRHJhd2VyIiwiX2Nsb3NlZCIsImhhbmRsZSIsIm9uQ2xpY2siLCJoYXNBdHRyaWJ1dGUiLCJjaGlsZHJlbiIsImNoaWxkIiwiY2hlY2tDaGlsZEZvY3VzIiwiY2xvc2VkIiwiYWNjIiwiYWN0aXZlRWxlbWVudCIsIkZQU0NvdW50ZXIiLCJ0aW1lc3RhbXBzIiwiaGlzdG9yeUxlbmd0aCIsIm9uRnJhbWUiLCJ0aW1lc3RhbXAiLCJvbGRlc3QiLCJuRnJhbWVzIiwiZnBzIiwicm91bmQiXSwibWFwcGluZ3MiOiJzSUFjTyxNQUFNQSxFQU9ULFlBQVlDLEVBQWVDLEdBQ3ZCQyxLQUFLRixTQUFXLEdBQ2hCRSxLQUFLRCxNQUFRLEdBQ2JDLEtBQUtDLGFBQWUsR0FDcEJELEtBQUtFLGNBQWdCLEdBQ3JCRixLQUFLRyxnQkFBa0IsR0FFdkJMLEVBQVNNLFFBQVFDLElBQ2JMLEtBQUtNLFVBQVVELEtBRW5CTixFQUFNSyxRQUFRRyxJQUNWUCxLQUFLUSxRQUFRRCxLQUlyQixvQkFBb0JFLEVBQXFCQyxHQUNyQyxNQUFNSCxFQUFPUCxLQUFLRSxjQUFjTyxHQUFhQyxHQUM3QyxZQUFhQyxJQUFUSixPQUNBLEVBRU9QLEtBQUtELE1BQU1RLEdBQU1LLFdBSWhDLHdCQUF3QkgsR0FFcEIsT0FEY1QsS0FBS0csZ0JBQWdCTSxHQUN0QkksSUFBSU4sR0FBUVAsS0FBS0QsTUFBTVEsR0FBTU8sVUFHOUMsVUFBVVQsR0FDTixNQUFNVSxFQUFRZixLQUFLRixTQUFTa0IsT0FLNUIsT0FKQWhCLEtBQUtGLFNBQVNtQixLQUFLWixHQUNuQkwsS0FBS0UsY0FBY2UsS0FBSyxJQUN4QmpCLEtBQUtHLGdCQUFnQmMsS0FBSyxJQUMxQmpCLEtBQUtDLGFBQWFnQixLQUFLRixHQUNoQkEsRUFHWCxRQUFRUixHQUNKLE1BQU1RLEVBQVFmLEtBQUtELE1BQU1pQixPQUd6QixHQUZBaEIsS0FBS0QsTUFBTWtCLEtBQUtWLFFBRXdDSSxJQUFwRFgsS0FBS0UsY0FBY0ssRUFBS08sVUFBVVAsRUFBS1csU0FDdkMsS0FBTSxVQUFVWCxFQUFLTyxrQkFBa0JQLEVBQUtXLHlDQUVoRGxCLEtBQUtFLGNBQWNLLEVBQUtPLFVBQVVQLEVBQUtXLFNBQVdILEVBQ2xEZixLQUFLRyxnQkFBZ0JJLEVBQUtLLFlBQVlLLEtBQUtGLEdBRTNDLElBQUlJLEVBQUtuQixLQUFLQyxhQUFhbUIsUUFBUWIsRUFBS0ssWUFDcENPLEdBQU0sR0FDTm5CLEtBQUtDLGFBQWFvQixPQUFPRixFQUFJLEdBSXJDLGVBQWVHLEdBS1gsSUFBSUMsRUFBb0IsR0FDcEJDLEVBQVcsRUFDZnhCLEtBQUtGLFNBQVNNLFFBQVEsQ0FBQ3FCLEVBQUdDLEtBQ2xCSixFQUFRRixRQUFRTSxHQUFZLElBRTVCSCxFQUFRRyxHQUFZRixFQUNwQkEsT0FLUnhCLEtBQUtGLFNBQVdFLEtBQUtGLFNBQVM2QixPQUFPLENBQUNGLEVBQUdWLElBQVVPLEVBQVFGLFFBQVFMLEdBQVMsR0FDNUVmLEtBQUtDLGFBQWVELEtBQUtDLGFBQWEwQixPQUFPQyxHQUFLTixFQUFRRixRQUFRUSxHQUFLLEdBQ3ZFNUIsS0FBS0UsY0FBZ0JGLEtBQUtFLGNBQWN5QixPQUFPLENBQUNGLEVBQUdWLElBQVVPLEVBQVFGLFFBQVFMLEdBQVMsR0FDdEZmLEtBQUtHLGdCQUFrQkgsS0FBS0csZ0JBQWdCd0IsT0FBTyxDQUFDRixFQUFHVixJQUFVTyxFQUFRRixRQUFRTCxHQUFTLEdBRzFGZixLQUFLRCxNQUFNSyxRQUFRRyxJQUNmQSxFQUFLSyxXQUFhVyxFQUFRaEIsRUFBS0ssWUFDL0JMLEVBQUtPLFNBQVdTLEVBQVFoQixFQUFLTyxZQUVqQ2QsS0FBS0MsYUFBYUcsUUFBUSxDQUFDd0IsRUFBR0MsS0FDMUI3QixLQUFLQyxhQUFhNEIsR0FBS04sRUFBUUssS0FJdkMsWUFBWU4sR0FDUixJQUFJUSxFQUFpQlIsRUFBUVMsUUFDN0JELEVBQWVFLEtBQUssQ0FBQ0MsRUFBR0MsSUFBTUEsRUFBSUQsR0FDbENILEVBQWUxQixRQUFRVyxJQUNuQmYsS0FBS21DLFdBQVdwQixLQUl4QixXQUFXQSxHQUNQLE1BQU1SLEVBQU9QLEtBQUtELE1BQU1nQixHQUN4QmYsS0FBS0QsTUFBTXNCLE9BQU9OLEVBQU8sUUFFSEosSUFBbEJKLEVBQUtPLGlCQUNFZCxLQUFLRSxjQUFjSyxFQUFLTyxVQUFVUCxFQUFLVyxjQUUxQlAsSUFBcEJKLEVBQUtLLFlBQ0xaLEtBQUtHLGdCQUFnQkksRUFBS0ssWUFBWVMsT0FBT3JCLEtBQUtHLGdCQUFnQkksRUFBS0ssWUFBWVEsUUFBUUwsR0FBUSxRQUcvRUosSUFBcEJKLEVBQUtLLFlBQTRFLEdBQWhEWixLQUFLRyxnQkFBZ0JJLEVBQUtLLFlBQVlJLFFBQ3ZFaEIsS0FBS0MsYUFBYWdCLEtBQUtWLEVBQUtLLFlBR2hDWixLQUFLRixTQUFTTSxRQUFRLENBQUNxQixFQUFHRyxLQUN0QjVCLEtBQUtFLGNBQWMwQixHQUFHeEIsUUFBUSxDQUFDZ0MsRUFBR1AsS0FDMUJPLEVBQUlyQixJQUNKZixLQUFLRSxjQUFjMEIsR0FBR0MsR0FBS08sRUFBSSxLQUd2Q3BDLEtBQUtHLGdCQUFnQnlCLEdBQUd4QixRQUFRLENBQUNnQyxFQUFHUCxLQUM1Qk8sRUFBSXJCLElBQ0pmLEtBQUtHLGdCQUFnQnlCLEdBQUdDLEdBQUtPLEVBQUksT0FPakQsb0JBQW9CQyxHQU9oQixPQU44QkEsRUFBY1YsT0FBT2xCLEdBQ3hDVCxLQUFLRyxnQkFBZ0JNLEdBQWE2QixPQUFPLENBQUNDLEVBQVFoQyxJQUM5Q2dDLEdBQVVGLEVBQWNqQixRQUFRcEIsS0FBS0QsTUFBTVEsR0FBTU8sVUFBWSxHQUNyRSxJQUdzQkQsSUFBS0osSUFDOUIsSUFBSStCLEVBQXlDLENBQ3pDMUMsU0FBVSxHQUNWMkMsV0FBWWhDLEVBQ1ppQyxjQUFlLEdBQ2ZDLFdBQVksR0FDWkMsWUFBYSxJQUlqQixNQUFNQyxFQUFZcEMsSUFFZCtCLEVBQW1CMUMsU0FBU21CLEtBQUtSLEdBR2pDLE1BQU1xQyxFQUFpQjlDLEtBQUtHLGdCQUFnQk0sR0FBYWtCLE9BQU9vQixHQUNyRFYsRUFBY2pCLFFBQVFwQixLQUFLRCxNQUFNZ0QsR0FBcUJqQyxVQUFZLEdBRTdFMEIsRUFBbUJJLFlBQVkzQixRQUFRNkIsR0FHdkMsTUFBTUUsRUFBZ0JoRCxLQUFLRSxjQUFjTyxHQUFha0IsT0FBT3NCLEdBQ2xEWixFQUFjakIsUUFBUXBCLEtBQUtELE1BQU1rRCxHQUFtQnJDLFlBQWMsR0FFN0U0QixFQUFtQkcsV0FBVzFCLFFBQVErQixHQUd0QyxNQUFNRSxFQUFtQmxELEtBQUtFLGNBQWNPLEdBQWFrQixPQUFPc0IsR0FDckRaLEVBQWNqQixRQUFRcEIsS0FBS0QsTUFBTWtELEdBQW1CckMsYUFBZSxHQUU5RTRCLEVBQW1CRSxjQUFjekIsUUFBUWlDLEdBQ3pDLElBQUlDLEVBQW1CRCxFQUFpQnJDLElBQUl1QyxHQUFhcEQsS0FBS0QsTUFBTXFELEdBQVd4QyxZQUMvRXVDLEVBQW1CQSxFQUFpQnhCLE9BQU8sQ0FBQzBCLEVBQU90QyxFQUFPdUMsSUFBU0EsRUFBS2xDLFFBQVFpQyxJQUFVdEMsR0FDMUZvQyxFQUFpQi9DLFFBQVFtRCxJQUNyQlYsRUFBU1UsTUFLakIsT0FEQVYsRUFBU3BDLEdBQ0YrQixJQU1mLFlBQVlnQixHQUNSLElBQUlDLEVBQVMsR0FhYixPQVpJRCxFQUFHYixXQUFXM0IsUUFBVSxHQUN4QndDLEVBQUdaLFlBQVl4QyxRQUFRc0QsSUFDbkIsTUFBTUMsRUFBYTNELEtBQUtELE1BQU0yRCxHQUMxQkMsRUFBVy9DLFlBQWM0QyxFQUFHZixZQUM1QmdCLEVBQU94QyxLQUFLLENBQ1JMLFdBQVlaLEtBQUtELE1BQU15RCxFQUFHYixXQUFXLElBQUkvQixXQUN6Q0UsU0FBVTZDLEVBQVc3QyxTQUNyQkksUUFBU3lDLEVBQVd6QyxZQUs3QnVDLEVBS1gsZ0JBQWdCRyxFQUFpQkMsR0FDN0IsSUFBSUosRUFBUyxHQUNiLE1BQU1aLEVBQVcsQ0FBQ2lCLEVBQWdCQyxLQUM5QixNQUFNMUQsRUFBU3lELEVBQUtBLEVBQUs5QyxPQUFTLEdBQzlCWCxHQUFVMEQsRUFDVk4sRUFBT3hDLFFBQVE2QyxHQUVmOUQsS0FBS2dFLHdCQUF3QjNELEdBQVFELFFBQVE2RCxJQUNyQ0gsRUFBSzFDLFFBQVE2QyxHQUF5QixHQUN0Q3BCLEVBQVNpQixFQUFLSSxPQUFPLENBQUNELElBQXlCRixNQWEvRCxPQU5BbEIsRUFBUyxDQUFDZSxHQUFVQyxHQUNwQmhCLEVBQVMsQ0FBQ2dCLEdBQVVELEdBR3BCSCxFQUFTQSxFQUFPOUIsT0FBTyxDQUFDMEIsRUFBT3RDLEVBQU91QyxJQUFTQSxFQUFLbEMsUUFBUWlDLElBQVV0QyxHQUUvRDBDLEdDbk9SLE1BQU1VLFVBQXNCQyxZQThCL0IsY0FDSUMsUUFDQXJFLEtBQUtzRSxRQUFVLEVBQ2Z0RSxLQUFLdUUsYUFBZSxHQUNwQnZFLEtBQUt3RSxJQUFNLEtBRVh4RSxLQUFLeUUsUUFBVSxFQUNmekUsS0FBSzBFLFFBQVUsRUFDZjFFLEtBQUsyRSxVQUFXLEVBQ2hCM0UsS0FBSzRFLFdBQVksRUFDakI1RSxLQUFLNkUsV0FBWSxFQUNqQjdFLEtBQUs4RSxRQUFTLEVBRWQ5RSxLQUFLK0UsV0FBWSxFQUdyQixvQkFDSSxNQUFNQyxFQUFTaEYsS0FBS2lGLGFBQWEsQ0FBQ0MsS0FBTSxTQUN4Q0YsRUFBT0csVUFBWSw4NkRBa0VuQm5GLEtBQUtvRixNQUFRSixFQUFPSyxjQUFjLFVBRWxDckYsS0FBS29GLE1BQU1FLGlCQUFpQixZQUFhdEYsS0FBS3VGLFVBQVVDLEtBQUt4RixPQUM3RHlGLFNBQVNILGlCQUFpQixVQUFXdEYsS0FBSzBGLFFBQVFGLEtBQUt4RixPQUN2RHlGLFNBQVNILGlCQUFpQixZQUFhdEYsS0FBSzJGLFVBQVVILEtBQUt4RixPQUMzREEsS0FBS29GLE1BQU1FLGlCQUFpQixhQUFjdEYsS0FBSzRGLFdBQVdKLEtBQUt4RixNQUFPLENBQUU2RixTQUFTLElBQ2pGSixTQUFTSCxpQkFBaUIsV0FBWXRGLEtBQUs4RixTQUFTTixLQUFLeEYsT0FDekR5RixTQUFTSCxpQkFBaUIsWUFBYXRGLEtBQUsrRixVQUFVUCxLQUFLeEYsT0FDM0RBLEtBQUtnRyxTQUFXLEVBRWhCaEcsS0FBS3NGLGlCQUFpQixXQUFZdEYsS0FBS2lHLFNBQVNULEtBQUt4RixPQUNyREEsS0FBS3NGLGlCQUFpQixRQUFTdEYsS0FBS2tHLFNBQVNWLEtBQUt4RixPQUd0RCxRQUdJLE9BQU8sSUFHWCxlQUFlVSxHQU1YLE9BQU8sSUFHWCxTQUdJLE9BQU9WLEtBQUt1RSxhQUFhakMsT0FBTyxDQUFDTCxFQUFHQyxJQUFNRCxFQUFJQyxFQUFHLEdBR3JELGFBQ0lsQyxLQUFLbUcsTUFBTUMsT0FBWXBHLEtBQUtvRyxTQUFSLEtBQ3BCcEcsS0FBS21HLE1BQU1FLE1BQVdyRyxLQUFLcUcsUUFBUixLQUd2QixTQUNRckcsS0FBS3NHLFNBQ0x0RyxLQUFLc0csUUFBUUMsT0FBT3ZHLE1BSTVCLGdCQUFnQndHLEdBQ1IsWUFBYUEsR0FBUUEsRUFBS2xDLFNBQVd0RSxLQUFLc0UsVUFDMUN0RSxLQUFLc0UsUUFBVWtDLEVBQUtsQyxRQUNwQnRFLEtBQUt5RyxNQUFNQyxtQkFJbkIsV0FBV0MsR0FDUCxJQUFLLElBQUk5RSxFQUFJLEVBQUdBLEVBQUk4RSxFQUFNQyxlQUFlNUYsT0FBUWEsSUFBSyxDQUNsRCxJQUFJZ0YsRUFBUUYsRUFBTUMsZUFBZUUsS0FBS2pGLEdBQ2xDZ0YsRUFBTTlDLFFBQVUvRCxLQUFLb0YsT0FBU3lCLEVBQU05QyxRQUFVL0QsS0FBS29GLFFBSWxEcEYsS0FBSzJFLFdBQ04zRSxLQUFLNkUsV0FBWSxFQUNqQjdFLEtBQUsrRyxRQUFVRixFQUFNRyxXQUNyQmhILEtBQUtpSCxTQUFXTixFQUFNTyxRQUN0QmxILEtBQUttSCxVQUFZUixFQUFNUyxTQUN2QnBILEtBQUtxSCxhQUFlckgsS0FBS3NILFNBQ3pCdEgsS0FBS3lHLE1BQU1jLGVBQWV2SCxLQUFNQSxLQUFLaUgsU0FBVWpILEtBQUttSCxXQUNwRG5ILEtBQUt3SCxRQUNMeEgsS0FBS3lILFVBQVVaLEVBQU1hLE1BQU9iLEVBQU1jLE9BQ2xDaEIsRUFBTWlCLG9CQUtsQixVQUFVakIsR0FDRkEsRUFBTTVDLFFBQVUvRCxLQUFLb0YsT0FBU3VCLEVBQU01QyxRQUFVL0QsS0FBS29GLFFBSWxEcEYsS0FBSzJFLFVBQTZCLEVBQWhCZ0MsRUFBTWtCLFVBQ3pCN0gsS0FBSzRFLFdBQVksRUFDakI1RSxLQUFLaUgsU0FBV04sRUFBTU8sUUFDdEJsSCxLQUFLbUgsVUFBWVIsRUFBTVMsU0FDdkJwSCxLQUFLcUgsYUFBZXJILEtBQUtzSCxTQUN6QnRILEtBQUt5RyxNQUFNYyxlQUFldkgsS0FBTUEsS0FBS2lILFNBQVVqSCxLQUFLbUgsV0FDcERuSCxLQUFLd0gsUUFDTHhILEtBQUt5SCxVQUFVZCxFQUFNZSxNQUFPZixFQUFNZ0IsT0FDbENoQixFQUFNaUIsa0JBSWQsU0FBU2pCLEdBQ0wsSUFBSyxJQUFJOUUsRUFBSSxFQUFHQSxFQUFJOEUsRUFBTUMsZUFBZTVGLE9BQVFhLElBQUssQ0FDbEQsSUFBSWdGLEVBQVFGLEVBQU1DLGVBQWVFLEtBQUtqRixHQUNsQzdCLEtBQUsyRSxVQUFZM0UsS0FBSzZFLFdBQWE3RSxLQUFLK0csU0FBV0YsRUFBTUcsYUFDekRoSCxLQUFLNkUsV0FBWSxFQUNqQjdFLEtBQUs4SCxZQUtqQixRQUFRbkIsSUFDQTNHLEtBQUsyRSxXQUFZM0UsS0FBSzRFLFdBQStCLEVBQWhCK0IsRUFBTWtCLFVBQzNDN0gsS0FBSzRFLFdBQVksRUFDakI1RSxLQUFLOEgsVUFDTG5CLEVBQU1pQixrQkFJZCxVQUFVakIsR0FDTixJQUFLLElBQUk5RSxFQUFJLEVBQUdBLEVBQUk4RSxFQUFNQyxlQUFlNUYsT0FBUWEsSUFBSyxDQUNsRCxJQUFJZ0YsRUFBUUYsRUFBTUMsZUFBZUUsS0FBS2pGLEdBQ2xDN0IsS0FBSzJFLFVBQVkzRSxLQUFLNkUsV0FBYTdFLEtBQUsrRyxTQUFXRixFQUFNRyxZQUN6RGhILEtBQUsrSCxLQUFLbEIsRUFBTWEsTUFBT2IsRUFBTWMsUUFLekMsVUFBVWhCLEdBQ0YzRyxLQUFLMkUsVUFBWTNFLEtBQUs0RSxZQUN0QjVFLEtBQUsrSCxLQUFLcEIsRUFBTWUsTUFBT2YsRUFBTWdCLE9BQzdCaEIsRUFBTWlCLGtCQUlkLFVBQVVJLEVBQWFDLEdBQ25CLEdBQUlqSSxLQUFLMkUsU0FDTCxLQUFNLDJDQUVWM0UsS0FBSzJFLFVBQVcsRUFDaEIzRSxLQUFLa0ksV0FBYUYsRUFDbEJoSSxLQUFLbUksV0FBYUYsRUFDbEJqSSxLQUFLb0ksVUFBVyxFQUdwQixVQUNJcEksS0FBSzJFLFVBQVcsRUFDaEIzRSxLQUFLeUUsUUFBVSxFQUNmekUsS0FBSzBFLFFBQVUsRUFDZjFFLEtBQUtxSSxnQkFBZ0IsWUFDckJySSxLQUFLc0ksaUJBQ0R0SSxLQUFLb0ksU0FDTHBJLEtBQUt5RyxNQUFNOEIsT0FBT3ZJLEtBQU1BLEtBQUtxSCxhQUFjckgsS0FBS2lILFNBQVVqSCxLQUFLbUgsV0FFMURuSCxLQUFLOEUsUUFDTjlFLEtBQUt5RyxNQUFNK0IsWUFLdkIsS0FBS1IsRUFBYUMsR0FDVmpJLEtBQUtvSSxXQUNMcEksS0FBS29JLFVBQVcsRUFDaEJwSSxLQUFLeUksYUFBYSxXQUFZLFFBQ3pCekksS0FBSzhFLFFBQ045RSxLQUFLeUcsTUFBTWlDLFlBQVkxSSxLQUFNQSxLQUFLa0ksV0FBWWxJLEtBQUttSSxhQUd0RG5JLEtBQUs4RSxRQUNOOUUsS0FBS3lHLE1BQU1rQyxPQUFPWCxFQUFLQyxHQUUzQmpJLEtBQUt5RSxRQUFVdUQsRUFBTWhJLEtBQUtrSSxXQUMxQmxJLEtBQUswRSxRQUFVdUQsRUFBTWpJLEtBQUttSSxXQUMxQm5JLEtBQUtzSSxpQkFHVCxpQkFDSSxNQUFNTSxFQUFXNUksS0FBS3FHLFFBQ2hCd0MsRUFBWTdJLEtBQUtvRyxTQUNuQndDLEdBQVk1SSxLQUFLOEksV0FDakI5SSxLQUFLbUcsTUFBTUUsTUFBV3VDLEVBQUgsS0FDbkI1SSxLQUFLOEksU0FBV0YsR0FFaEJDLEdBQWE3SSxLQUFLK0ksWUFDbEIvSSxLQUFLbUcsTUFBTUMsT0FBWXlDLEVBQUgsS0FDcEI3SSxLQUFLK0ksVUFBWUYsR0FFckI3SSxLQUFLbUcsTUFBTTZDLFVBQVksYUFBYWhKLEtBQUtpSixFQUFJakosS0FBS3lFLGNBQWN6RSxLQUFLa0osRUFBSWxKLEtBQUswRSxhQUdsRixlQUNJLE9BQU8xRSxLQUFLK0UsVUFHaEIsYUFBYTFCLEdBQ1RyRCxLQUFLK0UsVUFBWTFCLEVBQ2JBLEVBQ0FyRCxLQUFLeUksYUFBYSxXQUFZLFFBRTlCekksS0FBS3FJLGdCQUFnQixZQUk3QixTQUFTMUIsR0FDTCxHQUFrQixVQUFkQSxFQUFNd0MsS0FDTm5KLEtBQUt5RyxNQUFNMkMsc0JBQ1IsR0FBa0IsU0FBZHpDLEVBQU13QyxLQUFpQixDQUU5QixNQUFNRSxFQUFZQyxNQUFNQyxLQUFLdkosS0FBS3lHLE1BQU0rQyxNQUFNMUosU0FBUzJKLFFBQVE5SCxPQUFRWixHQUM1RGYsS0FBS3lHLE1BQU0rQyxNQUFNMUosU0FBU2lCLEdBQU91RyxVQUU1Q29DLFFBQVFDLElBQUkseUJBQ1ozSixLQUFLeUcsTUFBTStDLE1BQU1JLG9CQUFvQlAsR0FBV2pKLFFBQVF5SixJQUNwREgsUUFBUUMsSUFBSUUsTUFLeEIsU0FBU2xELEdBQ0wzRyxLQUFLeUcsTUFBTVAsU0FBU1MsR0FDcEJBLEVBQU1pQixrQkFJZCxNQUFNa0MsVUFBeUIxRixZQUczQixjQUNJQyxRQUdKLG9CQUNJLE1BQU1XLEVBQVNoRixLQUFLaUYsYUFBYSxDQUFDQyxLQUFNLFNBQ3hDRixFQUFPRyxVQUFZLDJ5QkE4Qm5CbkYsS0FBSytKLFFBQVUvRSxFQUFPSyxjQUFjLFlBR3hDLE9BQU8yRSxHQUNDQSxFQUFLckYsVUFDTHFGLEVBQUt2RCxNQUFNd0QsUUFBUUMsYUFBYUYsRUFBSzVFLE9BRXpDNEUsRUFBS3ZELE1BQU13RCxRQUFRRSxVQUFVSCxFQUFLeEYsSUFBS3hFLEtBQUsrSixVQUlwRCxNQUFNSyxVQUFtQmhHLFlBVXJCLGNBQ0lDLFFBRUFyRSxLQUFLcUssU0FBVSxFQUNmckssS0FBS3NLLFdBQVksRUFHckIsb0JBQ0ksTUFBTXRGLEVBQVNoRixLQUFLaUYsYUFBYSxDQUFDQyxLQUFNLFNBQ3hDRixFQUFPRyxVQUFZLG1nQ0F1Q25CbkYsS0FBS29GLE1BQVFKLEVBQU9LLGNBQWMsVUFHdEMsaUJBQ0lyRixLQUFLbUcsTUFBTTZDLFVBQVksYUFBYWhKLEtBQUtpSixRQUFRakosS0FBS2tKLE9BRzFELGFBQ0ksT0FBT2xKLEtBQUtxSyxRQUdoQixXQUFXaEgsR0FDSEEsSUFBVXJELEtBQUtxSyxRQUNmckssS0FBS3lJLGFBQWEsU0FBVSxTQUNwQnBGLEdBQVNyRCxLQUFLcUssU0FDdEJySyxLQUFLcUksZ0JBQWdCLFVBRXpCckksS0FBS3FLLFFBQVVoSCxFQUduQixlQUNJLE9BQU9yRCxLQUFLc0ssVUFHaEIsYUFBYWpILEdBQ0xBLElBQVVyRCxLQUFLc0ssVUFDZnRLLEtBQUt5SSxhQUFhLFdBQVksU0FDdEJwRixHQUFTckQsS0FBS3NLLFdBQ3RCdEssS0FBS3FJLGdCQUFnQixZQUV6QnJJLEtBQUtzSyxVQUFZakgsR0FJbEIsTUFBTSxVQUFjZSxZQWV2QixjQUNJQyxRQUVBckUsS0FBS3VLLFFBQVUsRUFDZnZLLEtBQUt3SyxtQkFBb0IsRUFDekJ4SyxLQUFLeUssWUFBYyxHQUNuQnpLLEtBQUt3SixNQUFRLElBQUkzSixFQUFVLEdBQUksSUFJbkMsb0JBQ2lCRyxLQUFLaUYsYUFBYSxDQUFDQyxLQUFNLFNBQy9CQyxVQUFZLCtUQWV2QixjQUFjOEUsR0FDVixRQUFxQnRKLElBQWpCWCxLQUFLaUssUUFDTCxLQUFNLDRDQUdWakssS0FBS2lLLFFBQVVBLEVBQ2ZqSyxLQUFLaUssUUFBUVMsZUFBZTFLLEtBQUsySyxhQUFhbkYsS0FBS3hGLE9BQ25EQSxLQUFLMkssZUFDTEMsT0FBT0Msc0JBQXNCN0ssS0FBS3VHLE9BQU9mLEtBQUt4RixPQUdsRCxRQUFRd0UsRUFBYXNHLEdBQ2pCLE1BQU1DLEVBQU9ELEVBQU1FLFNBQ25CLElBQUloQixFQWNKLE9BWklBLEVBRFEsY0FBUmUsRUFDc0J0RixTQUFTd0YsY0FBYywyQkFDOUIsYUFBUkYsRUFDZXRGLFNBQVN3RixjQUFjLDBCQUV2QnhGLFNBQVN3RixjQUFjLDBCQUVqRGpMLEtBQUtrTCxZQUFZbEIsR0FDakJBLEVBQUt4RixJQUFNQSxFQUNYd0YsRUFBS3ZELE1BQVF6RyxLQUNiZ0ssRUFBS21CLGdCQUFnQkwsR0FFckI5SyxLQUFLaUssUUFBUW1CLGNBQWM1RyxFQUFLLE1BQU93RixFQUFLbUIsZ0JBQWdCM0YsS0FBS3dFLElBQzFEQSxFQUdYLFdBQVdBLEdBQ1BoSyxLQUFLcUwsWUFBWXJCLEdBR3JCLGNBQWNzQixFQUFpQkMsRUFBZXJLLEdBQzFDLE1BQU1zSyxFQUF5Qi9GLFNBQVN3RixjQUFjLHVCQU10RCxPQUxBTyxFQUFXRixRQUFVQSxFQUNyQkUsRUFBV0QsTUFBUUEsRUFDbkJDLEVBQVd0SyxRQUFVQSxFQUNyQmxCLEtBQUtrTCxZQUFZTSxHQUNqQnhMLEtBQUt5SyxZQUFZeEosS0FBS3VLLEdBQ2ZBLEVBR1gsb0JBQ0l4TCxLQUFLeUssWUFBWXJLLFFBQVFvTCxJQUNyQnhMLEtBQUtxTCxZQUFZRyxLQUVyQnhMLEtBQUt5SyxZQUFjLEdBR3ZCLGVBQ0ksSUFBSWdCLEVBQVF6TCxLQUFLaUssUUFBUWEsUUFDekI5SyxLQUFLeUwsTUFBUSxJQUFJNUwsRUFBVTRMLEVBQU0zTCxTQUFVMkwsRUFBTTFMLE9BSWpELE1BQU0yTCxFQUFzQjFMLEtBQUt3SixNQUFNMUosU0FBU2tCLE9BRWhELElBQUkySyxFQUF1QyxHQUczQzNMLEtBQUt3SixNQUFNMUosU0FBU00sUUFBUSxDQUFDQyxFQUFRVSxLQUNqQzRLLEVBQVd0TCxFQUFPbUUsS0FBT3pELElBSTdCLElBQUk2SyxFQUFpQ3RDLE1BQU1DLEtBQUt2SixLQUFLd0osTUFBTTFKLFNBQVMySixRQUNoRW9DLEVBQThCdkMsTUFBTUMsS0FBS3ZKLEtBQUt3SixNQUFNekosTUFBTTBKLFFBQzFEcUMsRUFBNEIsR0FLaEMsTUFBTWpKLEVBQVcsQ0FBQ2tKLEVBQW9CQyxLQUNsQyxNQUFNaEMsRUFBT2hLLEtBQUt3SixNQUFNMUosU0FBU2tNLEdBRWpDLElBQUssSUFBSXRMLEVBQVEsRUFBR0EsRUFBUXNKLEVBQUsxRixRQUFTNUQsSUFBUyxDQUMvQyxJQUFJdUwsRUFBZWpNLEtBQUt5TCxNQUFNbEksb0JBQW9Cd0ksRUFBWXJMLEdBQzlELFFBQXFCQyxJQUFqQnNMLEVBQTRCLENBRTVCLE1BQU1DLEVBQVVsTSxLQUFLeUwsTUFBTTNMLFNBQVNtTSxHQUU5QkUsRUFBd0JuTSxLQUFLd0osTUFBTXRKLGNBQWM4TCxHQUFZdEwsR0FFbkUsSUFBSTBMLEVBRUosUUFBOEJ6TCxJQUExQndMLEVBQXFDLENBQ3JDLE1BQU1FLEVBQStCck0sS0FBS3dKLE1BQU16SixNQUFNb00sR0FBdUJ2TCxXQUN2RTBMLEVBQWV0TSxLQUFLd0osTUFBTTFKLFNBQVN1TSxHQUNqQkMsRUFBYTlILEtBQ2QwSCxJQUVuQk4sRUFBcUJ2SyxPQUFPdUssRUFBcUJ4SyxRQUFRaUwsR0FBK0IsR0FDeEZSLEVBQWtCeEssT0FBT3dLLEVBQWtCekssUUFBUStLLEdBQXdCLEdBQzNFRyxFQUFhbkIsZ0JBQWdCbkwsS0FBS2lLLFFBQVFzQyxVQUFVdk0sS0FBS3lMLE1BQU0zTCxTQUFTbU0sR0FBZSxRQUV2RkcsRUFBMEJDLEdBS2xDLFFBQWdDMUwsSUFBNUJ5TCxFQUF1QyxDQUd2QyxJQUFLLElBQUlyTCxLQUFTNkssRUFDZCxHQUFJNUwsS0FBS3dKLE1BQU0xSixTQUFTaUIsR0FBT3lELEtBQU8wSCxFQUFTLENBQzNDRSxFQUEwQnJMLEVBQzFCNkssRUFBcUJ2SyxPQUFPdUssRUFBcUJ4SyxRQUFRZ0wsR0FBMEIsR0FDbkZwTSxLQUFLd0osTUFBTTFKLFNBQVNzTSxHQUF5QmpCLGdCQUFnQm5MLEtBQUtpSyxRQUFRc0MsVUFBVXZNLEtBQUt5TCxNQUFNM0wsU0FBU21NLEdBQWUsUUFDdkgsTUFHUixRQUFnQ3RMLElBQTVCeUwsRUFBdUMsQ0FFdkMsTUFBTXRCLEVBQVE5SyxLQUFLaUssUUFBUXNDLFVBQVV2TSxLQUFLeUwsTUFBTTNMLFNBQVNtTSxHQUFlLE9BQ2xFSyxFQUFldE0sS0FBS3dNLFFBQVFOLEVBQVNwQixHQUMzQ3NCLEVBQTBCcE0sS0FBS3dKLE1BQU1sSixVQUFVZ00sR0FDM0NBLEVBQWE5SCxLQUFPeEUsS0FBS3lNLFlBQ3pCek0sS0FBS3VJLE9BQU8rRCxHQUFjLEdBQU8sR0FBTyxHQUN4Q0EsRUFBYTlFLFFBQ2J4SCxLQUFLeU0sZUFBWTlMLEdBR3pCbUwsRUFBa0I3SyxLQUFLLENBQ25CTCxXQUFZd0wsRUFDWnRMLFNBQVVrTCxFQUNWOUssUUFBU1IsSUFHakJtQyxFQUFTb0osRUFBY0csTUFNbkNwTSxLQUFLeUwsTUFBTXhMLGFBQWFHLFFBQVFzTSxJQUM1QixNQUFNbEksRUFBTXhFLEtBQUt5TCxNQUFNM0wsU0FBUzRNLEdBQ2hDLElBQUlDLEVBQ0osR0FBTW5JLEtBQU9tSCxFQU9UZ0IsRUFBaUJoQixFQUFXbkgsR0FFNUJvSCxFQUFxQnZLLE9BQU91SyxFQUFxQnhLLFFBQVF1TCxHQUFpQixPQVRwRCxDQUV0QixNQUFNN0IsRUFBUTlLLEtBQUtpSyxRQUFRc0MsVUFBVXZNLEtBQUt5TCxNQUFNM0wsU0FBUzRNLEdBQWlCLE9BQzFFLElBQUkxQyxFQUFPaEssS0FBS3dNLFFBQVFoSSxFQUFLc0csR0FDN0JkLEVBQUt4RixJQUFNQSxFQUNYbUksRUFBaUIzTSxLQUFLd0osTUFBTWxKLFVBQVUwSixHQU0xQ25ILEVBQVM2SixFQUFnQkMsS0FHN0IsTUFBTUMsRUFBVzVNLEtBQUt3SixNQUFNMUosU0FBU2tCLE9BQVMwSyxHQUM3QkksRUFBa0I5SyxPQUFTLEdBQzNCNEssRUFBcUI1SyxPQUFTLEdBQzlCNkssRUFBa0I3SyxPQUFTLEVBSTVDNEssRUFBcUJ4TCxRQUFRVyxJQUN6QmYsS0FBSzZNLFdBQVc3TSxLQUFLd0osTUFBTTFKLFNBQVNpQixNQUd4Q2YsS0FBS3dKLE1BQU1zRCxZQUFZakIsR0FFdkJDLEVBQWtCMUwsUUFBUUcsSUFDdEJQLEtBQUt3SixNQUFNaEosUUFBUUQsS0FFdkJQLEtBQUt3SixNQUFNdUQsZUFBZW5CLEdBRXRCZ0IsSUFDQWxELFFBQVFDLElBQUkscUJBQXNCM0osS0FBS3dKLE1BQU0xSixVQUM3QzRKLFFBQVFDLElBQUksa0JBQW1CM0osS0FBS3dKLE1BQU16SixPQUMxQzJKLFFBQVFDLElBQUksc0JBQXVCaUMsR0FDbkNsQyxRQUFRQyxJQUFJLG1CQUFvQmtDLEdBRWhDN0wsS0FBS2dOLGdCQUNMaE4sS0FBS2lOLHVCQUliLGdCQUtJLE1BQU1DLEVBQXNCbk0sSUFDeEIsSUFBSWlKLEVBQU9oSyxLQUFLd0osTUFBTTFKLFNBQVNpQixHQUMvQmlKLEVBQUt6RixhQUFlLEdBQ3BCLElBQUssSUFBSTFDLEVBQUksRUFBR0EsRUFBSW1JLEVBQUsxRixRQUFTekMsSUFBSyxDQUNuQyxJQUFJdUUsRUFBUzRELEVBQUttRCxlQUFldEwsR0FDN0IwQixFQUFzQnZELEtBQUt3SixNQUFNakcsb0JBQW9CeEMsRUFBT2MsUUFDcENsQixJQUF4QjRDLElBQ0EySixFQUFtQjNKLEdBQ25CNkMsRUFBU2dILEtBQUtDLElBQUlqSCxFQUFRcEcsS0FBS3dKLE1BQU0xSixTQUFTeUQsR0FBcUI2QyxXQUV2RTRELEVBQUt6RixhQUFhdEQsS0FBS21GLEdBRVAsR0FBaEI0RCxFQUFLMUYsU0FFTDBGLEVBQUt6RixhQUFhdEQsS0FBSytJLEVBQUttRCxlQUFlLEtBSW5ELElBQUssSUFBSXBNLEtBQVNmLEtBQUt3SixNQUFNdkosYUFDekJpTixFQUFtQm5NLEdBSXZCLE1BQU11TSxFQUFzQnZNLElBQ3hCLElBQUlpSixFQUFPaEssS0FBS3dKLE1BQU0xSixTQUFTaUIsR0FDM0JxRixFQUFTNEQsRUFBSzVELFNBRWRuQyxFQUF3QmpFLEtBQUt3SixNQUFNeEYsd0JBQXdCakQsR0FBTyxHQUN0RSxRQUE4QkosSUFBMUJzRCxFQUFxQyxDQUNyQyxJQUNJc0osRUFEbUJ2TixLQUFLd0osTUFBTTFKLFNBQVNtRSxHQUF1Qm1DLFNBQ25DQSxFQUMvQixHQUFJbUgsRUFBUSxFQUVSLElBQUssSUFBSTFMLEVBQUksRUFBR0EsRUFBSW1JLEVBQUsxRixRQUFTekMsSUFDOUJtSSxFQUFLekYsYUFBYTFDLElBQU0wTCxJQU14QyxJQUFLLElBQUl4TSxLQUFTZixLQUFLd0osTUFBTXZKLGFBQ3pCcU4sRUFBbUJ2TSxHQUl2QixNQUFNeU0sRUFBaUIsQ0FBQ3pNLEVBQWVtSSxLQUNuQyxJQUFJYyxFQUFPaEssS0FBS3dKLE1BQU0xSixTQUFTaUIsR0FDL0JpSixFQUFLZCxFQUFJQSxFQUVULElBQUssSUFBSXJILEVBQUksRUFBR0EsRUFBSW1JLEVBQUsxRixRQUFTekMsSUFBSyxDQUNuQyxJQUFJMEIsRUFBc0J2RCxLQUFLd0osTUFBTWpHLG9CQUFvQnhDLEVBQU9jLFFBQ3BDbEIsSUFBeEI0QyxHQUNBaUssRUFBZWpLLEVBQXFCMkYsR0FFeENBLEdBQUtjLEVBQUt6RixhQUFhMUMsS0FJL0IsSUFBSXFILEVBQUksRUFDUixJQUFLLElBQUluSSxLQUFTZixLQUFLd0osTUFBTXZKLGFBQ3pCdU4sRUFBZXpNLEVBQU9tSSxHQUN0QkEsR0FBS2xKLEtBQUt3SixNQUFNMUosU0FBU2lCLEdBQU9xRixTQUVwQyxJQUFJQSxFQUFTOEMsRUFHYixNQUFNdUUsRUFBaUIsQ0FBQzFNLEVBQWVrSSxLQUNuQyxJQUFJZSxFQUFPaEssS0FBS3dKLE1BQU0xSixTQUFTaUIsR0FDL0JpSixFQUFLZixFQUFJQSxFQUVUQSxHQUFLZSxFQUFLM0QsUUFFVixJQUFLLElBQUl4RSxFQUFJLEVBQUdBLEVBQUltSSxFQUFLMUYsUUFBU3pDLElBQUssQ0FDbkMsSUFBSTZMLEVBQVcxTixLQUFLd0osTUFBTWpHLG9CQUFvQnhDLEVBQU9jLFFBQ3BDbEIsSUFBYitNLEdBQ0FELEVBQWVDLEVBQVV6RSxLQUtyQyxJQUFLLElBQUlsSSxLQUFTZixLQUFLd0osTUFBTXZKLGFBQ3pCd04sRUFBZTFNLEdBQVFmLEtBQUt3SixNQUFNMUosU0FBU2lCLEdBQU9zRixTQUl0RCxJQUFJc0gsRUFBWSxFQUNoQjNOLEtBQUt3SixNQUFNMUosU0FBU00sUUFBUTRKLElBQ3BCQSxFQUFLZixFQUFJMEUsSUFDVEEsRUFBWTNELEVBQUtmLEtBR3pCakosS0FBS3dKLE1BQU0xSixTQUFTTSxRQUFRNEosSUFDeEJBLEVBQUtmLEdBQUswRSxJQUVkLElBQUl0SCxHQUFTc0gsRUFDVDNOLEtBQUs4SSxVQUFZekMsSUFDakJyRyxLQUFLbUcsTUFBTUUsTUFBV0EsRUFBSCxLQUNuQnJHLEtBQUs4SSxTQUFXekMsR0FFaEJyRyxLQUFLK0ksV0FBYTNDLElBQ2xCcEcsS0FBS21HLE1BQU1DLE9BQVlBLEVBQUgsS0FDcEJwRyxLQUFLK0ksVUFBWTNDLEdBR3JCLElBQUssSUFBSTVCLEtBQU94RSxLQUFLd0osTUFBTTFKLFNBQVUsQ0FDcEJFLEtBQUt3SixNQUFNMUosU0FBUzBFLEdBQzFCOEQsa0JBSWYsa0JBQ0l0SSxLQUFLd0ssbUJBQW9CLEVBRzdCLHNCQUNJeEssS0FBSzROLG9CQUdMNU4sS0FBS3dKLE1BQU0xSixTQUFTTSxRQUFRLENBQUM0SixFQUFNNkQsS0FDL0IsSUFBSUMsRUFBZSxFQUNuQixJQUFLLElBQUlqTSxFQUFJLEVBQUdBLEVBQUltSSxFQUFLMUYsUUFBU3pDLElBQUssQ0FDbkMsTUFBTWtNLEVBQVkvTixLQUFLd0osTUFBTWpHLG9CQUFvQnNLLEVBQVdoTSxHQUM1RCxJQUFJeUosRUFBVSxVQUNJM0ssSUFBZG9OLElBQ0F6QyxFQUFVdEwsS0FBS3dKLE1BQU0xSixTQUFTaU8sR0FBV3ZKLEtBRTdDLE1BQU0rRyxFQUFRdkIsRUFBS3hGLElBQ2J0RCxFQUFVVyxFQUNWbU0sRUFBS2hPLEtBQUtpTyxjQUFjM0MsRUFBU0MsRUFBT3JLLEdBQzlDOE0sRUFBRy9FLEVBQUllLEVBQUtmLEVBQ1orRSxFQUFHOUUsRUFBSWMsRUFBS2QsRUFBSTRFLEVBQWUsR0FBTTlELEVBQUt6RixhQUFhMUMsR0FDdkRpTSxHQUFnQjlELEVBQUt6RixhQUFhMUMsTUFLMUM3QixLQUFLd0osTUFBTXZKLGFBQWFHLFFBQVF5TixJQUM1QixNQUFNN0QsRUFBT2hLLEtBQUt3SixNQUFNMUosU0FBUytOLEdBQzNCRyxFQUFLaE8sS0FBS2lPLGNBQWNqRSxFQUFLeEYsSUFBSyxLQUFNLE1BQzlDd0osRUFBRy9FLEVBQUllLEVBQUtmLEVBQUllLEVBQUszRCxRQUNyQjJILEVBQUc5RSxFQUFJYyxFQUFLZCxFQUFJLEdBQU1jLEVBQUs1RCxXQUcvQnBHLEtBQUt5SyxZQUFZckssUUFBUTROLElBQ3JCQSxFQUFHMUYsbUJBSVgsT0FBTzRGLEdBQ0NsTyxLQUFLd0ssb0JBQ0x4SyxLQUFLd0ssbUJBQW9CLEVBQ3pCeEssS0FBS2dOLGlCQUdUaE4sS0FBS2lLLFFBQVExRCxPQUFPMkgsR0FDcEJsTyxLQUFLd0osTUFBTTFKLFNBQVNNLFFBQVE0SixJQUN4QkEsRUFBS3pELFdBRVRxRSxPQUFPQyxzQkFBc0I3SyxLQUFLdUcsT0FBT2YsS0FBS3hGLE9BSWxELGVBQWVnSyxFQUFxQjlDLEVBQWtCRSxHQUM3QzRDLEVBQUsxQyxXQUNESixHQUFZRSxFQUVOQSxHQUNQcEgsS0FBS21PLGNBQWNuTyxLQUFLb08sU0FBVXBFLEdBRmxDaEssS0FBS3FPLGNBSVRyRSxFQUFLMUMsVUFBVyxHQUt4QixPQUFPMEMsRUFBcUIxQyxFQUFtQkosRUFBa0JFLEdBQ3pERSxFQUNJRixFQUNBcEgsS0FBS21PLGNBQWNuTyxLQUFLb08sU0FBVXBFLEdBQzNCOUMsRUFDUDhDLEVBQUsxQyxVQUFXLEdBRWhCdEgsS0FBS3FPLGNBQ0xyRSxFQUFLMUMsVUFBVyxJQUdmSixHQUFZRSxHQUNicEgsS0FBS3FPLGNBRVRyRSxFQUFLMUMsVUFBVyxHQUVwQnRILEtBQUtvTyxTQUFXcEUsRUFHcEIsY0FDSWhLLEtBQUt3SixNQUFNMUosU0FBU00sUUFBUTRKLElBQ3hCQSxFQUFLMUMsVUFBVyxJQUl4QixRQUFRL0csR0FDSlAsS0FBS2lLLFFBQVF6SixRQUFRUixLQUFLeUwsTUFBTTNMLFNBQVNTLEVBQUtLLFlBQWFaLEtBQUt5TCxNQUFNM0wsU0FBU1MsRUFBS08sVUFBV1AsRUFBS1csU0FHeEcsa0JBQWtCSCxHQUNkLE1BQU1SLEVBQU9QLEtBQUt5TCxNQUFNMUwsTUFBTWdCLEdBQzlCZixLQUFLaUssUUFBUTlILFdBQVduQyxLQUFLeUwsTUFBTTNMLFNBQVNTLEVBQUtLLFlBQWFaLEtBQUt5TCxNQUFNM0wsU0FBU1MsRUFBS08sVUFBV1AsRUFBS1csU0FHM0csaUJBQ0ksSUFBSW9OLEVBQXlCLEdBQzdCdE8sS0FBS3dKLE1BQU0xSixTQUFTTSxRQUFRNEosSUFDcEJBLEVBQUsxQyxVQUFZZ0gsRUFBYWxOLFFBQVE0SSxFQUFLeEYsS0FBTyxHQUNsRDhKLEVBQWFyTixLQUFLK0ksRUFBS3hGLE9BSy9CLE1BQU02RSxFQUFZQyxNQUFNQyxLQUFLdkosS0FBS3lMLE1BQU0zTCxTQUFTMkosUUFBUTlILE9BQVFaLEdBQ3REdU4sRUFBYWxOLFFBQVFwQixLQUFLeUwsTUFBTTNMLFNBQVNpQixLQUFXLEdBRXpEd04sRUFBTXZPLEtBQUt5TCxNQUFNN0Isb0JBQW9CUCxHQUUzQyxJQUFJbUYsRUFBc0IsR0FDMUJELEVBQUluTyxRQUFRb0QsSUFDUmdMLEVBQVl2TixRQUFRakIsS0FBS3lMLE1BQU0rQyxZQUFZaEwsTUFHL0M4SyxFQUFhbE8sUUFBUW9FLElBQ2pCeEUsS0FBS2lLLFFBQVF3RSxXQUFXakssS0FHNUJnSyxFQUFZcE8sUUFBUUcsSUFDaEJQLEtBQUtRLFFBQVFELEtBR2pCUCxLQUFLaUssUUFBUXlFLFFBSWpCLFlBQVkxRSxFQUFxQmhDLEVBQWFDLEdBQzFDLE1BQU00RixFQUFZN04sS0FBS3dKLE1BQU0xSixTQUFTc0IsUUFBUTRJLEdBQzlDLEdBQUk2RCxFQUFZLEVBQ1osS0FBTSxrQ0FHVixNQUFNeEUsRUFBWUMsTUFBTUMsS0FBS3ZKLEtBQUt3SixNQUFNMUosU0FBUzJKLFFBQVE5SCxPQUFRWixHQUN0RGYsS0FBS3dKLE1BQU0xSixTQUFTaUIsR0FBT3VHLFVBQVl2RyxHQUFTOE0sR0FHM0QsSUFBSWxGLEVBQ0osSUFBSyxNQUFNbkYsS0FBTXhELEtBQUt3SixNQUFNSSxvQkFBb0JQLEdBQzVDLEdBQUk3RixFQUFHMUQsU0FBU3NCLFFBQVF5TSxJQUFjLEVBQUcsQ0FDckNsRixFQUFTbkYsRUFDVCxNQUdSLFFBQWU3QyxJQUFYZ0ksRUFDQSxLQUFNLGtEQUVWM0ksS0FBSzJPLGNBQWdCaEcsRUFFckIzSSxLQUFLMk8sY0FBYzdPLFNBQVNNLFFBQVFDLElBQzVCQSxHQUFVd04sSUFDVjdOLEtBQUt3SixNQUFNMUosU0FBU08sR0FBUXlFLFFBQVMsRUFDckM5RSxLQUFLd0osTUFBTTFKLFNBQVNPLEdBQVFvSCxVQUFVTyxFQUFLQyxNQU12RCxPQUFPRCxFQUFhQyxHQUNoQmpJLEtBQUt3SixNQUFNMUosU0FBU00sUUFBUUMsSUFDcEJBLEVBQU95RSxRQUNQekUsRUFBTzBILEtBQUtDLEVBQUtDLEtBR3pCakksS0FBSzRPLG1CQUFtQjVHLEVBQUtDLEdBR2pDLFlBQ0lqSSxLQUFLd0osTUFBTTFKLFNBQVNNLFFBQVFDLElBQ3BCQSxFQUFPeUUsU0FDUHpFLEVBQU95SCxVQUNQekgsRUFBT3lFLFFBQVMsS0FHeEI5RSxLQUFLNk8sT0FHVCxtQkFBbUI3RyxFQUFhQyxHQUk1QixNQUFNNkcsRUFBV3JKLFNBQVNzSixrQkFBa0IvRyxFQUFLQyxHQUNqRCxJQUFJK0csRUFDSixJQUFLLE1BQU01TSxLQUFLME0sRUFDWixLQUFNMU0sYUFBYStCLEdBQWdCLENBQy9CNkssRUFBVTVNLEVBQ1YsTUFJUixNQUFNNk0sRUFBb0NqUCxLQUFLeUssWUFBYXJKLFFBQVE0TixHQUNwRWhQLEtBQUt5SyxZQUFZckssUUFBUSxDQUFDNE4sRUFBSWpOLEtBQzFCaU4sRUFBR2tCLE9BQVVuTyxHQUFTa08sRUFDdEJqQixFQUFHckosVUFBVyxJQUl0QixPQUNJLElBQUl3SyxFQVNKLEdBUkFuUCxLQUFLeUssWUFBWXJLLFFBQVEsQ0FBQzROLEVBQUlqTixLQUN0QmlOLEVBQUdrQixTQUNIQyxFQUFtQm5CLEdBRXZCQSxFQUFHa0IsUUFBUyxFQUNabEIsRUFBR3JKLFVBQVcsU0FHT2hFLElBQXJCd08sRUFDQSxPQUdKLElBQUlDLEVBQXVCLEdBQzNCcFAsS0FBSzJPLGNBQWM3TyxTQUFTTSxRQUFReU4sSUFDaEMsTUFBTXJKLEVBQU14RSxLQUFLd0osTUFBTTFKLFNBQVMrTixHQUFXckosSUFDdkM0SyxFQUFXaE8sUUFBUW9ELEdBQU8sR0FDMUI0SyxFQUFXbk8sS0FBS3VELEtBSXhCLE1BQU02RSxFQUFZQyxNQUFNQyxLQUFLdkosS0FBS3lMLE1BQU0zTCxTQUFTMkosUUFBUTlILE9BQVFaLEdBQ3REcU8sRUFBV2hPLFFBQVFwQixLQUFLeUwsTUFBTTNMLFNBQVNpQixLQUFXLEdBRXZEd04sRUFBTXZPLEtBQUt5TCxNQUFNN0Isb0JBQW9CUCxHQUUzQyxHQUFrQixHQUFka0YsRUFBSXZOLE9BQ0osS0FBTSwwRUFHVixNQUFNd0MsRUFBSytLLEVBQUksR0FHZixJQUFLLElBQUkzTSxLQUFLNEIsRUFBRzFELFNBQVUsQ0FDdkIsTUFBTTBFLEVBQU14RSxLQUFLeUwsTUFBTTNMLFNBQVM4QixHQUNoQyxHQUFJdU4sRUFBaUI3RCxTQUFXOUcsR0FBTzJLLEVBQWlCNUQsT0FBUy9HLEVBRzdELFlBREFrRixRQUFRQyxJQUFJLHlEQW9DcEIsR0E5QkFuRyxFQUFHYixXQUFXdkMsUUFBUUcsSUFDbEJQLEtBQUtxUCxrQkFBa0I5TyxLQUUzQmlELEVBQUdaLFlBQVl4QyxRQUFRRyxJQUNuQlAsS0FBS3FQLGtCQUFrQjlPLEtBZ0JNLE9BQTdCNE8sRUFBaUI3RCxTQUErQyxPQUEzQjZELEVBQWlCNUQsT0FBK0MsT0FBN0I0RCxFQUFpQmpPLFNBQ3pGbEIsS0FBS2lLLFFBQVE5SCxXQUFXZ04sRUFBaUI3RCxRQUFTNkQsRUFBaUI1RCxNQUFPNEQsRUFBaUJqTyxTQUkvRmxCLEtBQUt5TCxNQUFNK0MsWUFBWWhMLEdBQUlwRCxRQUFRRyxJQUMvQlAsS0FBS1EsUUFBUUQsS0FJZ0IsT0FBN0I0TyxFQUFpQjdELFFBQWtCLENBRW5DLElBQUlnRSxFQUFXOUwsRUFBR2YsV0FDbEIsT0FDUXpDLEtBQUtpSyxRQUFRc0MsVUFBVXZNLEtBQUt5TCxNQUFNM0wsU0FBU3dQLEdBQVcsT0FBT2hMLFFBQVUsSUFEbEUsQ0FLVCxNQUFNaUwsRUFBT3ZQLEtBQUt5TCxNQUFNbEksb0JBQW9CK0wsRUFBVSxHQUN0RCxRQUFhM08sSUFBVDRPLEdBQXNCL0wsRUFBRzFELFNBQVNzQixRQUFRbU8sR0FBUSxFQUFHLENBQ3hDdlAsS0FBS3lMLE1BQU0xTCxNQUFNeUQsRUFBR2IsV0FBVyxJQUM1QzNDLEtBQUtpSyxRQUFRekosUUFBUTJPLEVBQWlCN0QsUUFBU3RMLEtBQUt5TCxNQUFNM0wsU0FBU3dQLEdBQVcsR0FDOUUsTUFFSkEsRUFBV0MsR0FLbkIsR0FBK0IsT0FBM0JKLEVBQWlCNUQsT0FBK0MsT0FBN0I0RCxFQUFpQmpPLFFBQWtCLENBQ3RFLE1BQU1vSyxFQUFVdEwsS0FBS3lMLE1BQU0zTCxTQUFTMEQsRUFBR2YsWUFDdkN6QyxLQUFLaUssUUFBUXpKLFFBQVE4SyxFQUFTNkQsRUFBaUI1RCxNQUFPNEQsRUFBaUJqTyxTQUczRWxCLEtBQUtpSyxRQUFReUUsUUFHakIsY0FBY2MsRUFBc0JDLEdBQ2hDLE1BQU1DLEVBQVMxUCxLQUFLd0osTUFBTTFKLFNBQVNzQixRQUFRb08sR0FDckNHLEVBQVMzUCxLQUFLd0osTUFBTTFKLFNBQVNzQixRQUFRcU8sR0FDM0MvRixRQUFRQyxJQUFJLGlCQUFrQitGLEVBQVFDLEdBQ2xDRCxHQUFVLEdBQUtDLEdBQVUsRUFDekIzUCxLQUFLd0osTUFBTW9HLGdCQUFnQkYsRUFBUUMsR0FBUXZQLFFBQVF5TixJQUMvQzdOLEtBQUt3SixNQUFNMUosU0FBUytOLEdBQVd2RyxVQUFXLEtBSzlDa0ksRUFBTWxJLFVBQVcsRUFDakJtSSxFQUFNbkksVUFBVyxHQUl6QixRQUFRaUYsR0FDSixNQUFNL0gsRUFBTXhFLEtBQUtpSyxRQUFRNEYsUUFBUXRELEdBQ2pDLFFBQVk1TCxJQUFSNkQsRUFFQSxZQURBa0YsUUFBUUMsSUFBSSxxQkFLaEIsSUFBSW1HLEdBQW1CLEVBSXZCLFFBSHNCblAsSUFBbEJYLEtBQUtvTyxXQUNMMEIsRUFBa0I5UCxLQUFLeUwsTUFBTTNMLFNBQVNzQixRQUFRcEIsS0FBS29PLFNBQVM1SixNQUU1RHNMLEdBQW1CLEVBQUcsQ0FDdEIsTUFBTUMsRUFBZ0IvUCxLQUFLeUwsTUFBTXRMLGdCQUFnQjJQLEdBQzNDRSxFQUFhRCxFQUFjbFAsSUFBSXVDLElBQzFCLENBQ0hrSSxRQUFTOUcsRUFDVCtHLE1BQU92TCxLQUFLeUwsTUFBTTNMLFNBQVNFLEtBQUt5TCxNQUFNMUwsTUFBTXFELEdBQVd0QyxVQUN2REksUUFBU2xCLEtBQUt5TCxNQUFNMUwsTUFBTXFELEdBQVdsQyxXQUc3QzhPLEVBQVcvTyxLQUFLLENBQ1pxSyxRQUFTdEwsS0FBS3lMLE1BQU0zTCxTQUFTZ1EsR0FDN0J2RSxNQUFPL0csRUFDUHRELFFBQVMsSUFHYjZPLEVBQWMzUCxRQUFRZ0QsSUFDbEJwRCxLQUFLcVAsa0JBQWtCak0sS0FFM0I0TSxFQUFXNVAsUUFBUUcsSUFDZlAsS0FBS2lLLFFBQVF6SixRQUFRRCxFQUFLK0ssUUFBUy9LLEVBQUtnTCxNQUFPaEwsRUFBS1csV0FJNURsQixLQUFLeU0sVUFBWWpJLEVBQ2pCeEUsS0FBS2lLLFFBQVF5RSxRQUdqQixlQUFldUIsR0FDWCxNQUFNQyxFQUFXLElBQUlDLFlBQVksU0FBVSxDQUFDRixPQUFRQSxJQUNwRGpRLEtBQUt3SixNQUFNMUosU0FBU00sUUFBUTRKLElBQ3BCQSxFQUFLMUMsVUFDTDBDLEVBQUtvRyxjQUFjRixLQUsvQixTQUFTdkosR0FDTDNHLEtBQUtxUSxlQUFlLENBQUNDLFFBQVMsRUFBR0MsZ0JBQWdDLEtBQWhCNUosRUFBTTZKLFVBSS9EQyxlQUFlQyxPQUFPLHlCQUEwQnZNLEdBQ2hEc00sZUFBZUMsT0FBTyw0QkFBNkI1RyxHQUNuRDJHLGVBQWVDLE9BQU8saUJBQWtCLEdBQ3hDRCxlQUFlQyxPQUFPLHNCQUF1QnRHLEdDdnFDdEMsTUFBTXVHLFVBQWtCdk0sWUFlM0IsY0FDSUMsUUFHSixvQkFDSSxNQUFNVyxFQUFTaEYsS0FBS2lGLGFBQWEsQ0FBQ0MsS0FBTSxTQUN4Q0YsRUFBT0csVUFBWSw2bEJBdUJuQm5GLEtBQUtvRixNQUFRSixFQUFPSyxjQUFjLFVBQ2xDckYsS0FBSzRRLE1BQVE1TCxFQUFPSyxjQUFjLFVBQ2xDckYsS0FBSzRRLE1BQU10TCxpQkFBaUIsWUFBYXRGLEtBQUt1RixVQUFVQyxLQUFLeEYsT0FDN0R5RixTQUFTSCxpQkFBaUIsVUFBV3RGLEtBQUswRixRQUFRRixLQUFLeEYsT0FDdkR5RixTQUFTSCxpQkFBaUIsWUFBYXRGLEtBQUsyRixVQUFVSCxLQUFLeEYsT0FDM0RBLEtBQUs0USxNQUFNdEwsaUJBQWlCLGFBQWN0RixLQUFLNEYsV0FBV0osS0FBS3hGLE1BQU8sQ0FBRTZGLFNBQVMsSUFDakZKLFNBQVNILGlCQUFpQixXQUFZdEYsS0FBSzhGLFNBQVNOLEtBQUt4RixPQUN6RHlGLFNBQVNILGlCQUFpQixZQUFhdEYsS0FBSytGLFVBQVVQLEtBQUt4RixPQUUzREEsS0FBSzZRLGVBQWlCLElBQUlDLGVBQWVDLElBQ3JDL1EsS0FBS2dSLHdCQUVUaFIsS0FBSzZRLGVBQWVJLFFBQVFqUixLQUFLNFEsT0FDakM1USxLQUFLNlEsZUFBZUksUUFBUWpSLEtBQUtvRixPQUVqQ3BGLEtBQUt5RSxRQUFVLEVBQ2Z6RSxLQUFLMEUsUUFBVSxFQUduQixzQkFDSSxJQUFJd00sRUFBUyxHQUFNOUQsS0FBS0MsSUFBSSxFQUFHck4sS0FBS29GLE1BQU0rTCxZQUFjblIsS0FBSzRRLE1BQU1RLGFBQy9EQyxFQUFTLEdBQU1qRSxLQUFLQyxJQUFJLEVBQUdyTixLQUFLb0YsTUFBTTBJLGFBQWU5TixLQUFLNFEsTUFBTVUsY0FDaEVsRSxLQUFLbUUsSUFBSXZSLEtBQUt5RSxTQUFXeU0sSUFDekJsUixLQUFLeUUsUUFBVXlNLEVBQVM5RCxLQUFLb0UsS0FBS3hSLEtBQUt5RSxVQUV2QzJJLEtBQUttRSxJQUFJdlIsS0FBSzBFLFNBQVcyTSxJQUN6QnJSLEtBQUswRSxRQUFVMk0sRUFBU2pFLEtBQUtvRSxLQUFLeFIsS0FBSzBFLFVBRTNDMUUsS0FBS29GLE1BQU1lLE1BQU02QyxVQUFZLGFBQWFoSixLQUFLeUUsY0FBY3pFLEtBQUswRSxhQUd0RSxXQUFXaUMsR0FDUCxJQUFLLElBQUk5RSxFQUFJLEVBQUdBLEVBQUk4RSxFQUFNQyxlQUFlNUYsT0FBUWEsSUFBSyxDQUNsRCxJQUFJZ0YsRUFBUUYsRUFBTUMsZUFBZUUsS0FBS2pGLEdBQ2xDZ0YsRUFBTTlDLFFBQVUvRCxLQUFLNFEsT0FBUy9KLEVBQU05QyxRQUFVL0QsS0FBS29GLFFBSWxEcEYsS0FBSzJFLFdBQ04zRSxLQUFLNkUsV0FBWSxFQUNqQjdFLEtBQUsrRyxRQUFVRixFQUFNRyxXQUNyQmhILEtBQUt5SCxVQUFVWixFQUFNYSxNQUFPYixFQUFNYyxPQUNsQ2hCLEVBQU1pQixvQkFLbEIsVUFBVWpCLEdBQ0ZBLEVBQU01QyxRQUFVL0QsS0FBSzRRLE9BQVNqSyxFQUFNNUMsUUFBVS9ELEtBQUtvRixRQUlsRHBGLEtBQUsyRSxVQUE2QixFQUFoQmdDLEVBQU1rQixVQUN6QjdILEtBQUs0RSxXQUFZLEVBQ2pCNUUsS0FBS3lILFVBQVVkLEVBQU1lLE1BQU9mLEVBQU1nQixPQUNsQ2hCLEVBQU1pQixrQkFJZCxTQUFTakIsR0FDTCxJQUFLLElBQUk5RSxFQUFJLEVBQUdBLEVBQUk4RSxFQUFNQyxlQUFlNUYsT0FBUWEsSUFBSyxDQUNsRCxJQUFJZ0YsRUFBUUYsRUFBTUMsZUFBZUUsS0FBS2pGLEdBQ2xDN0IsS0FBSzJFLFVBQVkzRSxLQUFLNkUsV0FBYTdFLEtBQUsrRyxTQUFXRixFQUFNRyxhQUN6RGhILEtBQUs2RSxXQUFZLEVBQ2pCN0UsS0FBSzhILFlBS2pCLFFBQVFuQixJQUNBM0csS0FBSzJFLFdBQVkzRSxLQUFLNEUsV0FBK0IsRUFBaEIrQixFQUFNa0IsVUFDM0M3SCxLQUFLNEUsV0FBWSxFQUNqQjVFLEtBQUs4SCxVQUNMbkIsRUFBTWlCLGtCQUlkLFVBQVVqQixHQUNOLElBQUssSUFBSTlFLEVBQUksRUFBR0EsRUFBSThFLEVBQU1DLGVBQWU1RixPQUFRYSxJQUFLLENBQ2xELElBQUlnRixFQUFRRixFQUFNQyxlQUFlRSxLQUFLakYsR0FDbEM3QixLQUFLMkUsVUFBWTNFLEtBQUs2RSxXQUFhN0UsS0FBSytHLFNBQVdGLEVBQU1HLFlBQ3pEaEgsS0FBSytILEtBQUtsQixFQUFNYSxNQUFPYixFQUFNYyxRQUt6QyxVQUFVaEIsR0FDRjNHLEtBQUsyRSxVQUFZM0UsS0FBSzRFLFlBQ3RCNUUsS0FBSytILEtBQUtwQixFQUFNZSxNQUFPZixFQUFNZ0IsT0FDN0JoQixFQUFNaUIsa0JBSWQsVUFBVUksRUFBYUMsR0FDbkJqSSxLQUFLMkUsVUFBVyxFQUNoQjNFLEtBQUtrSSxXQUFhRixFQUNsQmhJLEtBQUttSSxXQUFhRixFQUNsQmpJLEtBQUt5UixpQkFBbUJ6UixLQUFLeUUsUUFDN0J6RSxLQUFLMFIsaUJBQW1CMVIsS0FBSzBFLFFBR2pDLFVBQ0kxRSxLQUFLMkUsVUFBVyxFQUdwQixLQUFLcUQsRUFBYUMsR0FDZGpJLEtBQUt5RSxRQUFVekUsS0FBS3lSLGlCQUFtQnpKLEVBQU1oSSxLQUFLa0ksV0FDbERsSSxLQUFLMEUsUUFBVTFFLEtBQUswUixpQkFBbUJ6SixFQUFNakksS0FBS21JLFdBQ2xEbkksS0FBS2dSLHVCQUliUCxlQUFlQyxPQUFPLHFCQUFzQkMsR0N6RTVDRixlQUFlQyxPQUFPLDBCQWpGdEIsY0FBNkJ2TSxFQUt6QixjQUNJRSxRQUNBckUsS0FBS3NFLFFBQVUsRUFDZnRFLEtBQUsyUix3QkFBeUIsRUFHbEMsb0JBQ0l0TixNQUFNdU4sb0JBRU41UixLQUFLbUYsVUFBWSxtZEFXakJuRixLQUFLc0csUUFBVXRHLEtBQUtxRixjQUFjLFlBQ2xDckYsS0FBSzZSLGdCQUFrQjdSLEtBQUtxRixjQUFjLG9CQUMxQ3JGLEtBQUs4UixTQUFXOVIsS0FBS3FGLGNBQWMsVUFDbkNyRixLQUFLNlIsZ0JBQWdCdk0saUJBQWlCLFFBQVN0RixLQUFLK1IsdUJBQXVCdk0sS0FBS3hGLE9BRWhGQSxLQUFLc0YsaUJBQWlCLFNBQVV0RixLQUFLZ1MsU0FBU3hNLEtBQUt4RixPQUd2RCxnQkFBZ0J3RyxHQUNabkMsTUFBTThHLGdCQUFnQjNFLEdBQ2xCLGNBQWVBLElBQ2Z4RyxLQUFLMlIsd0JBQXlCLEVBQzlCM1IsS0FBSzZSLGdCQUFnQnhPLE1BQVFtRCxFQUFLeUwsVUFDbENqUyxLQUFLMlIsd0JBQXlCLEdBRzlCLFNBQVVuTCxJQUNWeEcsS0FBSzhSLFNBQVNJLFlBQWMxTCxFQUFLMkwsTUFJekMseUJBQ0ksR0FBSW5TLEtBQUsyUix1QkFDTCxPQUVKLE1BQU1TLEVBQWVDLFdBQVdyUyxLQUFLNlIsZ0JBQWdCeE8sT0FDckQsSUFBSXlILEVBQVE5SyxLQUFLeUcsTUFBTXdELFFBQVFzQyxVQUFVdk0sS0FBS3dFLElBQUssU0FDbkRzRyxFQUFNbUgsVUFBWUcsRUFDbEJwUyxLQUFLeUcsTUFBTXdELFFBQVFxSSxhQUFhdFMsS0FBS3dFLElBQUtzRyxHQUc5QyxTQUFTbkUsR0FDTCxNQUFNc0osRUFBNEJ0SixFQUFNc0osT0FDeENqUSxLQUFLNlIsZ0JBQWdCeE8sT0FBU2dQLFdBQVdyUyxLQUFLNlIsZ0JBQWdCeE8sT0FBUzRNLEVBQU9NLGdCQUFnQmdDLFdBQzlGdlMsS0FBSytSLDRCQXVCYnRCLGVBQWVDLE9BQU8seUJBbkJ0QixjQUE0QnZNLEVBQ3hCLGNBQ0lFLFFBQ0FyRSxLQUFLc0UsUUFBVSxFQUduQixvQkFDSUQsTUFBTXVOLG9CQUVONVIsS0FBS21GLFVBQVkseVBBS2pCbkYsS0FBS3NHLFFBQVV0RyxLQUFLcUYsY0FBYyxlQzVFbkMsTUFBTW1OLFVBQWdCcE8sWUFRekIsb0JBQ0ksTUFBTVksRUFBU2hGLEtBQUtpRixhQUFhLENBQUNDLEtBQU0sU0FDeENGLEVBQU9HLFVBQVksc2ZBcUJuQm5GLEtBQUt5UyxjQUFnQnpOLEVBQU9LLGNBQWMsYUFDMUNyRixLQUFLMFMsS0FBTzFOLEVBQU9LLGNBQWMsU0FDakNJLFNBQVNILGlCQUFpQixXQUFZdEYsS0FBSzJTLFdBQVduTixLQUFLeEYsT0FDM0RBLEtBQUt5UyxjQUFjbk4saUJBQWlCLFVBQVd0RixLQUFLNFMsa0JBQWtCcE4sS0FBS3hGLE9BQzNFQSxLQUFLeVMsY0FBY25OLGlCQUFpQixRQUFTdEYsS0FBSzZTLGVBQWVyTixLQUFLeEYsT0FHMUUsWUFBWXlHLEdBQ1IsUUFBbUI5RixJQUFmWCxLQUFLeUcsTUFDTCxLQUFNLDBDQUdWekcsS0FBS3lHLE1BQVFBLEVBQ2J6RyxLQUFLaUssUUFBVXhELEVBQU13RCxRQUNyQmpLLEtBQUtpSyxRQUFRNkksaUJBQWlCOVMsS0FBSytTLGVBQWV2TixLQUFLeEYsT0FDdkRBLEtBQUsrUyxpQkFHVCxnQkFDSSxNQUFNQyxFQUFhaFQsS0FBS3lTLGNBQWNwUCxNQUV0QyxJQUFJNFAsRUFDSixHQUFrQixJQUFkRCxFQUNBQyxFQUFrQmpULEtBQUtrVCxRQUN2QmxULEtBQUttVCxlQUFZeFMsTUFDZCxDQUNIc1MsRUFBa0IsR0FDbEIsSUFBSyxNQUFNRyxLQUFLcFQsS0FBS2tULFFBQVMsQ0FDMUIsTUFBTXBNLEVBQU85RyxLQUFLa1QsUUFBUUUsR0FDdEIsU0FBVXRNLEdBQVFBLEVBQUtxTCxLQUFLa0IsV0FBV0wsS0FDdkNDLEVBQWdCRyxHQUFLdE0sR0FHN0I5RyxLQUFLbVQsVUFBWUcsT0FBTzdKLEtBQUt3SixHQUFpQixHQUdsRCxNQUFNTSxFQUFLOU4sU0FBU3dGLGNBQWMsTUFDbENqTCxLQUFLMFMsS0FBS3ZOLFVBQVksR0FDdEJuRixLQUFLMFMsS0FBS3hILFlBQVlxSSxHQUN0QixJQUFLLE1BQU16TSxLQUFRbU0sRUFBaUIsQ0FDaEMsTUFBTU8sRUFBSy9OLFNBQVN3RixjQUFjLE1BQ2xDdUksRUFBR3RCLFlBQWNlLEVBQWdCbk0sR0FBTXFMLEtBQ3ZDcUIsRUFBR2xPLGlCQUFpQixRQUFTcUIsSUFDekIzRyxLQUFLeVQsdUJBQXVCM00sR0FDNUI5RyxLQUFLMFQsU0FFVEgsRUFBR3JJLFlBQVlzSSxJQUl2QixpQkFDSXhULEtBQUtrVCxRQUFVbFQsS0FBS2lLLFFBQVFpSixVQUM1QmxULEtBQUsyVCxnQkFHVCx1QkFBdUI3TSxRQUNBbkcsSUFBZlgsS0FBS3lHLE9BQ0x6RyxLQUFLeUcsTUFBTW9KLFFBQVE3UCxLQUFLa1QsUUFBUXBNLElBSXhDLFdBQVdILEdBQ1csYUFBZEEsRUFBTXdDLE1BQXVCeEMsRUFBTVMsVUFBWVQsRUFBTTVDLFFBQVUvRCxPQUMvREEsS0FBS3lTLGNBQWNqTCxRQUNuQmIsRUFBTWlCLGtCQUlkLGVBQWVqQixHQUNYM0csS0FBSzJULGdCQUdULE9BQ0kzVCxLQUFLeVMsY0FBY3BQLE1BQVEsR0FDM0JyRCxLQUFLMlQsZ0JBQ0wzVCxLQUFLNFQsT0FHVCxrQkFBa0JqTixHQUNJLFNBQWRBLEVBQU13QyxXQUNpQnhJLElBQW5CWCxLQUFLbVQsV0FDTG5ULEtBQUt5VCx1QkFBdUJ6VCxLQUFLbVQsV0FFckNuVCxLQUFLMFQsUUFDZSxVQUFiL00sRUFBTWtOLEtBQ2I3VCxLQUFLMFQsUUFLakJqRCxlQUFlQyxPQUFPLG1CQUFvQjhCLEdDNUhuQyxNQUFNc0IsVUFBZTFQLFlBSXhCLGNBQ0lDLFFBQ0FyRSxLQUFLK1QsU0FBVSxFQUduQixvQkFDSSxNQUFNL08sRUFBU2hGLEtBQUtpRixhQUFhLENBQUNDLEtBQU0sU0FDeENGLEVBQU9HLFVBQVksNDNDQWtEbkJuRixLQUFLZ1UsT0FBU2hQLEVBQU9LLGNBQWMsV0FDbkNyRixLQUFLZ1UsT0FBTzFPLGlCQUFpQixRQUFTdEYsS0FBS2lVLFFBQVF6TyxLQUFLeEYsT0FFeERBLEtBQUsrVCxRQUFVL1QsS0FBS2tVLGFBQWEsVUFFakM1SyxNQUFNQyxLQUFLdkosS0FBS21VLFVBQVUvVCxRQUFRZ1UsSUFDOUJBLEVBQU05TyxpQkFBaUIsUUFBU3RGLEtBQUtxVSxnQkFBZ0I3TyxLQUFLeEYsT0FDMURvVSxFQUFNOU8saUJBQWlCLE9BQVF0RixLQUFLcVUsZ0JBQWdCN08sS0FBS3hGLFNBSWpFLFFBQVEyRyxHQUNKM0csS0FBS3NVLFFBQVV0VSxLQUFLc1UsT0FHeEIsYUFDSSxPQUFPdFUsS0FBSytULFFBR2hCLFdBQVcxUSxHQUNIQSxJQUFVckQsS0FBSytULFFBQ2YvVCxLQUFLeUksYUFBYSxTQUFVLFNBQ3BCcEYsR0FBU3JELEtBQUsrVCxTQUN0Qi9ULEtBQUtxSSxnQkFBZ0IsVUFFekJySSxLQUFLK1QsUUFBVTFRLEVBR25CLGdCQUFnQnNELEdBQ1osTUFBTWEsRUFBUThCLE1BQU1DLEtBQUt2SixLQUFLbVUsVUFBVTdSLE9BQU8sQ0FBQ2lTLEVBQUtILElBQVdHLEdBQU9ILEdBQVMzTyxTQUFTK08sZUFBZ0IsR0FDekd4VSxLQUFLc1UsUUFBVTlNLEdBSXZCaUosZUFBZUMsT0FBTyxrQkFBbUJvRCxHQy9GbEMsTUFBTVcsVUFBbUJyUSxZQUs1QixjQUNJQyxRQUNBckUsS0FBSzBVLFdBQWEsR0FDbEIxVSxLQUFLMlUsY0FBZ0IsR0FHekIsb0JBQ0kzVSxLQUFLZ0YsT0FBU2hGLEtBQUtpRixhQUFhLENBQUNDLEtBQU0sU0FDdkNsRixLQUFLZ0YsT0FBT2tOLFlBQWMsV0FDMUJ0SCxPQUFPQyxzQkFBc0I3SyxLQUFLNFUsUUFBUXBQLEtBQUt4RixPQUduRCxRQUFRNlUsR0FDSjdVLEtBQUswVSxXQUFXelQsS0FBSzRULEdBQ2pCN1UsS0FBSzBVLFdBQVcxVCxPQUFTaEIsS0FBSzJVLGdCQUM5QjNVLEtBQUswVSxXQUFhMVUsS0FBSzBVLFdBQVczUyxPQUFPL0IsS0FBSzJVLGdCQUVsRCxNQUFNRyxFQUFTOVUsS0FBSzBVLFdBQVcsR0FDekJLLEVBQVUvVSxLQUFLMFUsV0FBVzFULE9BQVMsRUFDekMsR0FBSStULEVBQVUsRUFBRyxDQUNiLE1BQU1DLEVBQU01SCxLQUFLNkgsTUFBTUYsR0FBVyxNQUFTRixFQUFZQyxLQUN2RDlVLEtBQUtnRixPQUFPa04sWUFBYyxRQUFROEMsRUFFdENwSyxPQUFPQyxzQkFBc0I3SyxLQUFLNFUsUUFBUXBQLEtBQUt4RixRQUl2RHlRLGVBQWVDLE9BQU8sdUJBQXdCK0QiLCJmaWxlIjoiMi5ib290c3RyYXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIEVkZ2Uge1xuICAgIGZyb21WZXJ0ZXg6IG51bWJlcjtcbiAgICB0b0lucHV0OiBudW1iZXI7XG4gICAgdG9WZXJ0ZXg6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25uZWN0ZWRDb21wb25lbnQge1xuICAgIHZlcnRpY2VzOiBudW1iZXJbXTtcbiAgICByb290VmVydGV4OiBudW1iZXI7XG4gICAgaW50ZXJuYWxFZGdlczogbnVtYmVyW107XG4gICAgaW5wdXRFZGdlczogbnVtYmVyW107XG4gICAgb3V0cHV0RWRnZXM6IG51bWJlcltdO1xufVxuXG5leHBvcnQgY2xhc3MgR3JhcGhEYXRhPFQ+IHtcbiAgICB2ZXJ0aWNlczogVFtdOyAvLyBBcnJheSBvZiBncmFwaCB2ZXJ0aWNlcyAocGFzc2VkIGludG8gY29uc3RydWN0b3IpXG4gICAgZWRnZXM6IEVkZ2VbXTsgLy8gQXJyYXkgb2YgZWRnZXMgKHBhc3NlZCBpbnRvIGNvbnN0cnVjdG9yKVxuICAgIHJvb3RWZXJ0aWNlczogbnVtYmVyW107IC8vIFdoaWNoIHZlcnRleCBpbmRpY2VzIGhhdmUgbm8gb3V0Z29pbmcgZWRnZXNcbiAgICB1cHN0cmVhbUVkZ2VzOiBudW1iZXJbXVtdOyAvLyBQYXJhbGxlbCB0byB2ZXJ0aWNlcy4gU2Vjb25kIGluZGV4IGlzIHdoaWNoIGlucHV0LCBhbmQgdGhlIHJlc3VsdCBpcyB0aGUgdXBzdHJlYW0gZWRnZSBpbmRleC5cbiAgICBkb3duc3RyZWFtRWRnZXM6IG51bWJlcltdW107IC8vIFBhcmFsbGVsIHRvIHZlcnRpY2VzLiBFYWNoIGVudHJ5IGlzIHVuc29ydGVkIGxpc3Qgb2YgZG93bnN0cmVhbSBlZGdlIGluZGljZXMuXG5cbiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlczogVFtdLCBlZGdlczogRWRnZVtdKSB7XG4gICAgICAgIHRoaXMudmVydGljZXMgPSBbXTtcbiAgICAgICAgdGhpcy5lZGdlcyA9IFtdO1xuICAgICAgICB0aGlzLnJvb3RWZXJ0aWNlcyA9IFtdO1xuICAgICAgICB0aGlzLnVwc3RyZWFtRWRnZXMgPSBbXTtcbiAgICAgICAgdGhpcy5kb3duc3RyZWFtRWRnZXMgPSBbXTtcblxuICAgICAgICB2ZXJ0aWNlcy5mb3JFYWNoKHZlcnRleCA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZFZlcnRleCh2ZXJ0ZXgpO1xuICAgICAgICB9KTtcbiAgICAgICAgZWRnZXMuZm9yRWFjaChlZGdlID0+IHtcbiAgICAgICAgICAgIHRoaXMuYWRkRWRnZShlZGdlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdXBzdHJlYW1WZXJ0ZXhJbmRleCh2ZXJ0ZXhJbmRleDogbnVtYmVyLCBpbnB1dDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgZWRnZSA9IHRoaXMudXBzdHJlYW1FZGdlc1t2ZXJ0ZXhJbmRleF1baW5wdXRdO1xuICAgICAgICBpZiAoZWRnZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRnZXNbZWRnZV0uZnJvbVZlcnRleDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvd25zdHJlYW1WZXJ0ZXhJbmRpY2VzKHZlcnRleEluZGV4OiBudW1iZXIpOiBudW1iZXJbXSB7XG4gICAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy5kb3duc3RyZWFtRWRnZXNbdmVydGV4SW5kZXhdO1xuICAgICAgICByZXR1cm4gZWRnZXMubWFwKGVkZ2UgPT4gdGhpcy5lZGdlc1tlZGdlXS50b1ZlcnRleCk7XG4gICAgfVxuXG4gICAgYWRkVmVydGV4KHZlcnRleDogVCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMudmVydGljZXMubGVuZ3RoO1xuICAgICAgICB0aGlzLnZlcnRpY2VzLnB1c2godmVydGV4KTtcbiAgICAgICAgdGhpcy51cHN0cmVhbUVkZ2VzLnB1c2goW10pO1xuICAgICAgICB0aGlzLmRvd25zdHJlYW1FZGdlcy5wdXNoKFtdKTtcbiAgICAgICAgdGhpcy5yb290VmVydGljZXMucHVzaChpbmRleCk7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG5cbiAgICBhZGRFZGdlKGVkZ2U6IEVkZ2UpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmVkZ2VzLmxlbmd0aDtcbiAgICAgICAgdGhpcy5lZGdlcy5wdXNoKGVkZ2UpO1xuXG4gICAgICAgIGlmICh0aGlzLnVwc3RyZWFtRWRnZXNbZWRnZS50b1ZlcnRleF1bZWRnZS50b0lucHV0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBgVmVydGV4ICR7ZWRnZS50b1ZlcnRleH0gaW5wdXQgJHtlZGdlLnRvSW5wdXR9IGhhcyBtdWx0aXBsZSB1cHN0cmVhbSB2ZXJ0aWNlc2A7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cHN0cmVhbUVkZ2VzW2VkZ2UudG9WZXJ0ZXhdW2VkZ2UudG9JbnB1dF0gPSBpbmRleDtcbiAgICAgICAgdGhpcy5kb3duc3RyZWFtRWRnZXNbZWRnZS5mcm9tVmVydGV4XS5wdXNoKGluZGV4KTtcblxuICAgICAgICBsZXQgaXggPSB0aGlzLnJvb3RWZXJ0aWNlcy5pbmRleE9mKGVkZ2UuZnJvbVZlcnRleCk7XG4gICAgICAgIGlmIChpeCA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJvb3RWZXJ0aWNlcy5zcGxpY2UoaXgsIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVtb3ZlVmVydGljZXMoaW5kaWNlczogbnVtYmVyW10pIHtcbiAgICAgICAgLy8gTm90ZTogdGhpcyBmdW5jdGlvbiBkb2VzIG5vdCByZW1vdmUgZWRnZXMsXG4gICAgICAgIC8vIGJ1dCB3aWxsIHNldCB0aGVpciB0by9mcm9tIHRvIHVuZGVmaW5lZC5cblxuICAgICAgICAvLyBDb21wdXRlIGEgbWFwcGluZyBvZiBvbGQgdmVydGV4IGluZGljZXMgLT4gbmV3IHZlcnRleCBpbmRpY2VzLCBwb3N0LWRlbGV0aW9uXG4gICAgICAgIGxldCBtYXBwaW5nOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICBsZXQgbmV3SW5kZXggPSAwO1xuICAgICAgICB0aGlzLnZlcnRpY2VzLmZvckVhY2goKF8sIG9sZEluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoaW5kaWNlcy5pbmRleE9mKG9sZEluZGV4KSA8IDApIHtcbiAgICAgICAgICAgICAgICAvLyBJbmRleCB3YXMgbm90IGRlbGV0ZWRcbiAgICAgICAgICAgICAgICBtYXBwaW5nW29sZEluZGV4XSA9IG5ld0luZGV4O1xuICAgICAgICAgICAgICAgIG5ld0luZGV4Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFBlcmZvcm0gZGVsZXRpb25cbiAgICAgICAgdGhpcy52ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMuZmlsdGVyKChfLCBpbmRleCkgPT4gaW5kaWNlcy5pbmRleE9mKGluZGV4KSA8IDApO1xuICAgICAgICB0aGlzLnJvb3RWZXJ0aWNlcyA9IHRoaXMucm9vdFZlcnRpY2VzLmZpbHRlcih2ID0+IGluZGljZXMuaW5kZXhPZih2KSA8IDApO1xuICAgICAgICB0aGlzLnVwc3RyZWFtRWRnZXMgPSB0aGlzLnVwc3RyZWFtRWRnZXMuZmlsdGVyKChfLCBpbmRleCkgPT4gaW5kaWNlcy5pbmRleE9mKGluZGV4KSA8IDApO1xuICAgICAgICB0aGlzLmRvd25zdHJlYW1FZGdlcyA9IHRoaXMuZG93bnN0cmVhbUVkZ2VzLmZpbHRlcigoXywgaW5kZXgpID0+IGluZGljZXMuaW5kZXhPZihpbmRleCkgPCAwKTtcblxuICAgICAgICAvLyBSZW1hcCBpbmRpY2VzXG4gICAgICAgIHRoaXMuZWRnZXMuZm9yRWFjaChlZGdlID0+IHtcbiAgICAgICAgICAgIGVkZ2UuZnJvbVZlcnRleCA9IG1hcHBpbmdbZWRnZS5mcm9tVmVydGV4XTtcbiAgICAgICAgICAgIGVkZ2UudG9WZXJ0ZXggPSBtYXBwaW5nW2VkZ2UudG9WZXJ0ZXhdO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yb290VmVydGljZXMuZm9yRWFjaCgodiwgaSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yb290VmVydGljZXNbaV0gPSBtYXBwaW5nW3ZdO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW1vdmVFZGdlcyhpbmRpY2VzOiBudW1iZXJbXSkge1xuICAgICAgICBsZXQgaW5kaWNlc19zb3J0ZWQgPSBpbmRpY2VzLnNsaWNlKCk7XG4gICAgICAgIGluZGljZXNfc29ydGVkLnNvcnQoKGEsIGIpID0+IGIgLSBhKTtcbiAgICAgICAgaW5kaWNlc19zb3J0ZWQuZm9yRWFjaChpbmRleCA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUVkZ2UoaW5kZXgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW1vdmVFZGdlKGluZGV4OiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgZWRnZSA9IHRoaXMuZWRnZXNbaW5kZXhdO1xuICAgICAgICB0aGlzLmVkZ2VzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgaWYgKGVkZ2UudG9WZXJ0ZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMudXBzdHJlYW1FZGdlc1tlZGdlLnRvVmVydGV4XVtlZGdlLnRvSW5wdXRdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlZGdlLmZyb21WZXJ0ZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5kb3duc3RyZWFtRWRnZXNbZWRnZS5mcm9tVmVydGV4XS5zcGxpY2UodGhpcy5kb3duc3RyZWFtRWRnZXNbZWRnZS5mcm9tVmVydGV4XS5pbmRleE9mKGluZGV4KSwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZWRnZS5mcm9tVmVydGV4ICE9PSB1bmRlZmluZWQgJiYgdGhpcy5kb3duc3RyZWFtRWRnZXNbZWRnZS5mcm9tVmVydGV4XS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5yb290VmVydGljZXMucHVzaChlZGdlLmZyb21WZXJ0ZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy52ZXJ0aWNlcy5mb3JFYWNoKChfLCB2KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVwc3RyZWFtRWRnZXNbdl0uZm9yRWFjaCgoZSwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlID4gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cHN0cmVhbUVkZ2VzW3ZdW2ldID0gZSAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmRvd25zdHJlYW1FZGdlc1t2XS5mb3JFYWNoKChlLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGUgPiBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvd25zdHJlYW1FZGdlc1t2XVtpXSA9IGUgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBFbnVtZXJhdGUgdGhlIGNvbm5lY3RlZCBjb21wb25lbnRzIG9mIHRoZSBzdWJncmFwaCBjb250YWluaW5nIHRoZSBnaXZlbiB2ZXJ0aWNlc1xuICAgIGNvbm5lY3RlZENvbXBvbmVudHModmVydGV4SW5kaWNlczogbnVtYmVyW10pOiBDb25uZWN0ZWRDb21wb25lbnRbXSB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudFJvb3RWZXJ0aWNlcyA9IHZlcnRleEluZGljZXMuZmlsdGVyKHZlcnRleEluZGV4ID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRvd25zdHJlYW1FZGdlc1t2ZXJ0ZXhJbmRleF0ucmVkdWNlKChpc1Jvb3QsIGVkZ2UpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXNSb290ICYmIHZlcnRleEluZGljZXMuaW5kZXhPZih0aGlzLmVkZ2VzW2VkZ2VdLnRvVmVydGV4KSA8IDA7XG4gICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudFJvb3RWZXJ0aWNlcy5tYXAoKHZlcnRleEluZGV4OiBudW1iZXIpOiBDb25uZWN0ZWRDb21wb25lbnQgPT4ge1xuICAgICAgICAgICAgbGV0IGNvbm5lY3RlZENvbXBvbmVudDogQ29ubmVjdGVkQ29tcG9uZW50ID0ge1xuICAgICAgICAgICAgICAgIHZlcnRpY2VzOiBbXSxcbiAgICAgICAgICAgICAgICByb290VmVydGV4OiB2ZXJ0ZXhJbmRleCxcbiAgICAgICAgICAgICAgICBpbnRlcm5hbEVkZ2VzOiBbXSxcbiAgICAgICAgICAgICAgICBpbnB1dEVkZ2VzOiBbXSxcbiAgICAgICAgICAgICAgICBvdXRwdXRFZGdlczogW10sXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBSZWN1cnNpdmUgZnVuY3Rpb24gdG8gdHJhdmVyc2UgdGhlIHN1YmdyYXBoIGFuZCBwb3B1bGF0ZSBjb25uZWN0ZWRDb21wb25lbnRcbiAgICAgICAgICAgIGNvbnN0IHRyYXZlcnNlID0gKHZlcnRleEluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhpcyB2ZXJ0ZXggdG8gdGhlIGluY2x1ZGVkIHZlcnRpY2VzXG4gICAgICAgICAgICAgICAgY29ubmVjdGVkQ29tcG9uZW50LnZlcnRpY2VzLnB1c2godmVydGV4SW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkIGFueSBkb3duc3RyZWFtIGVkZ2VzIHRvIG5vbi1jb21wb25lbnQgdmVydGljZXMgdG8gdGhlIG91dHB1dEVkZ2VzIGxpc3RcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdPdXRwdXRFZGdlcyA9IHRoaXMuZG93bnN0cmVhbUVkZ2VzW3ZlcnRleEluZGV4XS5maWx0ZXIoZG93bnN0cmVhbUVkZ2VJbmRleCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2ZXJ0ZXhJbmRpY2VzLmluZGV4T2YodGhpcy5lZGdlc1tkb3duc3RyZWFtRWRnZUluZGV4XS50b1ZlcnRleCkgPCAwO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbm5lY3RlZENvbXBvbmVudC5vdXRwdXRFZGdlcy5wdXNoKC4uLm5ld091dHB1dEVkZ2VzKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCBhbnkgdXBzdHJlYW0gZWRnZXMgdG8gbm9uLWNvbXBvbmVudCB2ZXJ0aWNlcyB0byB0aGUgaW5wdXRFZGdlcyBsaXN0XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3SW5wdXRFZGdlcyA9IHRoaXMudXBzdHJlYW1FZGdlc1t2ZXJ0ZXhJbmRleF0uZmlsdGVyKHVwc3RyZWFtRWRnZUluZGV4ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZlcnRleEluZGljZXMuaW5kZXhPZih0aGlzLmVkZ2VzW3Vwc3RyZWFtRWRnZUluZGV4XS5mcm9tVmVydGV4KSA8IDA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29ubmVjdGVkQ29tcG9uZW50LmlucHV0RWRnZXMucHVzaCguLi5uZXdJbnB1dEVkZ2VzKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCBhbmQgUmVjdXJzZSBvbiB1cHN0cmVhbSBlZGdlcyB0byBjb21wb25lbnQgdmVydGljZXNcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdJbnRlcm5hbEVkZ2VzID0gdGhpcy51cHN0cmVhbUVkZ2VzW3ZlcnRleEluZGV4XS5maWx0ZXIodXBzdHJlYW1FZGdlSW5kZXggPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVydGV4SW5kaWNlcy5pbmRleE9mKHRoaXMuZWRnZXNbdXBzdHJlYW1FZGdlSW5kZXhdLmZyb21WZXJ0ZXgpID49IDA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29ubmVjdGVkQ29tcG9uZW50LmludGVybmFsRWRnZXMucHVzaCguLi5uZXdJbnRlcm5hbEVkZ2VzKTtcbiAgICAgICAgICAgICAgICBsZXQgdXBzdHJlYW1WZXJ0aWNlcyA9IG5ld0ludGVybmFsRWRnZXMubWFwKGVkZ2VJbmRleCA9PiB0aGlzLmVkZ2VzW2VkZ2VJbmRleF0uZnJvbVZlcnRleCk7XG4gICAgICAgICAgICAgICAgdXBzdHJlYW1WZXJ0aWNlcyA9IHVwc3RyZWFtVmVydGljZXMuZmlsdGVyKCh2YWx1ZSwgaW5kZXgsIHNlbGYpID0+IHNlbGYuaW5kZXhPZih2YWx1ZSkgPT0gaW5kZXgpO1xuICAgICAgICAgICAgICAgIHVwc3RyZWFtVmVydGljZXMuZm9yRWFjaCh1cHN0cmVhbVZlcnRleEluZGV4ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHJhdmVyc2UodXBzdHJlYW1WZXJ0ZXhJbmRleCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0cmF2ZXJzZSh2ZXJ0ZXhJbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGVkQ29tcG9uZW50O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm5zIHRoZSBsaXN0IG9mIG5ldyBlZGdlcyB0aGF0IHdvdWxkIG5lZWQgdG8gYmUgYWRkZWQgdG8gXCJieXBhc3NcIlxuICAgIC8vIHRoZSBnaXZlbiBjb25uZWN0ZWQgY29tcG9uZW50LlxuICAgIGJ5cGFzc0VkZ2VzKGNjOiBDb25uZWN0ZWRDb21wb25lbnQpOiBFZGdlW10ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgICAgIGlmIChjYy5pbnB1dEVkZ2VzLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICBjYy5vdXRwdXRFZGdlcy5mb3JFYWNoKG91dHB1dEVkZ2VJbmRleCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0RWRnZSA9IHRoaXMuZWRnZXNbb3V0cHV0RWRnZUluZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAob3V0cHV0RWRnZS5mcm9tVmVydGV4ID09IGNjLnJvb3RWZXJ0ZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbVZlcnRleDogdGhpcy5lZGdlc1tjYy5pbnB1dEVkZ2VzWzBdXS5mcm9tVmVydGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9WZXJ0ZXg6IG91dHB1dEVkZ2UudG9WZXJ0ZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b0lucHV0OiBvdXRwdXRFZGdlLnRvSW5wdXQsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJucyBhIGxpc3Qgb2YgaW5kaWNlcyByZXByZXNlbnRpbmcgdGhlIHZlcnRpY2VzIGJldHdlZW4gKGFuZCBpbmNsdWRpbmcpXG4gICAgLy8gdGhlIHR3byBnaXZlbiB2ZXJ0aWNlcy5cbiAgICB2ZXJ0aWNlc0JldHdlZW4odmVydGV4MTogbnVtYmVyLCB2ZXJ0ZXgyOiBudW1iZXIpOiBudW1iZXJbXSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgICAgY29uc3QgdHJhdmVyc2UgPSAocGF0aDogbnVtYmVyW10sIHRhcmdldDogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2ZXJ0ZXggPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAodmVydGV4ID09IHRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKC4uLnBhdGgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvd25zdHJlYW1WZXJ0ZXhJbmRpY2VzKHZlcnRleCkuZm9yRWFjaChkb3duc3RyZWFtVmVydGV4SW5kZXggPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGF0aC5pbmRleE9mKGRvd25zdHJlYW1WZXJ0ZXhJbmRleCkgPCAwKSB7IC8vIG5vdCB2aXNpdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmF2ZXJzZShwYXRoLmNvbmNhdChbZG93bnN0cmVhbVZlcnRleEluZGV4XSksIHRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vdCBzdXJlIHdoaWNoIG5vZGUgaXMgdXAvZG93bnN0cmVhbS4gVHJhdmVyc2Ugb25seSBsb29rcyBkb3duc3RyZWFtLCBzbyB0cnkgYm90aCB3YXlzLlxuICAgICAgICB0cmF2ZXJzZShbdmVydGV4MV0sIHZlcnRleDIpO1xuICAgICAgICB0cmF2ZXJzZShbdmVydGV4Ml0sIHZlcnRleDEpO1xuXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoKHZhbHVlLCBpbmRleCwgc2VsZikgPT4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PSBpbmRleCk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5cbiIsImltcG9ydCB7Q29udGV4dH0gZnJvbSBcIi4uL3BrZy9pbmRleC5qc1wiO1xuaW1wb3J0IHtHcmFwaERhdGEsIEVkZ2UsIENvbm5lY3RlZENvbXBvbmVudH0gZnJvbSBcIi4vZ3JhcGhfZGF0YVwiO1xuXG50eXBlIFVJRCA9IG51bWJlcjtcblxuZXhwb3J0IGludGVyZmFjZSBBZGp1c3RFdmVudERldGFpbCB7XG4gICAgY29udHJvbDogbnVtYmVyOyAvLyBXaGljaCBjb250cm9sIHRvIGFkanVzdCAoMCA9IHByaW1hcnksIDEgPSBzZWNvbmRhcnksIC4uLilcbiAgICBhbW91bnRSZWxhdGl2ZTogbnVtYmVyOyAvLyBIb3cgbXVjaCB0byBhZGp1c3QgaXQgKHJlbGF0aXZlIHRvIGN1cnJlbnQgdmFsdWUpXG59XG5cbmV4cG9ydCBjbGFzcyBWaWRlb05vZGVUaWxlIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgIG5JbnB1dHM6IG51bWJlcjtcbiAgICBpbnB1dEhlaWdodHM6IG51bWJlcltdO1xuICAgIHVpZDogVUlEO1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG4gICAgZ3JhcGg6IEdyYXBoO1xuICAgIHByZXZpZXc6IFZpZGVvTm9kZVByZXZpZXc7XG4gICAgaW5uZXI6IEhUTUxFbGVtZW50O1xuXG4gICAgLy8gUHJvcGVydGllcyByZWxhdGluZyB0byBkcmFnXG4gICAgb2Zmc2V0WDogbnVtYmVyOyAvLyBDdXJyZW50IFggb2Zmc2V0IG9mIHRoZSB0aWxlXG4gICAgb2Zmc2V0WTogbnVtYmVyOyAvLyBDdXJyZW50IFkgb2Zmc2V0IG9mIHRoZSB0aWxlXG4gICAgZHJhZ2dpbmc6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IHRoZSB0aWxlIGlzIGJlaW5nIGRyYWdnZWRcbiAgICBtb3VzZURyYWc6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IHRoZSB0aWxlIGlzIGJlaW5nIGRyYWdnZWQgZHVlIHRvIHRoZSBtb3VzZVxuICAgIHRvdWNoRHJhZzogYm9vbGVhbjsgLy8gV2hldGhlciBvciBub3QgdGhlIHRpbGUgaXMgYmVpbmcgZHJhZ2dlZCBkdWUgdG8gYSB0b3VjaFxuICAgIHN0YXJ0RHJhZ1g6IG51bWJlcjsgLy8gWCBjb29yZGluYXRlIG9mIHRoZSBzdGFydCBvZiB0aGUgZHJhZ1xuICAgIHN0YXJ0RHJhZ1k6IG51bWJlcjsgLy8gWSBjb29yZGluYXRlIG9mIHRoZSBzdGFydCBvZiB0aGUgZHJhZ1xuICAgIHRvdWNoSWQ7IC8vIFRoZSBpZGVudGlmaWVyIG9mIHRoZSB0b3VjaGV2ZW50IGNhdXNpbmcgdGhlIGRyYWdcbiAgICBkcmFnQ3RybDogYm9vbGVhbjsgLy8gV2hldGhlciBvciBub3Qgc2hpZnQta2V5IHdhcyBoZWxkIGF0IHN0YXJ0IG9mIGRyYWdcbiAgICBkcmFnU2hpZnQ6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IGN0cmwta2V5IHdhcyBoZWxkIGF0IHN0YXJ0IG9mIGRyYWdcbiAgICBkcmFnU2VsZWN0ZWQ6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IHRpbGUgd2FzIHNlbGVjdGVkIGF0IHN0YXJ0IG9mIGRyYWdcbiAgICB3YXNDbGljazogYm9vbGVhbjsgLy8gV2hldGhlciBvciBub3QgYSBkcmFnIGV2ZW50IHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBhIGNsaWNrIGluc3RlYWRcbiAgICBvbGRXaWR0aDogbnVtYmVyOyAvLyBTdGF0ZSB0byBhdm9pZCB1bm5lY2Vzc2FyeSBDU1Mgd2lkdGggY2hhbmdlc1xuICAgIG9sZEhlaWdodDogbnVtYmVyOyAvLyBTdGF0ZSB0byBhdm9pZCB1bm5lY2Vzc2FyeSBDU1MgaGVpZ2h0IGNoYW5nZXNcbiAgICBjY0RyYWc6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IHRoZSB0aWxlIGlzIGJlaW5nIGRyYWdnZWQgZHVlIHRvIGJlaW5nIHBhcnQgb2YgYSBjb25uZWN0ZWQgY29tcG9uZW50XG5cbiAgICAvLyBQcm9wZXJ0aWVzIHJlbGF0aW5nIHRvIHNlbGVjdGlvblxuICAgIF9zZWxlY3RlZDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm5JbnB1dHMgPSAwO1xuICAgICAgICB0aGlzLmlucHV0SGVpZ2h0cyA9IFtdO1xuICAgICAgICB0aGlzLnVpZCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5vZmZzZXRYID0gMDtcbiAgICAgICAgdGhpcy5vZmZzZXRZID0gMDtcbiAgICAgICAgdGhpcy5kcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1vdXNlRHJhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRvdWNoRHJhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNjRHJhZyA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3NlbGVjdGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIGNvbnN0IHNoYWRvdyA9IHRoaXMuYXR0YWNoU2hhZG93KHttb2RlOiAnb3Blbid9KTtcbiAgICAgICAgc2hhZG93LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAgIDpob3N0IHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxNXB4IDBweDtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgICAgICAgICAgbGVmdDogMHB4O1xuICAgICAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgICAgICAgICAgICAgei1pbmRleDogMDtcbiAgICAgICAgICAgICAgICBvdXRsaW5lOiBub25lO1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICAgICAgICAgICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDFzLCB3aWR0aCAxcywgaGVpZ2h0IDFzLCBvcGFjaXR5IDAuNXMsIHotaW5kZXggMXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDpob3N0KDpmb2N1cykge1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxcywgd2lkdGggMXMsIGhlaWdodCAxcywgb3BhY2l0eSAwLjVzLCB6LWluZGV4IDBzO1xuICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwMDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDpob3N0KFtkcmFnZ2luZ10pIHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjU7XG4gICAgICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMHMsIHdpZHRoIDBzLCBoZWlnaHQgMHMsIG9wYWNpdHkgMC41cywgei1pbmRleCAwcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgOmhvc3QoOmZvY3VzKSAjb3V0bGluZSB7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgd2hpdGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDpob3N0KFtzZWxlY3RlZF0pICNpbm5lciB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMDA2NjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgI2lubmVyIHtcbiAgICAgICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgICBwb2ludGVyLWV2ZW50czogYWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAjb3V0bGluZSB7XG4gICAgICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICAgIGxlZnQ6IC0xcHg7XG4gICAgICAgICAgICAgICAgcmlnaHQ6IC0xcHg7XG4gICAgICAgICAgICAgICAgdG9wOiAxNHB4O1xuICAgICAgICAgICAgICAgIGJvdHRvbTogMTRweDtcbiAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCBncmF5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgICAgIDxkaXYgaWQ9XCJpbm5lclwiPlxuICAgICAgICAgICAgICAgIDxzbG90Pjwvc2xvdD5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwib3V0bGluZVwiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgdGhpcy5pbm5lciA9IHNoYWRvdy5xdWVyeVNlbGVjdG9yKFwiI2lubmVyXCIpO1xuXG4gICAgICAgIHRoaXMuaW5uZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5tb3VzZURvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm1vdXNlVXAuYmluZCh0aGlzKSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW91c2VNb3ZlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlubmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLnRvdWNoU3RhcnQuYmluZCh0aGlzKSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLnRvdWNoRW5kLmJpbmQodGhpcykpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNoTW92ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50YWJJbmRleCA9IDA7XG5cbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHRoaXMua2V5UHJlc3MuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB0aGlzLm9uU2Nyb2xsLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHdpZHRoKCkge1xuICAgICAgICAvLyBUaWxlIHdpZHRoXG4gICAgICAgIC8vIE92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIHNwZWNpZnkgd2lkdGgsIGUuZy4gYXMgYSBmdW5jdGlvbiBvZiBoZWlnaHRcbiAgICAgICAgcmV0dXJuIDExMDtcbiAgICB9XG5cbiAgICBtaW5JbnB1dEhlaWdodChpbnB1dDogbnVtYmVyKSB7XG4gICAgICAgIC8vIE1pbmltdW0gaGVpZ2h0IG9mIHRoZSBnaXZlbiBpbnB1dC5cbiAgICAgICAgLy8gQW4gaW5wdXQncyBoZWlnaHQgbWF5IGJlIGV4cGFuZGVkIGlmIHVwc3RyZWFtIGJsb2NrcyBhcmUgdGFsbC5cbiAgICAgICAgLy8gT3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gc3BlY2lmeSBtaW5pbXVtIGlucHV0IGhlaWdodHMgZm9yIHlvdXIgbm9kZSB0eXBlLlxuICAgICAgICAvLyBUaGlzIG1ldGhvZCB3aWxsIGJlIGNhbGxlZCBhdCBsZWFzdCBvbmNlLCBldmVuIGlmIHRoZXJlIGFyZSBubyBpbnB1dHMsIHRvIGdldCB0aGVcbiAgICAgICAgLy8gaGVpZ2h0IG9mIHRoZSBub2RlLiBTbyBpbXBsZW1lbnQgaXQgZXZlbiBpZiB5b3VyIG5vZGUgaGFzIHplcm8gaW5wdXRzLlxuICAgICAgICByZXR1cm4gMjAwO1xuICAgIH1cblxuICAgIGhlaWdodCgpIHtcbiAgICAgICAgLy8gVG90YWwgaGVpZ2h0ID0gc3VtIG9mIGlucHV0SGVpZ2h0c1xuICAgICAgICAvLyBEbyBub3Qgb3ZlcnJpZGUgdGhpcyBtZXRob2QuXG4gICAgICAgIHJldHVybiB0aGlzLmlucHV0SGVpZ2h0cy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTtcbiAgICB9XG5cbiAgICB1cGRhdGVTaXplKCkge1xuICAgICAgICB0aGlzLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0KCl9cHhgO1xuICAgICAgICB0aGlzLnN0eWxlLndpZHRoID0gYCR7dGhpcy53aWR0aCgpfXB4YDtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnByZXZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlldy5yZW5kZXIodGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVGcm9tU3RhdGUoZGF0YTogYW55KSB7XG4gICAgICAgIGlmIChcIm5JbnB1dHNcIiBpbiBkYXRhICYmIGRhdGEubklucHV0cyAhPSB0aGlzLm5JbnB1dHMpIHtcbiAgICAgICAgICAgIHRoaXMubklucHV0cyA9IGRhdGEubklucHV0cztcbiAgICAgICAgICAgIHRoaXMuZ3JhcGgucmVxdWVzdFJlbGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b3VjaFN0YXJ0KGV2ZW50OiBUb3VjaEV2ZW50KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnQuY2hhbmdlZFRvdWNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCB0b3VjaCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzLml0ZW0oaSk7XG4gICAgICAgICAgICBpZiAodG91Y2gudGFyZ2V0ICE9IHRoaXMuaW5uZXIgJiYgdG91Y2gudGFyZ2V0ICE9IHRoaXMuaW5uZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGFjY2VwdCBjbGlja3Mgb250byB0aGlzIHN1cmZhY2UsIG5vdCBpdHMgY2hpbGQgKGlubmVyKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmRyYWdnaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b3VjaERyYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudG91Y2hJZCA9IHRvdWNoLmlkZW50aWZpZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnQ3RybCA9IGV2ZW50LmN0cmxLZXk7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU2hpZnQgPSBldmVudC5zaGlmdEtleTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaC5lbnN1cmVTZWxlY3RlZCh0aGlzLCB0aGlzLmRyYWdDdHJsLCB0aGlzLmRyYWdTaGlmdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnREcmFnKHRvdWNoLnBhZ2VYLCB0b3VjaC5wYWdlWSk7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdXNlRG93bihldmVudDogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICE9IHRoaXMuaW5uZXIgJiYgZXZlbnQudGFyZ2V0ICE9IHRoaXMuaW5uZXIpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgYWNjZXB0IGNsaWNrcyBvbnRvIHRoaXMgc3VyZmFjZSwgbm90IGl0cyBjaGlsZCAoaW5uZXIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmRyYWdnaW5nICYmIChldmVudC5idXR0b25zICYgMSkpIHtcbiAgICAgICAgICAgIHRoaXMubW91c2VEcmFnID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0N0cmwgPSBldmVudC5jdHJsS2V5O1xuICAgICAgICAgICAgdGhpcy5kcmFnU2hpZnQgPSBldmVudC5zaGlmdEtleTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ1NlbGVjdGVkID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgICAgIHRoaXMuZ3JhcGguZW5zdXJlU2VsZWN0ZWQodGhpcywgdGhpcy5kcmFnQ3RybCwgdGhpcy5kcmFnU2hpZnQpO1xuICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICAgICAgdGhpcy5zdGFydERyYWcoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b3VjaEVuZChldmVudDogVG91Y2hFdmVudCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5pdGVtKGkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy50b3VjaERyYWcgJiYgdGhpcy50b3VjaElkID09IHRvdWNoLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdWNoRHJhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuZW5kRHJhZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW91c2VVcChldmVudDogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZyAmJiB0aGlzLm1vdXNlRHJhZyAmJiAhKGV2ZW50LmJ1dHRvbnMgJiAxKSkge1xuICAgICAgICAgICAgdGhpcy5tb3VzZURyYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZW5kRHJhZygpO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRvdWNoTW92ZShldmVudDogVG91Y2hFdmVudCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5pdGVtKGkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy50b3VjaERyYWcgJiYgdGhpcy50b3VjaElkID09IHRvdWNoLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcodG91Y2gucGFnZVgsIHRvdWNoLnBhZ2VZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdXNlTW92ZShldmVudDogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZyAmJiB0aGlzLm1vdXNlRHJhZykge1xuICAgICAgICAgICAgdGhpcy5kcmFnKGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RhcnREcmFnKHB0WDogbnVtYmVyLCBwdFk6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZykge1xuICAgICAgICAgICAgdGhyb3cgXCJDYW5ub3Qgc3RhcnQgZHJhZyB3aGlsZSBkcmFnIGluIHByb2dyZXNzXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kcmFnZ2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMuc3RhcnREcmFnWCA9IHB0WDtcbiAgICAgICAgdGhpcy5zdGFydERyYWdZID0gcHRZO1xuICAgICAgICB0aGlzLndhc0NsaWNrID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBlbmREcmFnKCkge1xuICAgICAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMub2Zmc2V0WCA9IDA7XG4gICAgICAgIHRoaXMub2Zmc2V0WSA9IDA7XG4gICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiZHJhZ2dpbmdcIik7XG4gICAgICAgIHRoaXMudXBkYXRlTG9jYXRpb24oKTtcbiAgICAgICAgaWYgKHRoaXMud2FzQ2xpY2spIHtcbiAgICAgICAgICAgIHRoaXMuZ3JhcGguc2VsZWN0KHRoaXMsIHRoaXMuZHJhZ1NlbGVjdGVkLCB0aGlzLmRyYWdDdHJsLCB0aGlzLmRyYWdTaGlmdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2NEcmFnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmFwaC5lbmREcmFnQ0MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYWcocHRYOiBudW1iZXIsIHB0WTogbnVtYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLndhc0NsaWNrKSB7XG4gICAgICAgICAgICB0aGlzLndhc0NsaWNrID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImRyYWdnaW5nXCIsIFwidHJ1ZVwiKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jY0RyYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXBoLnN0YXJ0RHJhZ0NDKHRoaXMsIHRoaXMuc3RhcnREcmFnWCwgdGhpcy5zdGFydERyYWdZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuY2NEcmFnKSB7XG4gICAgICAgICAgICB0aGlzLmdyYXBoLmRyYWdDQyhwdFgsIHB0WSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vZmZzZXRYID0gcHRYIC0gdGhpcy5zdGFydERyYWdYO1xuICAgICAgICB0aGlzLm9mZnNldFkgPSBwdFkgLSB0aGlzLnN0YXJ0RHJhZ1k7XG4gICAgICAgIHRoaXMudXBkYXRlTG9jYXRpb24oKTtcbiAgICB9XG5cbiAgICB1cGRhdGVMb2NhdGlvbigpIHtcbiAgICAgICAgY29uc3QgbmV3V2lkdGggPSB0aGlzLndpZHRoKCk7XG4gICAgICAgIGNvbnN0IG5ld0hlaWdodCA9IHRoaXMuaGVpZ2h0KCk7XG4gICAgICAgIGlmIChuZXdXaWR0aCAhPSB0aGlzLm9sZFdpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndpZHRoID0gYCR7bmV3V2lkdGh9cHhgO1xuICAgICAgICAgICAgdGhpcy5vbGRXaWR0aCA9IG5ld1dpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdIZWlnaHQgIT0gdGhpcy5vbGRIZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuaGVpZ2h0ID0gYCR7bmV3SGVpZ2h0fXB4YDtcbiAgICAgICAgICAgIHRoaXMub2xkSGVpZ2h0ID0gbmV3SGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueCArIHRoaXMub2Zmc2V0WH1weCwgJHt0aGlzLnkgKyB0aGlzLm9mZnNldFl9cHgpYDtcbiAgICB9XG5cbiAgICBnZXQgc2VsZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RlZDtcbiAgICB9XG5cbiAgICBzZXQgc2VsZWN0ZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWQgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwidHJ1ZVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBrZXlQcmVzcyhldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQuY29kZSA9PSBcIkRlbGV0ZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmdyYXBoLmRlbGV0ZVNlbGVjdGVkKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PSBcIlNwYWNlXCIpIHtcbiAgICAgICAgICAgIC8vIFhYWCBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBBcnJheS5mcm9tKHRoaXMuZ3JhcGgudGlsZXMudmVydGljZXMua2V5cygpKS5maWx0ZXIoKGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGgudGlsZXMudmVydGljZXNbaW5kZXhdLnNlbGVjdGVkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3RlZCBjb21wb25lbnRzOlwiKTtcbiAgICAgICAgICAgIHRoaXMuZ3JhcGgudGlsZXMuY29ubmVjdGVkQ29tcG9uZW50cyhzZWxlY3Rpb24pLmZvckVhY2goY29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wb25lbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblNjcm9sbChldmVudDogV2hlZWxFdmVudCkge1xuICAgICAgICB0aGlzLmdyYXBoLm9uU2Nyb2xsKGV2ZW50KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG59XG5cbmNsYXNzIFZpZGVvTm9kZVByZXZpZXcgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgY29udGVudDogSFRNTEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgY29uc3Qgc2hhZG93ID0gdGhpcy5hdHRhY2hTaGFkb3coe21vZGU6ICdvcGVuJ30pO1xuICAgICAgICBzaGFkb3cuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgOmhvc3Qge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgICAgICAgIHdpZHRoOiA4MCU7XG4gICAgICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjc3F1YXJlIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgICAgbWFyZ2luOiAxMHB4IGF1dG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjc3F1YXJlOmFmdGVyIHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiBcIlwiO1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgICAgICAgIHBhZGRpbmctYm90dG9tOiAxMDAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2NvbnRlbnQge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgd2hpdGU7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgICA8ZGl2IGlkPVwic3F1YXJlXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cImNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuICAgICAgICB0aGlzLmNvbnRlbnQgPSBzaGFkb3cucXVlcnlTZWxlY3RvcihcIiNjb250ZW50XCIpO1xuICAgIH1cblxuICAgIHJlbmRlcih0aWxlOiBWaWRlb05vZGVUaWxlKSB7XG4gICAgICAgIGlmICh0aWxlLmRyYWdnaW5nKSB7XG4gICAgICAgICAgICB0aWxlLmdyYXBoLmNvbnRleHQuY2xlYXJFbGVtZW50KHRpbGUuaW5uZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRpbGUuZ3JhcGguY29udGV4dC5wYWludE5vZGUodGlsZS51aWQsIHRoaXMuY29udGVudCk7XG4gICAgfVxufVxuXG5jbGFzcyBEcm9wVGFyZ2V0IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgIGlubmVyOiBIVE1MRWxlbWVudDtcbiAgICBmcm9tVUlEOiBudW1iZXI7XG4gICAgdG9VSUQ6IG51bWJlcjtcbiAgICB0b0lucHV0OiBudW1iZXI7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbiAgICBfYWN0aXZlOiBib29sZWFuO1xuICAgIF9kcmFnZ2luZzogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuX2FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9kcmFnZ2luZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBjb25zdCBzaGFkb3cgPSB0aGlzLmF0dGFjaFNoYWRvdyh7bW9kZTogJ29wZW4nfSk7XG4gICAgICAgIHNoYWRvdy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgICA6aG9zdCB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICAgIHRvcDogMHB4O1xuICAgICAgICAgICAgICAgIGxlZnQ6IDBweDtcbiAgICAgICAgICAgICAgICB3aWR0aDogMHB4O1xuICAgICAgICAgICAgICAgIGhlaWdodDogMHB4O1xuICAgICAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgICAgICAgICAgICAgei1pbmRleDogMTtcbiAgICAgICAgICAgICAgICBvdXRsaW5lOiBub25lO1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gICAgICAgICAgICAgICAgd2lsbC1jaGFuZ2U6IG9wYWNpdHk7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzO1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDpob3N0KDpub3QoW2RyYWdnaW5nXSkpIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICA6aG9zdChbYWN0aXZlXSkge1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICNpbm5lciB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICAgIHdpZHRoOiA1MHB4O1xuICAgICAgICAgICAgICAgIGhlaWdodDogMjAwcHg7XG4gICAgICAgICAgICAgICAgbGVmdDogLTI1cHg7XG4gICAgICAgICAgICAgICAgdG9wOiAtMTAwcHg7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogcmFkaWFsLWdyYWRpZW50KGNsb3Nlc3Qtc2lkZSwgeWVsbG93LCB0cmFuc3BhcmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA8L3N0eWxlPlxuICAgICAgICAgICAgPGRpdiBpZD1cImlubmVyXCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICB0aGlzLmlubmVyID0gc2hhZG93LnF1ZXJ5U2VsZWN0b3IoXCIjaW5uZXJcIik7XG4gICAgfVxuXG4gICAgdXBkYXRlTG9jYXRpb24oKSB7XG4gICAgICAgIHRoaXMuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3RoaXMueH1weCwgJHt0aGlzLnl9cHgpYDtcbiAgICB9XG5cbiAgICBnZXQgYWN0aXZlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYWN0aXZlO1xuICAgIH1cblxuICAgIHNldCBhY3RpdmUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKHZhbHVlICYmICF0aGlzLl9hY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwiYWN0aXZlXCIsIFwidHJ1ZVwiKTtcbiAgICAgICAgfSBlbHNlIGlmICghdmFsdWUgJiYgdGhpcy5fYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImFjdGl2ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hY3RpdmUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXQgZHJhZ2dpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kcmFnZ2luZztcbiAgICB9XG5cbiAgICBzZXQgZHJhZ2dpbmcodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKHZhbHVlICYmICF0aGlzLl9kcmFnZ2luZykge1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJkcmFnZ2luZ1wiLCBcInRydWVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoIXZhbHVlICYmIHRoaXMuX2RyYWdnaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImRyYWdnaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2RyYWdnaW5nID0gdmFsdWU7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgR3JhcGggZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgLy8gVGhpcyBjdXN0b20gZWxlbWVudCBjcmVhdGVzIHRoZSB2aXN1YWwgY29udGV4dCBmb3IgZGlzcGxheWluZyBjb25uZWN0ZWQgbm9kZXMuXG5cbiAgICBuZXh0VUlEOiBudW1iZXI7XG4gICAgbm9kZXM6IEdyYXBoRGF0YTxVSUQ+OyAvLyBWZXJ0aWNlcyBhcmUgbm9kZSBVSURzXG4gICAgdGlsZXM6IEdyYXBoRGF0YTxWaWRlb05vZGVUaWxlPjsgLy8gVmVydGljZXMgYXJlIHRpbGVzXG4gICAgY29udGV4dDogQ29udGV4dDtcbiAgICByZWxheW91dFJlcXVlc3RlZDogYm9vbGVhbjtcbiAgICBvbGRXaWR0aDogbnVtYmVyO1xuICAgIG9sZEhlaWdodDogbnVtYmVyO1xuICAgIGN1cnJlbnREcmFnQ0M6IENvbm5lY3RlZENvbXBvbmVudDsgLy8gVGhlIGVudGl0eSBjdXJyZW50bHkgYmVpbmcgZHJhZ2dlZFxuICAgIGRyb3BUYXJnZXRzOiBEcm9wVGFyZ2V0W107XG4gICAgbGFzdFRpbGU6IFZpZGVvTm9kZVRpbGU7XG4gICAgc2VsZWN0VUlEOiBudW1iZXI7IC8vIFdoaWNoIHRpbGUgdG8gc2VsZWN0IGFmdGVyIGdyYXBoIHJlY29uY2lsaWF0aW9uXG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLm5leHRVSUQgPSAwO1xuICAgICAgICB0aGlzLnJlbGF5b3V0UmVxdWVzdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJvcFRhcmdldHMgPSBbXTtcbiAgICAgICAgdGhpcy50aWxlcyA9IG5ldyBHcmFwaERhdGEoW10sIFtdKTtcbiAgICAgICAgLy8gQSBuZXcgR3JhcGhEYXRhIGlzIGNyZWF0ZWQgZm9yIHRoZSBub2RlcyBvbiBldmVyeSBub2Rlc0NoYW5nZWQuXG4gICAgfVxuXG4gICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIGxldCBzaGFkb3cgPSB0aGlzLmF0dGFjaFNoYWRvdyh7bW9kZTogJ29wZW4nfSk7XG4gICAgICAgIHNoYWRvdy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgICA6aG9zdCB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHdpZHRoIDFzLCBoZWlnaHQgMXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqIHtcbiAgICAgICAgICAgICAgICBwb2ludGVyLWV2ZW50czogYXV0bztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgICA8c2xvdD48L3Nsb3Q+XG4gICAgICAgIGA7XG4gICAgfVxuXG4gICAgYXR0YWNoQ29udGV4dChjb250ZXh0OiBDb250ZXh0KSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgXCJDYW5ub3QgY2FsbCBhdHRhY2hDb250ZXh0IG1vcmUgdGhhbiBvbmNlIVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uR3JhcGhDaGFuZ2VkKHRoaXMubm9kZXNDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLm5vZGVzQ2hhbmdlZCgpO1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGFkZFRpbGUodWlkOiBudW1iZXIsIHN0YXRlKSB7IC8vIFRPRE8gYWRkIHR5cGUgdG8gc3RhdGVcbiAgICAgICAgY29uc3QgdHlwZSA9IHN0YXRlLm5vZGVUeXBlO1xuICAgICAgICBsZXQgdGlsZTogVmlkZW9Ob2RlVGlsZTtcbiAgICAgICAgaWYgKHR5cGUgPT0gXCJFZmZlY3ROb2RlXCIpIHtcbiAgICAgICAgICAgIHRpbGUgPSA8VmlkZW9Ob2RlVGlsZT5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicmFkaWFuY2UtZWZmZWN0bm9kZXRpbGVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBcIk1lZGlhTm9kZVwiKSB7XG4gICAgICAgICAgICB0aWxlID0gPFZpZGVvTm9kZVRpbGU+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJhZGlhbmNlLW1lZGlhbm9kZXRpbGVcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aWxlID0gPFZpZGVvTm9kZVRpbGU+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJhZGlhbmNlLXZpZGVvbm9kZXRpbGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0aWxlKTtcbiAgICAgICAgdGlsZS51aWQgPSB1aWQ7XG4gICAgICAgIHRpbGUuZ3JhcGggPSB0aGlzO1xuICAgICAgICB0aWxlLnVwZGF0ZUZyb21TdGF0ZShzdGF0ZSk7XG4gICAgICAgIC8vIFhYWCBuZWVkcyBSZWZDZWxsIHdyYXBwZXJcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uTm9kZUNoYW5nZWQodWlkLCBcImFsbFwiLCB0aWxlLnVwZGF0ZUZyb21TdGF0ZS5iaW5kKHRpbGUpKTtcbiAgICAgICAgcmV0dXJuIHRpbGU7XG4gICAgfVxuXG4gICAgcmVtb3ZlVGlsZSh0aWxlOiBWaWRlb05vZGVUaWxlKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlQ2hpbGQodGlsZSk7XG4gICAgfVxuXG4gICAgYWRkRHJvcFRhcmdldChmcm9tVUlEOiBudW1iZXIsIHRvVUlEOiBudW1iZXIsIHRvSW5wdXQ6IG51bWJlcikge1xuICAgICAgICBjb25zdCBkcm9wVGFyZ2V0ID0gPERyb3BUYXJnZXQ+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJhZGlhbmNlLWRyb3B0YXJnZXRcIik7XG4gICAgICAgIGRyb3BUYXJnZXQuZnJvbVVJRCA9IGZyb21VSUQ7XG4gICAgICAgIGRyb3BUYXJnZXQudG9VSUQgPSB0b1VJRDtcbiAgICAgICAgZHJvcFRhcmdldC50b0lucHV0ID0gdG9JbnB1dDtcbiAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChkcm9wVGFyZ2V0KTtcbiAgICAgICAgdGhpcy5kcm9wVGFyZ2V0cy5wdXNoKGRyb3BUYXJnZXQpO1xuICAgICAgICByZXR1cm4gZHJvcFRhcmdldDtcbiAgICB9XG5cbiAgICByZW1vdmVEcm9wVGFyZ2V0cygpIHtcbiAgICAgICAgdGhpcy5kcm9wVGFyZ2V0cy5mb3JFYWNoKGRyb3BUYXJnZXQgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlsZChkcm9wVGFyZ2V0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZHJvcFRhcmdldHMgPSBbXTtcbiAgICB9XG5cbiAgICBub2Rlc0NoYW5nZWQoKSB7XG4gICAgICAgIGxldCBub2RlcyA9IHRoaXMuY29udGV4dC5zdGF0ZSgpO1xuICAgICAgICB0aGlzLm5vZGVzID0gbmV3IEdyYXBoRGF0YShub2Rlcy52ZXJ0aWNlcywgbm9kZXMuZWRnZXMpO1xuXG4gICAgICAgIC8vIENvbnZlcnQgdGhlIG5vZGVzIERBRyBpbnRvIGEgdHJlZVxuXG4gICAgICAgIGNvbnN0IG9yaWdOdW1UaWxlVmVydGljZXMgPSB0aGlzLnRpbGVzLnZlcnRpY2VzLmxlbmd0aDtcblxuICAgICAgICBsZXQgdGlsZUZvclVJRCA6IHtbdWlkOiBudW1iZXJdOiBudW1iZXJ9ID0ge307XG5cbiAgICAgICAgLy8gVGhlcmUgY2FuIGJlIG11bHRpcGxlIHRpbGVzIGZvciBvbmUgVUlELi4uIHRoaXMgdGFrZXMgdGhlIGxhc3Qgb25lLiBQcm9iYWJseSBub3QgYWx3YXlzIHRoZSBiZXN0IG9wdGlvbi5cbiAgICAgICAgdGhpcy50aWxlcy52ZXJ0aWNlcy5mb3JFYWNoKCh2ZXJ0ZXgsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICB0aWxlRm9yVUlEW3ZlcnRleC51aWRdID0gaW5kZXg7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSBsaXN0cyBvZiB0aWxlIGluZGljZXMgdG8gZGVsZXRlLCBwcmUtcG9wdWxhdGVkIHdpdGggYWxsIGluZGljZXNcbiAgICAgICAgbGV0IHRpbGVWZXJ0aWNlc1RvRGVsZXRlOiBudW1iZXJbXSA9IEFycmF5LmZyb20odGhpcy50aWxlcy52ZXJ0aWNlcy5rZXlzKCkpO1xuICAgICAgICBsZXQgdGlsZUVkZ2VzVG9EZWxldGU6IG51bWJlcltdID0gQXJyYXkuZnJvbSh0aGlzLnRpbGVzLmVkZ2VzLmtleXMoKSk7XG4gICAgICAgIGxldCB0aWxlRWRnZXNUb0NyZWF0ZTogRWRnZVtdID0gW107XG5cbiAgICAgICAgLy8gTm90ZTogVHJhdmVyc2FsIHdpbGwgaGF2ZSB0byBrZWVwIHRyYWNrIG9mIHRpbGVzIGFzIHdlbGwgYXMgbm9kZXMuXG4gICAgICAgIC8vIFRPRE86IFRoaXMgYWxnb3JpdGhtIGlzIGEgbGl0dGxlIGFnZ3Jlc3NpdmUsIGFuZCB3aWxsIHRyZWF0IFwibW92ZXNcIiBhcyBkZWxldGlvbiArIGNyZWF0aW9uXG5cbiAgICAgICAgY29uc3QgdHJhdmVyc2UgPSAobm9kZVZlcnRleDogbnVtYmVyLCB0aWxlVmVydGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbGUgPSB0aGlzLnRpbGVzLnZlcnRpY2VzW3RpbGVWZXJ0ZXhdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpbnB1dCA9IDA7IGlucHV0IDwgdGlsZS5uSW5wdXRzOyBpbnB1dCsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVwc3RyZWFtTm9kZSA9IHRoaXMubm9kZXMudXBzdHJlYW1WZXJ0ZXhJbmRleChub2RlVmVydGV4LCBpbnB1dCk7XG4gICAgICAgICAgICAgICAgaWYgKHVwc3RyZWFtTm9kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgdXBzdHJlYW0gbm9kZSBVSUQgZm9yIHRoZSBnaXZlbiBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlVUlEID0gdGhpcy5ub2Rlcy52ZXJ0aWNlc1t1cHN0cmVhbU5vZGVdO1xuICAgICAgICAgICAgICAgICAgICAvLyBTZWUgaWYgdGhlIGNvbm5lY3Rpb24gZXhpc3RzIG9uIHRoZSB0aWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwc3RyZWFtVGlsZUVkZ2VJbmRleCA9IHRoaXMudGlsZXMudXBzdHJlYW1FZGdlc1t0aWxlVmVydGV4XVtpbnB1dF07XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHVwc3RyZWFtVGlsZVZlcnRleEluZGV4O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cHN0cmVhbVRpbGVFZGdlSW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJpYWxVcHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCA9IHRoaXMudGlsZXMuZWRnZXNbdXBzdHJlYW1UaWxlRWRnZUluZGV4XS5mcm9tVmVydGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBzdHJlYW1UaWxlID0gdGhpcy50aWxlcy52ZXJ0aWNlc1t0cmlhbFVwc3RyZWFtVGlsZVZlcnRleEluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwc3RyZWFtVGlsZVVJRCA9IHVwc3RyZWFtVGlsZS51aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBzdHJlYW1UaWxlVUlEID09IG5vZGVVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdGlsZSBtYXRjaGVzLCBkb24ndCBkZWxldGUgdGhlIGVkZ2Ugb3Igbm9kZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlVmVydGljZXNUb0RlbGV0ZS5zcGxpY2UodGlsZVZlcnRpY2VzVG9EZWxldGUuaW5kZXhPZih0cmlhbFVwc3RyZWFtVGlsZVZlcnRleEluZGV4KSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZUVkZ2VzVG9EZWxldGUuc3BsaWNlKHRpbGVFZGdlc1RvRGVsZXRlLmluZGV4T2YodXBzdHJlYW1UaWxlRWRnZUluZGV4KSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzdHJlYW1UaWxlLnVwZGF0ZUZyb21TdGF0ZSh0aGlzLmNvbnRleHQubm9kZVN0YXRlKHRoaXMubm9kZXMudmVydGljZXNbdXBzdHJlYW1Ob2RlXSwgXCJhbGxcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWFsIHdhcyBhIHN1Y2Nlc3M7IHVzZSB0aGlzIHRpbGUgYW5kIGVkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCA9IHRyaWFsVXBzdHJlYW1UaWxlVmVydGV4SW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBObyBuZWVkIHRvIHNwZWNpZmljYWxseSByZXF1ZXN0IGRlbGV0aW9uIG9mIGFuIGVkZ2U7IHNpbXBseSBub3QgcHJlc2VydmluZyBpdCB3aWxsIGNhdXNlIGl0IHRvIGJlIGRlbGV0ZWRcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZWUgaWYgdGhlcmUncyBhbiB1bnVzZWQgdGlsZSB3aXRoIHRoZSBjb3JyZWN0IFVJRCB3ZSBjYW4gcmUtdXNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBzb3J0IG9mIG5haXZlIGFuZCBtYXkgbGVhZCB0byB3ZWlyZCB0aWxlLXJlYXJyYW5naW5nIGJlaGF2aW9yIHZpc3VhbGx5LlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggb2YgdGlsZVZlcnRpY2VzVG9EZWxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50aWxlcy52ZXJ0aWNlc1tpbmRleF0udWlkID09IG5vZGVVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzdHJlYW1UaWxlVmVydGV4SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlsZVZlcnRpY2VzVG9EZWxldGUuc3BsaWNlKHRpbGVWZXJ0aWNlc1RvRGVsZXRlLmluZGV4T2YodXBzdHJlYW1UaWxlVmVydGV4SW5kZXgpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aWxlcy52ZXJ0aWNlc1t1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleF0udXBkYXRlRnJvbVN0YXRlKHRoaXMuY29udGV4dC5ub2RlU3RhdGUodGhpcy5ub2Rlcy52ZXJ0aWNlc1t1cHN0cmVhbU5vZGVdLCBcImFsbFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gc3VpdGFibGUgbm9kZSB3YXMgZm91bmQuIENyZWF0ZSBhIG5ldyBvbmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLmNvbnRleHQubm9kZVN0YXRlKHRoaXMubm9kZXMudmVydGljZXNbdXBzdHJlYW1Ob2RlXSwgXCJhbGxcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBzdHJlYW1UaWxlID0gdGhpcy5hZGRUaWxlKG5vZGVVSUQsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCA9IHRoaXMudGlsZXMuYWRkVmVydGV4KHVwc3RyZWFtVGlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVwc3RyZWFtVGlsZS51aWQgPT0gdGhpcy5zZWxlY3RVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QodXBzdHJlYW1UaWxlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBzdHJlYW1UaWxlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0VUlEID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVFZGdlc1RvQ3JlYXRlLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21WZXJ0ZXg6IHVwc3RyZWFtVGlsZVZlcnRleEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvVmVydGV4OiB0aWxlVmVydGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvSW5wdXQ6IGlucHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdHJhdmVyc2UodXBzdHJlYW1Ob2RlLCB1cHN0cmVhbVRpbGVWZXJ0ZXhJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEZvciBlYWNoIHN0YXJ0IG5vZGUsIG1ha2UgYSB0aWxlIG9yIHVzZSBhbiBleGlzdGluZyB0aWxlXG4gICAgICAgIHRoaXMubm9kZXMucm9vdFZlcnRpY2VzLmZvckVhY2goc3RhcnROb2RlSW5kZXggPT4ge1xuICAgICAgICAgICAgY29uc3QgdWlkID0gdGhpcy5ub2Rlcy52ZXJ0aWNlc1tzdGFydE5vZGVJbmRleF07XG4gICAgICAgICAgICBsZXQgc3RhcnRUaWxlSW5kZXg7XG4gICAgICAgICAgICBpZiAoISh1aWQgaW4gdGlsZUZvclVJRCkpIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGlsZSBmb3Igc3RhcnQgbm9kZVxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5jb250ZXh0Lm5vZGVTdGF0ZSh0aGlzLm5vZGVzLnZlcnRpY2VzW3N0YXJ0Tm9kZUluZGV4XSwgXCJhbGxcIik7XG4gICAgICAgICAgICAgICAgbGV0IHRpbGUgPSB0aGlzLmFkZFRpbGUodWlkLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGlsZS51aWQgPSB1aWQ7XG4gICAgICAgICAgICAgICAgc3RhcnRUaWxlSW5kZXggPSB0aGlzLnRpbGVzLmFkZFZlcnRleCh0aWxlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RhcnRUaWxlSW5kZXggPSB0aWxlRm9yVUlEW3VpZF07XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgZGVsZXRlIHRoZSB0aWxlIHdlIGZvdW5kXG4gICAgICAgICAgICAgICAgdGlsZVZlcnRpY2VzVG9EZWxldGUuc3BsaWNlKHRpbGVWZXJ0aWNlc1RvRGVsZXRlLmluZGV4T2Yoc3RhcnRUaWxlSW5kZXgpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyYXZlcnNlKHN0YXJ0Tm9kZUluZGV4LCBzdGFydFRpbGVJbmRleCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGNoYW5nZWQgPSAodGhpcy50aWxlcy52ZXJ0aWNlcy5sZW5ndGggPiBvcmlnTnVtVGlsZVZlcnRpY2VzXG4gICAgICAgICAgICAgICAgICAgICAgfHwgdGlsZUVkZ2VzVG9DcmVhdGUubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgICAgICAgIHx8IHRpbGVWZXJ0aWNlc1RvRGVsZXRlLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICB8fCB0aWxlRWRnZXNUb0RlbGV0ZS5sZW5ndGggPiAwKTtcblxuICAgICAgICAvLyBEZWxldGUgb2xkIHRpbGVzXG5cbiAgICAgICAgdGlsZVZlcnRpY2VzVG9EZWxldGUuZm9yRWFjaChpbmRleCA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRpbGUodGhpcy50aWxlcy52ZXJ0aWNlc1tpbmRleF0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnRpbGVzLnJlbW92ZUVkZ2VzKHRpbGVFZGdlc1RvRGVsZXRlKTtcblxuICAgICAgICB0aWxlRWRnZXNUb0NyZWF0ZS5mb3JFYWNoKGVkZ2UgPT4ge1xuICAgICAgICAgICAgdGhpcy50aWxlcy5hZGRFZGdlKGVkZ2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50aWxlcy5yZW1vdmVWZXJ0aWNlcyh0aWxlVmVydGljZXNUb0RlbGV0ZSk7XG5cbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV3IHRpbGUgdmVydGljZXM6XCIsIHRoaXMudGlsZXMudmVydGljZXMpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXcgdGlsZSBlZGdlczpcIiwgdGhpcy50aWxlcy5lZGdlcyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlZlcnRpY2VzIHRvIHJlbW92ZTpcIiwgdGlsZVZlcnRpY2VzVG9EZWxldGUpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFZGdlcyB0byByZW1vdmU6XCIsIHRpbGVFZGdlc1RvRGVsZXRlKTtcblxuICAgICAgICAgICAgdGhpcy5yZWxheW91dEdyYXBoKCk7XG4gICAgICAgICAgICB0aGlzLnJlbGF5b3V0RHJvcFRhcmdldHMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbGF5b3V0R3JhcGgoKSB7XG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIHJlc2l6ZXMgYW5kIHJlcG9zaXRpb25zIGFsbCB0aWxlc1xuICAgICAgICAvLyBhY2NvcmRpbmcgdG8gdGhlIGdyYXBoIHN0cnVjdHVyZS5cblxuICAgICAgICAvLyAxLiBGcm9tIGVhY2ggcm9vdCwgc2V0IGRvd25zdHJlYW0gbm9kZXMgdG8gYmUgYXQgbGVhc3QgYXMgdGFsbCBhcyB0aGVpciB1cHN0cmVhbSBub2Rlcy5cbiAgICAgICAgY29uc3Qgc2V0SW5wdXRIZWlnaHRzRndkID0gKGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGxldCB0aWxlID0gdGhpcy50aWxlcy52ZXJ0aWNlc1tpbmRleF07XG4gICAgICAgICAgICB0aWxlLmlucHV0SGVpZ2h0cyA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aWxlLm5JbnB1dHM7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBoZWlnaHQgPSB0aWxlLm1pbklucHV0SGVpZ2h0KGkpO1xuICAgICAgICAgICAgICAgIGxldCB1cHN0cmVhbVZlcnRleEluZGV4ID0gdGhpcy50aWxlcy51cHN0cmVhbVZlcnRleEluZGV4KGluZGV4LCBpKTtcbiAgICAgICAgICAgICAgICBpZiAodXBzdHJlYW1WZXJ0ZXhJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldElucHV0SGVpZ2h0c0Z3ZCh1cHN0cmVhbVZlcnRleEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5tYXgoaGVpZ2h0LCB0aGlzLnRpbGVzLnZlcnRpY2VzW3Vwc3RyZWFtVmVydGV4SW5kZXhdLmhlaWdodCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGlsZS5pbnB1dEhlaWdodHMucHVzaChoZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRpbGUubklucHV0cyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gUHVzaCBvbmUgaW5wdXRoZWlnaHQgZXZlbiBpZiB0aGVyZSBhcmUgbm8gaW5wdXRzLCB0byBzZXQgdGhlIG92ZXJhbGwgaGVpZ2h0XG4gICAgICAgICAgICAgICAgdGlsZS5pbnB1dEhlaWdodHMucHVzaCh0aWxlLm1pbklucHV0SGVpZ2h0KDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGxldCBpbmRleCBvZiB0aGlzLnRpbGVzLnJvb3RWZXJ0aWNlcykge1xuICAgICAgICAgICAgc2V0SW5wdXRIZWlnaHRzRndkKGluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIEZyb20gZWFjaCByb290LCBzZXQgdXBzdHJlYW0gbm9kZXMgdG8gYmUgYXQgbGVhc3QgYXMgdGFsbCBhcyB0aGVpciBkb3duc3RyZWFtIG5vZGVzJyBpbnB1dHMuXG4gICAgICAgIGNvbnN0IHNldElucHV0SGVpZ2h0c1JldiA9IChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBsZXQgdGlsZSA9IHRoaXMudGlsZXMudmVydGljZXNbaW5kZXhdO1xuICAgICAgICAgICAgbGV0IGhlaWdodCA9IHRpbGUuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgIGxldCBkb3duc3RyZWFtVmVydGV4SW5kZXggPSB0aGlzLnRpbGVzLmRvd25zdHJlYW1WZXJ0ZXhJbmRpY2VzKGluZGV4KVswXTtcbiAgICAgICAgICAgIGlmIChkb3duc3RyZWFtVmVydGV4SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGxldCBkb3duc3RyZWFtSGVpZ2h0ID0gdGhpcy50aWxlcy52ZXJ0aWNlc1tkb3duc3RyZWFtVmVydGV4SW5kZXhdLmhlaWdodCgpO1xuICAgICAgICAgICAgICAgIGxldCByYXRpbyA9IGRvd25zdHJlYW1IZWlnaHQgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgaWYgKHJhdGlvID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTY2FsZSBhbGwgaW5wdXRzIHByb3BvcnRpb25hbGx5IHRvIGdldCB0aGUgbm9kZSBzdWZmaWNpZW50bHkgdGFsbFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbGUubklucHV0czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlLmlucHV0SGVpZ2h0c1tpXSAqPSByYXRpbztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGxldCBpbmRleCBvZiB0aGlzLnRpbGVzLnJvb3RWZXJ0aWNlcykge1xuICAgICAgICAgICAgc2V0SW5wdXRIZWlnaHRzUmV2KGluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDMuIEZyb20gdGhlIGhlaWdodHMsIGNhbGN1bGF0ZSB0aGUgWS1jb29yZGluYXRlc1xuICAgICAgICBjb25zdCBzZXRZQ29vcmRpbmF0ZSA9IChpbmRleDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGxldCB0aWxlID0gdGhpcy50aWxlcy52ZXJ0aWNlc1tpbmRleF07XG4gICAgICAgICAgICB0aWxlLnkgPSB5O1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbGUubklucHV0czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVwc3RyZWFtVmVydGV4SW5kZXggPSB0aGlzLnRpbGVzLnVwc3RyZWFtVmVydGV4SW5kZXgoaW5kZXgsIGkpO1xuICAgICAgICAgICAgICAgIGlmICh1cHN0cmVhbVZlcnRleEluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0WUNvb3JkaW5hdGUodXBzdHJlYW1WZXJ0ZXhJbmRleCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHkgKz0gdGlsZS5pbnB1dEhlaWdodHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgeSA9IDA7XG4gICAgICAgIGZvciAobGV0IGluZGV4IG9mIHRoaXMudGlsZXMucm9vdFZlcnRpY2VzKSB7XG4gICAgICAgICAgICBzZXRZQ29vcmRpbmF0ZShpbmRleCwgeSk7XG4gICAgICAgICAgICB5ICs9IHRoaXMudGlsZXMudmVydGljZXNbaW5kZXhdLmhlaWdodCgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBoZWlnaHQgPSB5O1xuXG4gICAgICAgIC8vIDQuIEZyb20gdGhlIHdpZHRocywgY2FsY3VsYXRlIHRoZSBYLWNvb3JkaW5hdGVzXG4gICAgICAgIGNvbnN0IHNldFhDb29yZGluYXRlID0gKGluZGV4OiBudW1iZXIsIHg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgbGV0IHRpbGUgPSB0aGlzLnRpbGVzLnZlcnRpY2VzW2luZGV4XTtcbiAgICAgICAgICAgIHRpbGUueCA9IHg7XG5cbiAgICAgICAgICAgIHggLT0gdGlsZS53aWR0aCgpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbGUubklucHV0czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHVwc3RyZWFtID0gdGhpcy50aWxlcy51cHN0cmVhbVZlcnRleEluZGV4KGluZGV4LCBpKTtcbiAgICAgICAgICAgICAgICBpZiAodXBzdHJlYW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRYQ29vcmRpbmF0ZSh1cHN0cmVhbSwgeCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaW5kZXggb2YgdGhpcy50aWxlcy5yb290VmVydGljZXMpIHtcbiAgICAgICAgICAgIHNldFhDb29yZGluYXRlKGluZGV4LCAtdGhpcy50aWxlcy52ZXJ0aWNlc1tpbmRleF0ud2lkdGgoKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyA1LiBDb21wdXRlIHRvdGFsIHdpZHRoICYgaGVpZ2h0LCBhbmQgb2Zmc2V0IGFsbCBjb29yZGluYXRlc1xuICAgICAgICBsZXQgc21hbGxlc3RYID0gMDtcbiAgICAgICAgdGhpcy50aWxlcy52ZXJ0aWNlcy5mb3JFYWNoKHRpbGUgPT4ge1xuICAgICAgICAgICAgaWYgKHRpbGUueCA8IHNtYWxsZXN0WCkge1xuICAgICAgICAgICAgICAgIHNtYWxsZXN0WCA9IHRpbGUueDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudGlsZXMudmVydGljZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgICAgIHRpbGUueCAtPSBzbWFsbGVzdFg7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgd2lkdGggPSAtc21hbGxlc3RYO1xuICAgICAgICBpZiAodGhpcy5vbGRXaWR0aCAhPSB3aWR0aCkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcbiAgICAgICAgICAgIHRoaXMub2xkV2lkdGggPSB3aWR0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbGRIZWlnaHQgIT0gaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7XG4gICAgICAgICAgICB0aGlzLm9sZEhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IHVpZCBpbiB0aGlzLnRpbGVzLnZlcnRpY2VzKSB7XG4gICAgICAgICAgICBsZXQgdmVydGV4ID0gdGhpcy50aWxlcy52ZXJ0aWNlc1t1aWRdO1xuICAgICAgICAgICAgdmVydGV4LnVwZGF0ZUxvY2F0aW9uKCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmVxdWVzdFJlbGF5b3V0KCkge1xuICAgICAgICB0aGlzLnJlbGF5b3V0UmVxdWVzdGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZWxheW91dERyb3BUYXJnZXRzKCkge1xuICAgICAgICB0aGlzLnJlbW92ZURyb3BUYXJnZXRzKCk7XG5cbiAgICAgICAgLy8gQWRkIGRyb3AgdGlsZXMgYXQgdGhlIGlucHV0cyBvZiBldmVyeSBub2RlXG4gICAgICAgIHRoaXMudGlsZXMudmVydGljZXMuZm9yRWFjaCgodGlsZSwgdGlsZUluZGV4KSA9PiB7XG4gICAgICAgICAgICBsZXQgb2Zmc2V0SGVpZ2h0ID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGlsZS5uSW5wdXRzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9tSW5kZXggPSB0aGlzLnRpbGVzLnVwc3RyZWFtVmVydGV4SW5kZXgodGlsZUluZGV4LCBpKTtcbiAgICAgICAgICAgICAgICBsZXQgZnJvbVVJRCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGZyb21JbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21VSUQgPSB0aGlzLnRpbGVzLnZlcnRpY2VzW2Zyb21JbmRleF0udWlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0b1VJRCA9IHRpbGUudWlkO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvSW5wdXQgPSBpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGR0ID0gdGhpcy5hZGREcm9wVGFyZ2V0KGZyb21VSUQsIHRvVUlELCB0b0lucHV0KTtcbiAgICAgICAgICAgICAgICBkdC54ID0gdGlsZS54O1xuICAgICAgICAgICAgICAgIGR0LnkgPSB0aWxlLnkgKyBvZmZzZXRIZWlnaHQgKyAwLjUgKiB0aWxlLmlucHV0SGVpZ2h0c1tpXTtcbiAgICAgICAgICAgICAgICBvZmZzZXRIZWlnaHQgKz0gdGlsZS5pbnB1dEhlaWdodHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBkcm9wIHRpbGVzIHRvIHRoZSBvdXRwdXRzIG9mIGV2ZXJ5IHJvb3Qgbm9kZVxuICAgICAgICB0aGlzLnRpbGVzLnJvb3RWZXJ0aWNlcy5mb3JFYWNoKHRpbGVJbmRleCA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aWxlID0gdGhpcy50aWxlcy52ZXJ0aWNlc1t0aWxlSW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgZHQgPSB0aGlzLmFkZERyb3BUYXJnZXQodGlsZS51aWQsIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgZHQueCA9IHRpbGUueCArIHRpbGUud2lkdGgoKTtcbiAgICAgICAgICAgIGR0LnkgPSB0aWxlLnkgKyAwLjUgKiB0aWxlLmhlaWdodCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmRyb3BUYXJnZXRzLmZvckVhY2goZHQgPT4ge1xuICAgICAgICAgICAgZHQudXBkYXRlTG9jYXRpb24oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKHQ6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5yZWxheW91dFJlcXVlc3RlZCkge1xuICAgICAgICAgICAgdGhpcy5yZWxheW91dFJlcXVlc3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5yZWxheW91dEdyYXBoKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbnRleHQucmVuZGVyKHQpO1xuICAgICAgICB0aGlzLnRpbGVzLnZlcnRpY2VzLmZvckVhY2godGlsZSA9PiB7XG4gICAgICAgICAgICB0aWxlLnJlbmRlcigpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlci5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvLyBDYWxsZWQgd2hlbiBkcmFnZ2luZy4gRG9uJ3Qgd2FudCBjbGlja3Mgd2l0aG91dCBtb2RpZmllcnMgdG8gY2xlYXIgc2VsZWN0aW9uLlxuICAgIGVuc3VyZVNlbGVjdGVkKHRpbGU6IFZpZGVvTm9kZVRpbGUsIGN0cmxLZXk6IGJvb2xlYW4sIHNoaWZ0S2V5OiBib29sZWFuKSB7XG4gICAgICAgIGlmICghdGlsZS5zZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKCFjdHJsS2V5ICYmICFzaGlmdEtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzZWxlY3RBbGwoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEJldHdlZW4odGhpcy5sYXN0VGlsZSwgdGlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aWxlLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENhbGxlZCB3aGVuIGNsaWNraW5nLiBDbGlja3Mgd2l0aG91dCBtb2RpZmllcnMgc2hvdWxkIGNsZWFyIHNlbGVjdGlvbi5cbiAgICBzZWxlY3QodGlsZTogVmlkZW9Ob2RlVGlsZSwgc2VsZWN0ZWQ6IGJvb2xlYW4sIGN0cmxLZXk6IGJvb2xlYW4sIHNoaWZ0S2V5OiBib29sZWFuKSB7XG4gICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKHNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RCZXR3ZWVuKHRoaXMubGFzdFRpbGUsIHRpbGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdHJsS2V5KSB7XG4gICAgICAgICAgICAgICAgdGlsZS5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlc2VsZWN0QWxsKCk7XG4gICAgICAgICAgICAgICAgdGlsZS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWN0cmxLZXkgJiYgIXNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXNlbGVjdEFsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGlsZS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0VGlsZSA9IHRpbGU7XG4gICAgfVxuXG4gICAgZGVzZWxlY3RBbGwoKSB7XG4gICAgICAgIHRoaXMudGlsZXMudmVydGljZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgICAgIHRpbGUuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkRWRnZShlZGdlOiBFZGdlKSB7XG4gICAgICAgIHRoaXMuY29udGV4dC5hZGRFZGdlKHRoaXMubm9kZXMudmVydGljZXNbZWRnZS5mcm9tVmVydGV4XSwgdGhpcy5ub2Rlcy52ZXJ0aWNlc1tlZGdlLnRvVmVydGV4XSwgZWRnZS50b0lucHV0KTtcbiAgICB9XG5cbiAgICByZW1vdmVFZGdlQnlJbmRleChpbmRleDogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGVkZ2UgPSB0aGlzLm5vZGVzLmVkZ2VzW2luZGV4XTtcbiAgICAgICAgdGhpcy5jb250ZXh0LnJlbW92ZUVkZ2UodGhpcy5ub2Rlcy52ZXJ0aWNlc1tlZGdlLmZyb21WZXJ0ZXhdLCB0aGlzLm5vZGVzLnZlcnRpY2VzW2VkZ2UudG9WZXJ0ZXhdLCBlZGdlLnRvSW5wdXQpO1xuICAgIH1cblxuICAgIGRlbGV0ZVNlbGVjdGVkKCkge1xuICAgICAgICBsZXQgdWlkc1RvRGVsZXRlOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICB0aGlzLnRpbGVzLnZlcnRpY2VzLmZvckVhY2godGlsZSA9PiB7XG4gICAgICAgICAgICBpZiAodGlsZS5zZWxlY3RlZCAmJiB1aWRzVG9EZWxldGUuaW5kZXhPZih0aWxlLnVpZCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgdWlkc1RvRGVsZXRlLnB1c2godGlsZS51aWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWxldGlvbiBpcyBkb25lIGluIG5vZGUgc3BhY2UuIE1heSB3YW50IHRvIGF0dGVtcHQgdG8gZG8gaXQgaW4gdGlsZSBzcGFjZSBmaXJzdC5cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gQXJyYXkuZnJvbSh0aGlzLm5vZGVzLnZlcnRpY2VzLmtleXMoKSkuZmlsdGVyKChpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHVpZHNUb0RlbGV0ZS5pbmRleE9mKHRoaXMubm9kZXMudmVydGljZXNbaW5kZXhdKSA+PSAwO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2NzID0gdGhpcy5ub2Rlcy5jb25uZWN0ZWRDb21wb25lbnRzKHNlbGVjdGlvbik7XG5cbiAgICAgICAgbGV0IGJ5cGFzc0VkZ2VzOiBFZGdlW10gPSBbXTtcbiAgICAgICAgY2NzLmZvckVhY2goY2MgPT4ge1xuICAgICAgICAgICAgYnlwYXNzRWRnZXMucHVzaCguLi50aGlzLm5vZGVzLmJ5cGFzc0VkZ2VzKGNjKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHVpZHNUb0RlbGV0ZS5mb3JFYWNoKHVpZCA9PiB7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTm9kZSh1aWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBieXBhc3NFZGdlcy5mb3JFYWNoKGVkZ2UgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRFZGdlKGVkZ2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNvbnRleHQuZmx1c2goKTtcbiAgICB9XG5cbiAgICAvLyBDYWxsZWQgYnkgYSB0aWxlIHRvIGluZGljYXRlIHRoYXQgaXQgaXMgYmVpbmcgZHJhZ2dlZCwgYW5kIGFsbCBvZiBpdHMgY29ubmVjdGVkIGNvbXBvbmVudCBzaG91bGQgYWxzbyBiZSBkcmFnZ2VkXG4gICAgc3RhcnREcmFnQ0ModGlsZTogVmlkZW9Ob2RlVGlsZSwgcHRYOiBudW1iZXIsIHB0WTogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IHRpbGVJbmRleCA9IHRoaXMudGlsZXMudmVydGljZXMuaW5kZXhPZih0aWxlKTtcbiAgICAgICAgaWYgKHRpbGVJbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IFwiRHJhZ2dlZCB0aWxlIG5vdCBmb3VuZCBpbiBncmFwaFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gQXJyYXkuZnJvbSh0aGlzLnRpbGVzLnZlcnRpY2VzLmtleXMoKSkuZmlsdGVyKChpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGlsZXMudmVydGljZXNbaW5kZXhdLnNlbGVjdGVkIHx8IGluZGV4ID09IHRpbGVJbmRleDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGRyYWdDQztcbiAgICAgICAgZm9yIChjb25zdCBjYyBvZiB0aGlzLnRpbGVzLmNvbm5lY3RlZENvbXBvbmVudHMoc2VsZWN0aW9uKSkge1xuICAgICAgICAgICAgaWYgKGNjLnZlcnRpY2VzLmluZGV4T2YodGlsZUluZGV4KSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgZHJhZ0NDID0gY2M7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRyYWdDQyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBcIk5vIGNvbm5lY3RlZCBjb21wb25lbnQgY29udGFpbnMgdGhlIGNob3NlbiB0aWxlXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jdXJyZW50RHJhZ0NDID0gZHJhZ0NDO1xuXG4gICAgICAgIHRoaXMuY3VycmVudERyYWdDQy52ZXJ0aWNlcy5mb3JFYWNoKHZlcnRleCA9PiB7XG4gICAgICAgICAgICBpZiAodmVydGV4ICE9IHRpbGVJbmRleCkge1xuICAgICAgICAgICAgICAgIHRoaXMudGlsZXMudmVydGljZXNbdmVydGV4XS5jY0RyYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudGlsZXMudmVydGljZXNbdmVydGV4XS5zdGFydERyYWcocHRYLCBwdFkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gTWF5IHdhbnQgdG8gaG9sZCBvZmYgZ3JhcGggY2hhbmdlcyB1bnRpbCB0aGUgZHJhZyBpcyBjb21wbGV0ZS4uLlxuICAgIH1cblxuICAgIGRyYWdDQyhwdFg6IG51bWJlciwgcHRZOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy50aWxlcy52ZXJ0aWNlcy5mb3JFYWNoKHZlcnRleCA9PiB7XG4gICAgICAgICAgICBpZiAodmVydGV4LmNjRHJhZykge1xuICAgICAgICAgICAgICAgIHZlcnRleC5kcmFnKHB0WCwgcHRZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYWN0aXZhdGVEcm9wVGFyZ2V0KHB0WCwgcHRZKTtcbiAgICB9XG5cbiAgICBlbmREcmFnQ0MoKSB7XG4gICAgICAgIHRoaXMudGlsZXMudmVydGljZXMuZm9yRWFjaCh2ZXJ0ZXggPT4ge1xuICAgICAgICAgICAgaWYgKHZlcnRleC5jY0RyYWcpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXguZW5kRHJhZygpO1xuICAgICAgICAgICAgICAgIHZlcnRleC5jY0RyYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZHJvcCgpO1xuICAgIH1cblxuICAgIGFjdGl2YXRlRHJvcFRhcmdldChwdFg6IG51bWJlciwgcHRZOiBudW1iZXIpIHtcbiAgICAgICAgLy8gVGhlIGN1cnJlbnRseSBsaWZ0ZWQgdGlsZSBpcyB1c3VhbGx5IHRoZSB0b3Btb3N0IGVsZW1lbnQgYXQgdGhpcyBwb2ludFxuICAgICAgICAvLyBzbyB3ZSBzY2FuIGRvd24gdGhlIGxpc3QgdW50aWwgd2UgZmluZCB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IGlzIG5vdCBhIHRpbGVcbiAgICAgICAgLy8gKHdoaWNoIHdpbGwgYmUgYSBkcm9wIHRhcmdldCBpZiB3ZSBhcmUgb3ZlciBvbmUpXG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQuZWxlbWVudHNGcm9tUG9pbnQocHRYLCBwdFkpO1xuICAgICAgICBsZXQgZWxlbWVudDtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIGVsZW1lbnRzKSB7XG4gICAgICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgVmlkZW9Ob2RlVGlsZSkpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFjdGl2ZURyb3BUYXJnZXRJbmRleCA9ICg8RWxlbWVudFtdPnRoaXMuZHJvcFRhcmdldHMpLmluZGV4T2YoZWxlbWVudCk7XG4gICAgICAgIHRoaXMuZHJvcFRhcmdldHMuZm9yRWFjaCgoZHQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBkdC5hY3RpdmUgPSAoaW5kZXggPT0gYWN0aXZlRHJvcFRhcmdldEluZGV4KTtcbiAgICAgICAgICAgIGR0LmRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZHJvcCgpIHtcbiAgICAgICAgbGV0IGFjdGl2ZURyb3BUYXJnZXQ6IERyb3BUYXJnZXQ7XG4gICAgICAgIHRoaXMuZHJvcFRhcmdldHMuZm9yRWFjaCgoZHQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAoZHQuYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRHJvcFRhcmdldCA9IGR0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZHQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBkdC5kcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoYWN0aXZlRHJvcFRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47IC8vIFRpbGVzIHdlcmUgbm90IG1vdmVkIGFueXdoZXJlXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdWlkc1RvTW92ZTogbnVtYmVyW10gPSBbXTtcbiAgICAgICAgdGhpcy5jdXJyZW50RHJhZ0NDLnZlcnRpY2VzLmZvckVhY2godGlsZUluZGV4ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHVpZCA9IHRoaXMudGlsZXMudmVydGljZXNbdGlsZUluZGV4XS51aWQ7XG4gICAgICAgICAgICBpZiAodWlkc1RvTW92ZS5pbmRleE9mKHVpZCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgdWlkc1RvTW92ZS5wdXNoKHVpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IEFycmF5LmZyb20odGhpcy5ub2Rlcy52ZXJ0aWNlcy5rZXlzKCkpLmZpbHRlcigoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB1aWRzVG9Nb3ZlLmluZGV4T2YodGhpcy5ub2Rlcy52ZXJ0aWNlc1tpbmRleF0pID49IDA7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjY3MgPSB0aGlzLm5vZGVzLmNvbm5lY3RlZENvbXBvbmVudHMoc2VsZWN0aW9uKTtcblxuICAgICAgICBpZiAoY2NzLmxlbmd0aCAhPSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkNvbnZlcnNpb24gb2YgQ0MgaW4gdGlsZXNwYWNlIHRvIG5vZGVzcGFjZSByZXN1bHRlZCBpbiBtb3JlIHRoYW4gb25lIENDXCI7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYyA9IGNjc1swXTtcblxuICAgICAgICAvLyBTZWUgaWYgdGhlIGVkZ2Ugd2UgZHJvcHBlZCBvbiBpcyBpbiB0aGUgQ0NcbiAgICAgICAgZm9yIChsZXQgdiBvZiBjYy52ZXJ0aWNlcykge1xuICAgICAgICAgICAgY29uc3QgdWlkID0gdGhpcy5ub2Rlcy52ZXJ0aWNlc1t2XTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVEcm9wVGFyZ2V0LmZyb21VSUQgPT0gdWlkIHx8IGFjdGl2ZURyb3BUYXJnZXQudG9VSUQgPT0gdWlkKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2FuJ3QgZHJvcCBvbnRvIGFuIGVkZ2UgdGhhdCBpcyBwYXJ0IG9mIHRoZSBDQ1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuJ3QgZHJvcCBvbnRvIGFuIGVkZ2UgdGhhdCBpcyBwYXJ0IG9mIHRoZSBsaWZ0ZWQgQ0NcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGluY29taW5nIGFuZCBvdXRnb2luZyBlZGdlc1xuICAgICAgICBjYy5pbnB1dEVkZ2VzLmZvckVhY2goZWRnZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUVkZ2VCeUluZGV4KGVkZ2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgY2Mub3V0cHV0RWRnZXMuZm9yRWFjaChlZGdlID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRWRnZUJ5SW5kZXgoZWRnZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNlZSBpZiB0aGUgZWRnZSB3ZSBkcm9wcGVkIG9uIGlzIGluIHRoZSBncmFwaFxuICAgICAgICAvL2xldCBkcm9wRUk7XG4gICAgICAgIC8vZm9yIChsZXQgZWkgPSAwOyBlaSA8IHRoaXMubm9kZXMuZWRnZXMubGVuZ3RoOyBlaSsrKSB7XG4gICAgICAgIC8vICAgIGNvbnN0IGVkZ2UgPSB0aGlzLm5vZGVzLmVkZ2VzW2VpXTtcbiAgICAgICAgLy8gICAgY29uc3QgZnJvbVVJRCA9IHRoaXMubm9kZXMudmVydGljZXNbZWRnZS5mcm9tVmVydGV4XTtcbiAgICAgICAgLy8gICAgY29uc3QgdG9VSUQgPSB0aGlzLm5vZGVzLnZlcnRpY2VzW2VkZ2UudG9WZXJ0ZXhdO1xuICAgICAgICAvLyAgICBpZiAoZnJvbVVJRCA9PSBhY3RpdmVEcm9wVGFyZ2V0LmZyb21VSUQgJiYgdG9VSUQgPT0gYWN0aXZlRHJvcFRhcmdldC50b1VJRCAmJiBlZGdlLnRvSW5wdXQgPT0gYWN0aXZlRHJvcFRhcmdldC50b0lucHV0KSB7XG4gICAgICAgIC8vICAgICAgICBkcm9wRUkgPSBlaTtcbiAgICAgICAgLy8gICAgICAgIGJyZWFrO1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuXG4gICAgICAgIC8vIFRyeSB0byByZW1vdmUgdGhlIGVkZ2Ugd2UgZHJvcHBlZCBvbnRvIChzaG91bGQgZXhpc3QsIGJ1dCBtaWdodCBub3Q/PyBzZWUgYWJvdmUgY29kZSlcbiAgICAgICAgaWYgKGFjdGl2ZURyb3BUYXJnZXQuZnJvbVVJRCAhPT0gbnVsbCAmJiBhY3RpdmVEcm9wVGFyZ2V0LnRvVUlEICE9PSBudWxsICYmIGFjdGl2ZURyb3BUYXJnZXQudG9JbnB1dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnJlbW92ZUVkZ2UoYWN0aXZlRHJvcFRhcmdldC5mcm9tVUlELCBhY3RpdmVEcm9wVGFyZ2V0LnRvVUlELCBhY3RpdmVEcm9wVGFyZ2V0LnRvSW5wdXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGluIGVkZ2VzIG5lY2Vzc2FyeSB0byBieXBhc3MgdGhlIGxpZnRlZCBDQ1xuICAgICAgICB0aGlzLm5vZGVzLmJ5cGFzc0VkZ2VzKGNjKS5mb3JFYWNoKGVkZ2UgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRFZGdlKGVkZ2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgZWRnZSBmcm9tIG1vZGVsIGludG8gQ0NcbiAgICAgICAgaWYgKGFjdGl2ZURyb3BUYXJnZXQuZnJvbVVJRCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gV2UgZG8gdGhpcyB0byB0aGUgdG9wbW9zdCBkaXNjb25uZWN0ZWQgaW5wdXQgb24gdGhlIENDXG4gICAgICAgICAgICBsZXQgbGVhZk5vZGUgPSBjYy5yb290VmVydGV4O1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250ZXh0Lm5vZGVTdGF0ZSh0aGlzLm5vZGVzLnZlcnRpY2VzW2xlYWZOb2RlXSwgXCJhbGxcIikubklucHV0cyA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHRvcG1vc3Qgc2VxdWVuY2Ugb2Ygbm9kZXMgZW5kcyB3aXRoIGEgemVyby1pbnB1dCBub2RlLiBHaXZlIHVwLlxuICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gVE9ETzogZG8gYSBtb3JlIGVsYWJvcmF0ZSBERlMgdG8gZmluZCBhIHZhbGlkIGlucHV0LlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gdGhpcy5ub2Rlcy51cHN0cmVhbVZlcnRleEluZGV4KGxlYWZOb2RlLCAwKTtcbiAgICAgICAgICAgICAgICBpZiAobmV4dCA9PT0gdW5kZWZpbmVkIHx8IGNjLnZlcnRpY2VzLmluZGV4T2YobmV4dCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSB0aGlzLm5vZGVzLmVkZ2VzW2NjLmlucHV0RWRnZXNbMF1dO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuYWRkRWRnZShhY3RpdmVEcm9wVGFyZ2V0LmZyb21VSUQsIHRoaXMubm9kZXMudmVydGljZXNbbGVhZk5vZGVdLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxlYWZOb2RlID0gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBlZGdlIGZyb20gQ0MgYmFjayB0byBtb2RlbFxuICAgICAgICBpZiAoYWN0aXZlRHJvcFRhcmdldC50b1VJRCAhPT0gbnVsbCAmJiBhY3RpdmVEcm9wVGFyZ2V0LnRvSW5wdXQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IGZyb21VSUQgPSB0aGlzLm5vZGVzLnZlcnRpY2VzW2NjLnJvb3RWZXJ0ZXhdO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmFkZEVkZ2UoZnJvbVVJRCwgYWN0aXZlRHJvcFRhcmdldC50b1VJRCwgYWN0aXZlRHJvcFRhcmdldC50b0lucHV0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29udGV4dC5mbHVzaCgpO1xuICAgIH1cblxuICAgIHNlbGVjdEJldHdlZW4odGlsZTE6IFZpZGVvTm9kZVRpbGUsIHRpbGUyOiBWaWRlb05vZGVUaWxlKSB7XG4gICAgICAgIGNvbnN0IGluZGV4MSA9IHRoaXMudGlsZXMudmVydGljZXMuaW5kZXhPZih0aWxlMSk7XG4gICAgICAgIGNvbnN0IGluZGV4MiA9IHRoaXMudGlsZXMudmVydGljZXMuaW5kZXhPZih0aWxlMik7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiU2VsZWN0IGJldHdlZW5cIiwgaW5kZXgxLCBpbmRleDIpO1xuICAgICAgICBpZiAoaW5kZXgxID49IDAgJiYgaW5kZXgyID49IDApIHtcbiAgICAgICAgICAgIHRoaXMudGlsZXMudmVydGljZXNCZXR3ZWVuKGluZGV4MSwgaW5kZXgyKS5mb3JFYWNoKHRpbGVJbmRleCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50aWxlcy52ZXJ0aWNlc1t0aWxlSW5kZXhdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gT25lIG9yIGJvdGggb2YgdGhlIHRpbGVzIGlzIG5vdCBwcmVzZW50LlxuICAgICAgICAgICAgLy8gU2VsZWN0IHRoZSBvdGhlciBvbmUgKG5vIGhhcm0gb24gY2FsbGluZyB0aGlzIG9uIGRlbGV0ZWQgdGlsZXMpXG4gICAgICAgICAgICB0aWxlMS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB0aWxlMi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGROb2RlKG5vZGVTdGF0ZTogb2JqZWN0KSB7XG4gICAgICAgIGNvbnN0IHVpZCA9IHRoaXMuY29udGV4dC5hZGROb2RlKG5vZGVTdGF0ZSk7XG4gICAgICAgIGlmICh1aWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBhZGRpbmcgbm9kZVwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluc2VydCBhZnRlciBsYXN0IGNsaWNrZWQgdGlsZVxuICAgICAgICBsZXQgbm9kZVZlcnRleEluZGV4ID0gLTE7XG4gICAgICAgIGlmICh0aGlzLmxhc3RUaWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5vZGVWZXJ0ZXhJbmRleCA9IHRoaXMubm9kZXMudmVydGljZXMuaW5kZXhPZih0aGlzLmxhc3RUaWxlLnVpZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGVWZXJ0ZXhJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlZGdlc1RvUmVtb3ZlID0gdGhpcy5ub2Rlcy5kb3duc3RyZWFtRWRnZXNbbm9kZVZlcnRleEluZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IGVkZ2VzVG9BZGQgPSBlZGdlc1RvUmVtb3ZlLm1hcChlZGdlSW5kZXggPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21VSUQ6IHVpZCxcbiAgICAgICAgICAgICAgICAgICAgdG9VSUQ6IHRoaXMubm9kZXMudmVydGljZXNbdGhpcy5ub2Rlcy5lZGdlc1tlZGdlSW5kZXhdLnRvVmVydGV4XSxcbiAgICAgICAgICAgICAgICAgICAgdG9JbnB1dDogdGhpcy5ub2Rlcy5lZGdlc1tlZGdlSW5kZXhdLnRvSW5wdXQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZWRnZXNUb0FkZC5wdXNoKHtcbiAgICAgICAgICAgICAgICBmcm9tVUlEOiB0aGlzLm5vZGVzLnZlcnRpY2VzW25vZGVWZXJ0ZXhJbmRleF0sXG4gICAgICAgICAgICAgICAgdG9VSUQ6IHVpZCxcbiAgICAgICAgICAgICAgICB0b0lucHV0OiAwLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVkZ2VzVG9SZW1vdmUuZm9yRWFjaChlZGdlSW5kZXggPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRWRnZUJ5SW5kZXgoZWRnZUluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZWRnZXNUb0FkZC5mb3JFYWNoKGVkZ2UgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5hZGRFZGdlKGVkZ2UuZnJvbVVJRCwgZWRnZS50b1VJRCwgZWRnZS50b0lucHV0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIExhc3QgaW50ZXJhY3RlZCB0aWxlIHdhcyBkZWxldGVkLCBpZiA8IDAuIEFkZCBhcyBvcnBoYW4gaW4gdGhhdCBjYXNlLlxuXG4gICAgICAgIHRoaXMuc2VsZWN0VUlEID0gdWlkO1xuICAgICAgICB0aGlzLmNvbnRleHQuZmx1c2goKTtcbiAgICB9XG5cbiAgICBhZGp1c3RTZWxlY3RlZChkZXRhaWw6IEFkanVzdEV2ZW50RGV0YWlsKSB7XG4gICAgICAgIGNvbnN0IG5ld0V2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KFwiYWRqdXN0XCIsIHtkZXRhaWw6IGRldGFpbH0pXG4gICAgICAgIHRoaXMudGlsZXMudmVydGljZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgICAgIGlmICh0aWxlLnNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGlsZS5kaXNwYXRjaEV2ZW50KG5ld0V2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25TY3JvbGwoZXZlbnQ6IFdoZWVsRXZlbnQpIHtcbiAgICAgICAgdGhpcy5hZGp1c3RTZWxlY3RlZCh7Y29udHJvbDogMCwgYW1vdW50UmVsYXRpdmU6IGV2ZW50LmRlbHRhWSAqIC0wLjAwMDN9KTtcbiAgICB9XG59XG5cbmN1c3RvbUVsZW1lbnRzLmRlZmluZSgncmFkaWFuY2UtdmlkZW9ub2RldGlsZScsIFZpZGVvTm9kZVRpbGUpO1xuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS12aWRlb25vZGVwcmV2aWV3JywgVmlkZW9Ob2RlUHJldmlldyk7XG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ3JhZGlhbmNlLWdyYXBoJywgR3JhcGgpO1xuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS1kcm9wdGFyZ2V0JywgRHJvcFRhcmdldCk7XG4iLCJleHBvcnQgY2xhc3MgRmxpY2thYmxlIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgIG91dGVyOiBIVE1MRWxlbWVudDsgLy8gT3V0ZXIgZGl2IChmb3IgY2xpcHBpbmcgYW5kIG1vdXNlIGV2ZW50cylcbiAgICBpbm5lcjogSFRNTEVsZW1lbnQ7IC8vIElubmVyIGRpdiAodGhlIG9uZSB0aGF0IGlzIHRyYW5zZm9ybWVkKVxuICAgIG9mZnNldFg6IG51bWJlcjsgLy8gQ3VycmVudCBYIG9mZnNldCBvZiB0aGUgc3VyZmFjZVxuICAgIG9mZnNldFk6IG51bWJlcjsgLy8gQ3VycmVudCBZIG9mZnNldCBvZiB0aGUgc3VyZmFjZVxuICAgIGRyYWdnaW5nOiBib29sZWFuOyAvLyBXaGV0aGVyIG9yIG5vdCB0aGUgc3VyZmFjZSBpcyBiZWluZyBkcmFnZ2VkXG4gICAgbW91c2VEcmFnOiBib29sZWFuOyAvLyBXaGV0aGVyIG9yIG5vdCB0aGUgc3VyZmFjZSBpcyBiZWluZyBkcmFnZ2VkIGR1ZSB0byB0aGUgbW91c2VcbiAgICB0b3VjaERyYWc6IGJvb2xlYW47IC8vIFdoZXRoZXIgb3Igbm90IHRoZSBzdXJmYWNlIGlzIGJlaW5nIGRyYWdnZWQgZHVlIHRvIGEgdG91Y2hcbiAgICBzdGFydERyYWdYOiBudW1iZXI7IC8vIFggY29vcmRpbmF0ZSBvZiB0aGUgc3RhcnQgb2YgdGhlIGRyYWdcbiAgICBzdGFydERyYWdZOiBudW1iZXI7IC8vIFkgY29vcmRpbmF0ZSBvZiB0aGUgc3RhcnQgb2YgdGhlIGRyYWdcbiAgICBzdGFydERyYWdPZmZzZXRYOiBudW1iZXI7IC8vIFRoZSB2YWx1ZSBvZiBvZmZzZXRYIHdoZW4gdGhlIGRyYWcgc3RhcnRzXG4gICAgc3RhcnREcmFnT2Zmc2V0WTogbnVtYmVyOyAvLyBUaGUgdmFsdWUgb2Ygb2Zmc2V0WSB3aGVuIHRoZSBkcmFnIHN0YXJ0c1xuICAgIHRvdWNoSWQ7IC8vIFRoZSBpZGVudGlmaWVyIG9mIHRoZSB0b3VjaGV2ZW50IGNhdXNpbmcgdGhlIGRyYWdcbiAgICByZXNpemVPYnNlcnZlcjogUmVzaXplT2JzZXJ2ZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgY29uc3Qgc2hhZG93ID0gdGhpcy5hdHRhY2hTaGFkb3coe21vZGU6ICdvcGVuJ30pO1xuICAgICAgICBzaGFkb3cuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgOmhvc3Qge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNvdXRlciB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNpbm5lciB7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAzMHB4IHNvbGlkIHRyYW5zcGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9zdHlsZT4gXG4gICAgICAgICAgICA8ZGl2IGlkPSdvdXRlcic+XG4gICAgICAgICAgICAgICAgPGRpdiBpZD0naW5uZXInPlxuICAgICAgICAgICAgICAgICAgICA8c2xvdD48L3Nsb3Q+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICAgICAgdGhpcy5pbm5lciA9IHNoYWRvdy5xdWVyeVNlbGVjdG9yKFwiI2lubmVyXCIpO1xuICAgICAgICB0aGlzLm91dGVyID0gc2hhZG93LnF1ZXJ5U2VsZWN0b3IoXCIjb3V0ZXJcIik7XG4gICAgICAgIHRoaXMub3V0ZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5tb3VzZURvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm1vdXNlVXAuYmluZCh0aGlzKSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW91c2VNb3ZlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLm91dGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLnRvdWNoU3RhcnQuYmluZCh0aGlzKSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLnRvdWNoRW5kLmJpbmQodGhpcykpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNoTW92ZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKGVudHJpZXMgPT4ge1xuICAgICAgICAgICAgdGhpcy5hcHBseVRyYW5zZm9ybWF0aW9uKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLm9ic2VydmUodGhpcy5vdXRlcik7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmlubmVyKTtcblxuICAgICAgICB0aGlzLm9mZnNldFggPSAwO1xuICAgICAgICB0aGlzLm9mZnNldFkgPSAwO1xuICAgIH1cblxuICAgIGFwcGx5VHJhbnNmb3JtYXRpb24oKSB7XG4gICAgICAgIGxldCByYW5nZVggPSAwLjUgKiBNYXRoLm1heCgwLCB0aGlzLmlubmVyLm9mZnNldFdpZHRoIC0gdGhpcy5vdXRlci5jbGllbnRXaWR0aCk7XG4gICAgICAgIGxldCByYW5nZVkgPSAwLjUgKiBNYXRoLm1heCgwLCB0aGlzLmlubmVyLm9mZnNldEhlaWdodCAtIHRoaXMub3V0ZXIuY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMub2Zmc2V0WCkgPiByYW5nZVgpIHtcbiAgICAgICAgICAgIHRoaXMub2Zmc2V0WCA9IHJhbmdlWCAqIE1hdGguc2lnbih0aGlzLm9mZnNldFgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChNYXRoLmFicyh0aGlzLm9mZnNldFkpID4gcmFuZ2VZKSB7XG4gICAgICAgICAgICB0aGlzLm9mZnNldFkgPSByYW5nZVkgKiBNYXRoLnNpZ24odGhpcy5vZmZzZXRZKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlubmVyLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLm9mZnNldFh9cHgsICR7dGhpcy5vZmZzZXRZfXB4KWA7XG4gICAgfVxuXG4gICAgdG91Y2hTdGFydChldmVudDogVG91Y2hFdmVudCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5pdGVtKGkpO1xuICAgICAgICAgICAgaWYgKHRvdWNoLnRhcmdldCAhPSB0aGlzLm91dGVyICYmIHRvdWNoLnRhcmdldCAhPSB0aGlzLmlubmVyKSB7XG4gICAgICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgY2xpY2tzIG9udG8gdGhpcyBzdXJmYWNlLCBub3QgaXRzIGNoaWxkIChpbm5lcilcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5kcmFnZ2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMudG91Y2hEcmFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdWNoSWQgPSB0b3VjaC5pZGVudGlmaWVyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydERyYWcodG91Y2gucGFnZVgsIHRvdWNoLnBhZ2VZKTtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW91c2VEb3duKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50YXJnZXQgIT0gdGhpcy5vdXRlciAmJiBldmVudC50YXJnZXQgIT0gdGhpcy5pbm5lcikge1xuICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgY2xpY2tzIG9udG8gdGhpcyBzdXJmYWNlLCBub3QgaXRzIGNoaWxkIChpbm5lcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuZHJhZ2dpbmcgJiYgKGV2ZW50LmJ1dHRvbnMgJiAxKSkge1xuICAgICAgICAgICAgdGhpcy5tb3VzZURyYWcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zdGFydERyYWcoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b3VjaEVuZChldmVudDogVG91Y2hFdmVudCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5pdGVtKGkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy50b3VjaERyYWcgJiYgdGhpcy50b3VjaElkID09IHRvdWNoLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdWNoRHJhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuZW5kRHJhZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW91c2VVcChldmVudDogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZyAmJiB0aGlzLm1vdXNlRHJhZyAmJiAhKGV2ZW50LmJ1dHRvbnMgJiAxKSkge1xuICAgICAgICAgICAgdGhpcy5tb3VzZURyYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZW5kRHJhZygpO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRvdWNoTW92ZShldmVudDogVG91Y2hFdmVudCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5pdGVtKGkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy50b3VjaERyYWcgJiYgdGhpcy50b3VjaElkID09IHRvdWNoLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcodG91Y2gucGFnZVgsIHRvdWNoLnBhZ2VZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdXNlTW92ZShldmVudDogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnZ2luZyAmJiB0aGlzLm1vdXNlRHJhZykge1xuICAgICAgICAgICAgdGhpcy5kcmFnKGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RhcnREcmFnKHB0WDogbnVtYmVyLCBwdFk6IG51bWJlcikge1xuICAgICAgICB0aGlzLmRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdGFydERyYWdYID0gcHRYO1xuICAgICAgICB0aGlzLnN0YXJ0RHJhZ1kgPSBwdFk7XG4gICAgICAgIHRoaXMuc3RhcnREcmFnT2Zmc2V0WCA9IHRoaXMub2Zmc2V0WDtcbiAgICAgICAgdGhpcy5zdGFydERyYWdPZmZzZXRZID0gdGhpcy5vZmZzZXRZO1xuICAgIH1cblxuICAgIGVuZERyYWcoKSB7XG4gICAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBkcmFnKHB0WDogbnVtYmVyLCBwdFk6IG51bWJlcikge1xuICAgICAgICB0aGlzLm9mZnNldFggPSB0aGlzLnN0YXJ0RHJhZ09mZnNldFggKyBwdFggLSB0aGlzLnN0YXJ0RHJhZ1g7XG4gICAgICAgIHRoaXMub2Zmc2V0WSA9IHRoaXMuc3RhcnREcmFnT2Zmc2V0WSArIHB0WSAtIHRoaXMuc3RhcnREcmFnWTtcbiAgICAgICAgdGhpcy5hcHBseVRyYW5zZm9ybWF0aW9uKCk7XG4gICAgfVxufVxuXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ3JhZGlhbmNlLWZsaWNrYWJsZScsIEZsaWNrYWJsZSk7XG4iLCJpbXBvcnQge1ZpZGVvTm9kZVRpbGUsIEFkanVzdEV2ZW50RGV0YWlsfSBmcm9tIFwiLi9ncmFwaFwiO1xuXG5jbGFzcyBFZmZlY3ROb2RlVGlsZSBleHRlbmRzIFZpZGVvTm9kZVRpbGUge1xuICAgIGludGVuc2l0eVNsaWRlcjogSFRNTElucHV0RWxlbWVudDtcbiAgICB0aXRsZURpdjogSFRNTERpdkVsZW1lbnQ7XG4gICAgaW50ZW5zaXR5U2xpZGVyQmxvY2tlZDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm5JbnB1dHMgPSAwO1xuICAgICAgICB0aGlzLmludGVuc2l0eVNsaWRlckJsb2NrZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcblxuICAgICAgICB0aGlzLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAgICAgICBociwgZGl2IHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogc2Fucy1zZXJpZjtcIiBpZD1cInRpdGxlXCI+PC9kaXY+XG4gICAgICAgICAgICA8aHIgc3R5bGU9XCJtYXJnaW46IDNweDsgd2lkdGg6IDgwJTtcIj48L2hyPlxuICAgICAgICAgICAgPHJhZGlhbmNlLXZpZGVvbm9kZXByZXZpZXcgc3R5bGU9XCJmbGV4OiAxIDEgYXV0bztcIiBpZD1cInByZXZpZXdcIj48L3JhZGlhbmNlLXZpZGVvbm9kZXByZXZpZXc+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgbWluPVwiMFwiIG1heD1cIjFcIiBzdGVwPVwiMC4wMVwiIGlkPVwiaW50ZW5zaXR5U2xpZGVyXCI+PC9pbnB1dD5cbiAgICAgICAgYDtcbiAgICAgICAgdGhpcy5wcmV2aWV3ID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXdcIik7XG4gICAgICAgIHRoaXMuaW50ZW5zaXR5U2xpZGVyID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiI2ludGVuc2l0eVNsaWRlclwiKTtcbiAgICAgICAgdGhpcy50aXRsZURpdiA9IHRoaXMucXVlcnlTZWxlY3RvcihcIiN0aXRsZVwiKTtcbiAgICAgICAgdGhpcy5pbnRlbnNpdHlTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIHRoaXMuaW50ZW5zaXR5U2xpZGVyQ2hhbmdlZC5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoXCJhZGp1c3RcIiwgdGhpcy5vbkFkanVzdC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICB1cGRhdGVGcm9tU3RhdGUoZGF0YTogYW55KSB7XG4gICAgICAgIHN1cGVyLnVwZGF0ZUZyb21TdGF0ZShkYXRhKTtcbiAgICAgICAgaWYgKFwiaW50ZW5zaXR5XCIgaW4gZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5pbnRlbnNpdHlTbGlkZXJCbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaW50ZW5zaXR5U2xpZGVyLnZhbHVlID0gZGF0YS5pbnRlbnNpdHk7XG4gICAgICAgICAgICB0aGlzLmludGVuc2l0eVNsaWRlckJsb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcIm5hbWVcIiBpbiBkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRGl2LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW50ZW5zaXR5U2xpZGVyQ2hhbmdlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW50ZW5zaXR5U2xpZGVyQmxvY2tlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld0ludGVuc2l0eSA9IHBhcnNlRmxvYXQodGhpcy5pbnRlbnNpdHlTbGlkZXIudmFsdWUpO1xuICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLmdyYXBoLmNvbnRleHQubm9kZVN0YXRlKHRoaXMudWlkLCBcImxvY2FsXCIpOyAvLyBYWFggYmFja2VuZCBjYW4gZG8gc3BhcnNlIHVwZGF0ZXM/XG4gICAgICAgIHN0YXRlLmludGVuc2l0eSA9IG5ld0ludGVuc2l0eTtcbiAgICAgICAgdGhpcy5ncmFwaC5jb250ZXh0LnNldE5vZGVTdGF0ZSh0aGlzLnVpZCwgc3RhdGUpO1xuICAgIH1cblxuICAgIG9uQWRqdXN0KGV2ZW50OiBDdXN0b21FdmVudCkge1xuICAgICAgICBjb25zdCBkZXRhaWw6IEFkanVzdEV2ZW50RGV0YWlsID0gZXZlbnQuZGV0YWlsO1xuICAgICAgICB0aGlzLmludGVuc2l0eVNsaWRlci52YWx1ZSA9IChwYXJzZUZsb2F0KHRoaXMuaW50ZW5zaXR5U2xpZGVyLnZhbHVlKSArIGRldGFpbC5hbW91bnRSZWxhdGl2ZSkudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5pbnRlbnNpdHlTbGlkZXJDaGFuZ2VkKCk7XG4gICAgfVxufVxuXG5jbGFzcyBNZWRpYU5vZGVUaWxlIGV4dGVuZHMgVmlkZW9Ob2RlVGlsZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubklucHV0cyA9IDE7XG4gICAgfVxuXG4gICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7XG5cbiAgICAgICAgdGhpcy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7XCIgaWQ9XCJ0aXRsZVwiPk1lZGlhPC9kaXY+XG4gICAgICAgICAgICA8aHIgc3R5bGU9XCJtYXJnaW46IDNweDsgd2lkdGg6IDgwJTtcIj48L2hyPlxuICAgICAgICAgICAgPHJhZGlhbmNlLXZpZGVvbm9kZXByZXZpZXcgc3R5bGU9XCJmbGV4OiAxIDEgYXV0bztcIiBpZD1cInByZXZpZXdcIj48L3JhZGlhbmNlLXZpZGVvbm9kZXByZXZpZXc+XG4gICAgICAgIGA7XG4gICAgICAgIHRoaXMucHJldmlldyA9IHRoaXMucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3XCIpO1xuICAgIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS1lZmZlY3Rub2RldGlsZScsIEVmZmVjdE5vZGVUaWxlKTtcbmN1c3RvbUVsZW1lbnRzLmRlZmluZSgncmFkaWFuY2UtbWVkaWFub2RldGlsZScsIE1lZGlhTm9kZVRpbGUpO1xuIiwiaW1wb3J0IHtDb250ZXh0fSBmcm9tIFwiLi4vcGtnL2luZGV4LmpzXCI7XG5pbXBvcnQge0dyYXBofSBmcm9tIFwiLi9ncmFwaFwiO1xuXG5leHBvcnQgY2xhc3MgTGlicmFyeSBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgICBub2RlTmFtZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGxpc3Q6IEhUTUxEaXZFbGVtZW50O1xuICAgIGdyYXBoOiBHcmFwaDtcbiAgICBjb250ZXh0OiBDb250ZXh0O1xuICAgIGxpYnJhcnk6IG9iamVjdDtcbiAgICBiZXN0TWF0Y2g6IHN0cmluZztcblxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBjb25zdCBzaGFkb3cgPSB0aGlzLmF0dGFjaFNoYWRvdyh7bW9kZTogJ29wZW4nfSk7XG4gICAgICAgIHNoYWRvdy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgICA6aG9zdCB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAjbGlzdCB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMTBweDtcbiAgICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuIHNjcm9sbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgI25vZGVOYW1lIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgICA8ZGl2IGlkPVwibGlzdFwiIHdpZHRoPjwvZGl2PlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJub2RlTmFtZVwiPjwvaW5wdXQ+XG4gICAgICAgIGA7XG4gICAgICAgIHRoaXMubm9kZU5hbWVJbnB1dCA9IHNoYWRvdy5xdWVyeVNlbGVjdG9yKFwiI25vZGVOYW1lXCIpO1xuICAgICAgICB0aGlzLmxpc3QgPSBzaGFkb3cucXVlcnlTZWxlY3RvcihcIiNsaXN0XCIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHRoaXMub25LZXlQcmVzcy5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5ub2RlTmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uVGV4dEJveEtleVByZXNzLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLm5vZGVOYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLm9uVGV4dEJveElucHV0LmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGF0dGFjaEdyYXBoKGdyYXBoOiBHcmFwaCkge1xuICAgICAgICBpZiAodGhpcy5ncmFwaCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkNhbm5vdCBjYWxsIGF0dGFjaEdyYXBoIG1vcmUgdGhhbiBvbmNlIVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ncmFwaCA9IGdyYXBoO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBncmFwaC5jb250ZXh0O1xuICAgICAgICB0aGlzLmNvbnRleHQub25MaWJyYXJ5Q2hhbmdlZCh0aGlzLmxpYnJhcnlDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmxpYnJhcnlDaGFuZ2VkKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyTGlicmFyeSgpIHtcbiAgICAgICAgY29uc3QgZmlsdGVyVGV4dCA9IHRoaXMubm9kZU5hbWVJbnB1dC52YWx1ZTtcblxuICAgICAgICBsZXQgZmlsdGVyZWRMaWJyYXJ5O1xuICAgICAgICBpZiAoZmlsdGVyVGV4dCA9PSBcIlwiKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZExpYnJhcnkgPSB0aGlzLmxpYnJhcnk7XG4gICAgICAgICAgICB0aGlzLmJlc3RNYXRjaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbHRlcmVkTGlicmFyeSA9IHt9O1xuICAgICAgICAgICAgZm9yIChjb25zdCBrIGluIHRoaXMubGlicmFyeSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmxpYnJhcnlba107XG4gICAgICAgICAgICAgICAgaWYgKFwibmFtZVwiIGluIGl0ZW0gJiYgaXRlbS5uYW1lLnN0YXJ0c1dpdGgoZmlsdGVyVGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRMaWJyYXJ5W2tdID0gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmJlc3RNYXRjaCA9IE9iamVjdC5rZXlzKGZpbHRlcmVkTGlicmFyeSlbMF07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ1bFwiKTtcbiAgICAgICAgdGhpcy5saXN0LmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAgIHRoaXMubGlzdC5hcHBlbmRDaGlsZCh1bCk7XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBpbiBmaWx0ZXJlZExpYnJhcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuICAgICAgICAgICAgbGkudGV4dENvbnRlbnQgPSBmaWx0ZXJlZExpYnJhcnlbaXRlbV0ubmFtZTtcbiAgICAgICAgICAgIGxpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBldmVudCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0YW50aWF0ZUZyb21MaWJyYXJ5KGl0ZW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9uZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsaWJyYXJ5Q2hhbmdlZCgpIHtcbiAgICAgICAgdGhpcy5saWJyYXJ5ID0gdGhpcy5jb250ZXh0LmxpYnJhcnkoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJMaWJyYXJ5KCk7XG4gICAgfVxuXG4gICAgaW5zdGFudGlhdGVGcm9tTGlicmFyeShpdGVtOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JhcGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5ncmFwaC5hZGROb2RlKHRoaXMubGlicmFyeVtpdGVtXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbktleVByZXNzKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5jb2RlID09IFwiU2VtaWNvbG9uXCIgJiYgZXZlbnQuc2hpZnRLZXkgJiYgZXZlbnQudGFyZ2V0ICE9IHRoaXMpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZU5hbWVJbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uVGV4dEJveElucHV0KGV2ZW50OiBJbnB1dEV2ZW50KSB7XG4gICAgICAgIHRoaXMucmVuZGVyTGlicmFyeSgpO1xuICAgIH1cblxuICAgIGRvbmUoKSB7XG4gICAgICAgIHRoaXMubm9kZU5hbWVJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMucmVuZGVyTGlicmFyeSgpO1xuICAgICAgICB0aGlzLmJsdXIoKTtcbiAgICB9XG5cbiAgICBvblRleHRCb3hLZXlQcmVzcyhldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQuY29kZSA9PSBcIkVudGVyXCIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmJlc3RNYXRjaCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0YW50aWF0ZUZyb21MaWJyYXJ5KHRoaXMuYmVzdE1hdGNoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZG9uZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmRvbmUoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS1saWJyYXJ5JywgTGlicmFyeSk7XG4iLCJleHBvcnQgY2xhc3MgRHJhd2VyIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgIF9jbG9zZWQ6IGJvb2xlYW47XG4gICAgaGFuZGxlOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLl9jbG9zZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgY29uc3Qgc2hhZG93ID0gdGhpcy5hdHRhY2hTaGFkb3coe21vZGU6ICdvcGVuJ30pO1xuICAgICAgICBzaGFkb3cuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgOmhvc3Qge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAjb3V0ZXIge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBzdGF0aWM7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgICAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjVzO1xuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzMzMzMzM0VFOyAvKiBUT0RPIGV4cG9zZSB0aGlzIG91dHNpZGUgb2YgdGhpcyBlbGVtZW50ICovXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICNpbm5lciB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC41cztcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDMwcHg7XG4gICAgICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgI2hhbmRsZSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICAgIHJpZ2h0OiAwcHg7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDIwcHg7XG4gICAgICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgICAgICAgICAgYm90dG9tOiAwcHg7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDpob3N0KFtjbG9zZWRdKSAjb3V0ZXIge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKGNhbGMoLTEwMCUgKyAxMHB4KSwgMHB4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgICA8ZGl2IGlkPVwib3V0ZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiaW5uZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNsb3Q+PC9zbG90PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJoYW5kbGVcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgdGhpcy5oYW5kbGUgPSBzaGFkb3cucXVlcnlTZWxlY3RvcihcIiNoYW5kbGVcIik7XG4gICAgICAgIHRoaXMuaGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNsaWNrLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuX2Nsb3NlZCA9IHRoaXMuaGFzQXR0cmlidXRlKFwiY2xvc2VkXCIpO1xuXG4gICAgICAgIEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICBjaGlsZC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgdGhpcy5jaGVja0NoaWxkRm9jdXMuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjaGlsZC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCB0aGlzLmNoZWNrQ2hpbGRGb2N1cy5iaW5kKHRoaXMpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DbGljayhldmVudDogRXZlbnQpIHtcbiAgICAgICAgdGhpcy5jbG9zZWQgPSAhdGhpcy5jbG9zZWQ7XG4gICAgfVxuXG4gICAgZ2V0IGNsb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb3NlZDtcbiAgICB9XG5cbiAgICBzZXQgY2xvc2VkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh2YWx1ZSAmJiAhdGhpcy5fY2xvc2VkKSB7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImNsb3NlZFwiLCBcInRydWVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoIXZhbHVlICYmIHRoaXMuX2Nsb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoXCJjbG9zZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2xvc2VkID0gdmFsdWU7XG4gICAgfVxuXG4gICAgY2hlY2tDaGlsZEZvY3VzKGV2ZW50OiBFdmVudCkge1xuICAgICAgICBjb25zdCBmb2N1cyA9IEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikucmVkdWNlKChhY2MsIGNoaWxkKSA9PiAoYWNjIHx8IGNoaWxkID09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuY2xvc2VkID0gIWZvY3VzO1xuICAgIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS1kcmF3ZXInLCBEcmF3ZXIpO1xuIiwiZXhwb3J0IGNsYXNzIEZQU0NvdW50ZXIgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgc2hhZG93OiBTaGFkb3dSb290XG4gICAgdGltZXN0YW1wczogbnVtYmVyW11cbiAgICBoaXN0b3J5TGVuZ3RoOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50aW1lc3RhbXBzID0gW107XG4gICAgICAgIHRoaXMuaGlzdG9yeUxlbmd0aCA9IDE1O1xuICAgIH1cblxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICB0aGlzLnNoYWRvdyA9IHRoaXMuYXR0YWNoU2hhZG93KHttb2RlOiAnb3Blbid9KTtcbiAgICAgICAgdGhpcy5zaGFkb3cudGV4dENvbnRlbnQgPSBcIkZQUzogPz8/XCI7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5vbkZyYW1lLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIG9uRnJhbWUodGltZXN0YW1wOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy50aW1lc3RhbXBzLnB1c2godGltZXN0YW1wKTtcbiAgICAgICAgaWYgKHRoaXMudGltZXN0YW1wcy5sZW5ndGggPiB0aGlzLmhpc3RvcnlMZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMudGltZXN0YW1wcyA9IHRoaXMudGltZXN0YW1wcy5zbGljZSgtdGhpcy5oaXN0b3J5TGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvbGRlc3QgPSB0aGlzLnRpbWVzdGFtcHNbMF07XG4gICAgICAgIGNvbnN0IG5GcmFtZXMgPSB0aGlzLnRpbWVzdGFtcHMubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKG5GcmFtZXMgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBmcHMgPSBNYXRoLnJvdW5kKG5GcmFtZXMgLyAoMC4wMDEgKiAodGltZXN0YW1wIC0gb2xkZXN0KSkpO1xuICAgICAgICAgICAgdGhpcy5zaGFkb3cudGV4dENvbnRlbnQgPSBgRlBTOiAke2Zwc31gO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5vbkZyYW1lLmJpbmQodGhpcykpO1xuICAgIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdyYWRpYW5jZS1mcHMtY291bnRlcicsIEZQU0NvdW50ZXIpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==